"<html lang=\"en\"><head>\n\t  <title>Digital Yoknapatawpha</title>\n\t  <meta charset=\"utf-8\">\n\t  \n\t  <meta name=\"keywords\" content=\"Digital Yoknapatawpha, William Faulkner, maps, characters, sartoris\">\n\t  \n\t  <meta property=\"og:title\" content=\"Digital Yoknapatawpha\">\n\t  <meta property=\"og:image\" content=\"http://faulkner.iath.virginia.edu/stamp.png\">\n\t  <meta property=\"og:description\" content=\"A Collaboration between an International Team of Faulkner Scholars and Technologists at the University of Virginia. Major Funding provided by the National Endowment in the Humanities\">\n\t  \n\t<link rel=\"stylesheet\" href=\"jquery-ui-1.9.2.custom/css/base/jquery-ui-1.9.2.custom.css\">\n\t<link rel=\"stylesheet\" href=\"faulkner.css\">\n    <style>\n/*\t\t\t#dialog {\n\t\t\t\twidth: 350px !important;\n\t\t\t}\n*/    </style>\n\t\t<script src=\"jquery.min.js\"></script>\n\t\t<script src=\"jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.min.js\"></script>\n    <!-- // <script src=\"kinetic-v4.4.1.min.js\"></script> -->\n<script src=\"konva.min.js\"></script>\n\t\t<script src=\"jquery.resizeOnApproach.1.0.min.js\"></script>\n<script src=\"heatmap.min.js\"></script>\n<script src=\"events.js\"></script>\n<script src=\"texts.js\"></script>\n<script src=\"characters.js\"></script>\n<script src=\"sections.js\"></script>\n<script src=\"locations.js\"></script>\n<script src=\"editors.js\"></script>\n<script src=\"editors_assoc.js\"></script>\n<script src=\"credits.js\"></script>\n<script src=\"controls.js\"></script>\n<script src=\"jquery.tabletoCSV.js\"></script>\n\n    <script>\nvar date_start=1800;\nvar date_end=1962;\nvar search_start_page = null;\nvar search_end_page = null;\n\t\t\tvar stage;\n\t\t\tvar locations = {};\n\t\t\tvar fitd_locations = {};\n\t\t\tvar events = {};\n\t\t\tvar fitd_events = {};\n\t\t\tvar fitd_event_logos = {};\n\t\t\tvar dates = {};\n\t\t\tvar characters = {};\n\t\t\tvar fitd_characters = {};\n\t\t\tvar page_locations = {};\n\t\t\tvar people_events = {};\n\t\t\tvar cabin = new Array();\n\t\t\tvar cemetery = new Array();\n\t\t\tvar church = new Array();\n\t\t\tvar courthouse = new Array();\n\t\t\tvar evt = new Array();\n\t\t\tvar farm = new Array();\n\t\t\tvar house = new Array();\n\t\t\tvar mansion = new Array();\n\t\t\tvar office = new Array();\n\t\t\tvar building = new Array();\n\t\t\tvar statue = new Array();\n\t\t\tvar outside = new Array();\n      var backgroundLayer = new Konva.Layer();\n      var contentLayer = new Konva.Layer({\n\t\t\t        x: 800,\n\t\t\t        y: 500,\n\t\t  scaleX: 0.3,\n\t\t  scaleY: 0.3,\n\t\t\t\tdraggable: true,\n\t\t\t\tdragBoundFunc: function(pos) {\n\t\t\t\t\t// console.log(pos.y+','+this.getScale().x);\n\t\t\t\t\tvar tx = pos.x;\n\t\t\t\t\tvar ty = pos.y;\n\t\t\t\t\tif (tx > 0) {\n\t\t\t\t\t\ttx=0;\n\t\t\t\t\t}\n\t\t\t\t\tif (ty > 0) {\n\t\t\t\t\t\tty=0;\n\t\t\t\t\t}\n\t\t\t\t\treturn {x: tx, y: ty};\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar controlLayer = new Konva.Layer();\n\t\t\tvar tooltipLayer = new Konva.Layer();\n\t\t\tvar event_group = new Konva.Group();\n\t\t\tvar location_group = new Konva.Group();\n\t\t\tvar rect;\n\t\t\tvar tooltip_group;\n\t\t\tvar contentLayer_group;\n\t\t\tvar prev=1;\n\t\t\tvar e_prev=1;\n\t\t\tvar min = 1;\n\t\t\tvar max = 433;\n\t\t\tvar speed = -250;\n\t\t\tvar e_speed = -250;\n\t\t\tvar c_speed = -250;\n\t\t\tvar tooltip;\n\t\t\tvar natural, manmade, location_marker, logo;\n\t\t\t\n\t\t\tvar current_book = 'FD';\n\t\t\tvar fd_content_outside = new Array();\n\t\t\tvar fd_content = new Array();\n\t\t\tvar fd_dates = {};\n\n\t\t\tvar map_content = new Array();\n\t\t\t\n\t\t\tvar character_origin = {};\n\t\t\tvar character_home = {};\n\t\t\tvar all_locations = {};\n\t\t\tvar start_page = 1;\n\t\t\tvar end_page = 1;\n\t\t\tvar section_start_page = null;\n\t\t\tvar section_end_page = null;\n\t\t\tvar current_content = new Array();\n\t\t\tvar current_characters = {};\n\t\t\tvar search_characters = {}\n\t\t\tvar current_events = {};\n\t\t\tvar current_events_start = {};\n\t\t\tvar current_event_logos = {};\n\t\t\tvar current_active_event_logos = {};\n\t\t\tvar current_locations = {};\n\t\t\tvar current_data = {};\n\t\t\tvar current_dates = {};\n\t\t\tvar current_text = {};\n\t\t\tvar current_editors = new Array();\n\t\t\tvar current_editors_assoc = new Array();\n\t\t\tvar current_sections = new Array();\n\t\t\tvar current_section = '';\n\t\t\tvar locations_people = {};\n\t\t\tvar locations_events = {};\n\t\t\tvar data_loaded = false;\n\t\t\tvar location_descriptions = {};\n\t\t\tvar location_labels = {};\n\t\t\tvar events_images_in_order = new Array();\n\t\t\tvar events_images_in_chron_order = new Array();\n\t\t\tvar chron_order = new Array(); //{};\n\t\t\tvar total_events = 0;\n\t\t\tvar event_data = {};\n\t\t\tvar event_dates = new Array();\n\t\t\tvar started_event_mode = false;\n\t\t\tvar started_chron_mode = false;\n\t\t\tvar active_characters = new Array();\n\t\t\tvar active_locations = {};\n\t\t\tvar search_locations = {};\n\t\t\tvar scrolled=0;\n\t\t\t\n\t\t\tvar natural = null;\n\t\t\tvar manmade = null;\n\t\t\tvar out_yok = null;\n\t\t\tvar inset_image = null;\n\t\t\tvar heatmap_image = null;\n\t\t\tvar heatmap_image_save = null;\n\t\t\tvar performing_search = false;\n\t\t\t\n\t\t\tvar books = [{'icon':'#flags', 'book':'FD', 'content':map_content, 'manmade':'Flags-manmade.png', 'natural':'Flags-natural.png', 'heatmap':'FlagsInTheDust-heatmap.png', 'thumbnail':'FlagsCover_icon.jpg', 'title':'Flags in the Dust'},\n\t\t{'icon':'#rose', 'book':'RE', 'content':map_content, 'manmade':'Emily-manmade.png', 'natural':'Emily-natural.png', 'heatmap':'Emily-heatmap.png', 'thumbnail':'RE_novel.jpg', 'title':'A Rose for Emily'},\n\t\t{'icon':'#spottedhorses', 'book':'SH', 'content':map_content, 'manmade':'SpotHorses-manmade.png', 'natural':'SpotHorses-natural.png', 'heatmap':'SpottedHorses-heatmap.png', 'thumbnail':'spottedhorses.jpg', 'title':'Spotted Horses'},\n\t\t{'icon':'#therewasaqueen', 'book':'TWQ', 'content':map_content, 'manmade':'Queen-manmade.png', 'natural':'Queen-natural.png', 'heatmap':'ThereWasAQueen-heatmap.png', 'thumbnail':'ThereWasAQueen.jpg', 'title':'There Was A Queen'},\n\t\t{'icon':'#barnburning', 'book':'BB', 'content':map_content, 'manmade':'BarnBurn-manmade.png', 'natural':'BarnBurn-natural.png', 'heatmap':'BarnBurning-heatmap.png', 'thumbnail':'BB_novel.jpg', 'title':'Barn Burning'},\n\t\t{'icon':'#wash', 'book':'W', 'content':map_content, 'manmade':'Wash-manmade.png', 'natural':'Wash-natural.png', 'heatmap':'Wash-heatmap.png', 'thumbnail':'Wash_icon.jpg', 'title':'Wash'},\n\t\t{'icon':'#dryseptember', 'book':'DS', 'content':map_content, 'manmade':'DrySept-manmade.png', 'natural':'DrySept-natural.png', 'heatmap':'DrySeptember-heatmap.png', 'thumbnail':'DS_novel.jpg', 'title':'Dry September'},\n\t\t{'icon':'#pantaloon', 'book':'PAN', 'content':map_content, 'manmade':'Pantaloon-manmade.png', 'natural':'Pantaloon-natural.png', 'heatmap':'PantaloonInBlack-heatmap.png', 'thumbnail':'Pantaloon_icon.jpg', 'title':'Pantaloon in Black'},\n\t\t{'icon':'#shingles', 'book':'SL', 'content':map_content, 'manmade':'Shingles-manmade.png', 'natural':'Shingles-natural.png', 'heatmap':'ShinglesForTheLord-heatmap.png', 'thumbnail':'Shingles_icon.jpg', 'title':'Shingles for the Lord'},\n\t\t{'icon':'#redleaves', 'book':'RL', 'content':map_content, 'manmade':'', 'natural':'RedLeaves-natural.png', 'heatmap':'RedLeaves-heatmap.png', 'thumbnail':'RedLeaves_icon.jpg', 'title':'Red Leaves'},\n\t\t{'icon':'#ambuscade', 'book':'AMB', 'content':map_content, 'manmade':'AMB-manmade.png', 'natural':'AMB-natural.png', 'heatmap':'Ambuscade-heatmap.png', 'thumbnail':'Ambuscade_icon.jpg', 'title':'Ambuscade'},\n\t\t{'icon':'#eveningsun', 'book':'TES', 'content':map_content, 'manmade':'EvenSun-manmade.png', 'natural':'EvenSun-natural.png', 'heatmap':'EveningSun-heatmap.png', 'thumbnail':'ThatEveningSun_icon.jpg', 'title':'That Evening Sun'},\n\t\t{'icon':'#tomorrow', 'book':'TO', 'content':map_content, 'manmade':'Tomorrow-manmade.png', 'natural':'Tomorrow-natural.png', 'heatmap':'Tomorrow-heatmap.png', 'thumbnail':'Tomorrow_icon.jpg', 'title':'Tomorrow'},\n\t\t{'icon':'#unvanquished', 'book':'UNV', 'content':map_content, 'manmade':'Unvanq-manmade.png', 'natural':'Unvanq-natural.png', 'heatmap':'UnvanqStory-heatmap.png', 'thumbnail':'UnvanquishedSS.jpg', 'title':'The Unvanquished'},\n\t\t{'icon':'#sanctuary', 'book':'SY', 'content':map_content, 'manmade':'Sanctuary-manmade.png', 'natural':'Sanctuary-natural.png', 'extra':'MemphisOxfordLayer.png', 'heatmap':'Sanctuary-heatmap.png', 'thumbnail':'santcover.jpg', 'title':'Sanctuary'},\n\t\t{'icon':'#deathdrag', 'book':'DD', 'content':map_content, 'manmade':'DDrag-manmade.png', 'natural':'DDrag-natural.png', 'heatmap':'DeathDrag-heatmap.png', 'thumbnail':'DeathDrag.jpg', 'title':'Death Drag'},\n\t\t{'icon':'#mule', 'book':'MY', 'content':map_content, 'manmade':'Mule-manmade.png', 'natural':'Mule-natural.png', 'heatmap':'MuleInTheYard-heatmap.png', 'thumbnail':'MuleInYard.jpg', 'title':'Mule In The Yard'},\n\t\t{'icon':'#sound', 'book':'SF', 'content':map_content, 'manmade':'SoundAndFury-manmade.png', 'natural':'SoundAndFury-natural.png', 'extra':'SoundAndFury-cambridge.png', 'heatmap':'SandF-heatmap.png', 'thumbnail':'sandfcovert.jpg', 'title':'The Sound and the Fury'},\n\t\t{'icon':'#light', 'book':'LA', 'content':map_content, 'manmade':'Light-manmade.png', 'natural':'Light-natural.png', 'extra':'LIA-inset.png', 'heatmap':'August-heatmap.png', 'thumbnail':'lightcovert.jpg', 'title':'Light In August'},\n\t\t{'icon':'#soldier', 'book':'TWS', 'content':map_content, 'manmade':'TwoSoldiers-manmade.png', 'natural':'TwoSoldiers-natural.png', 'heatmap':'TwoSoldiers-heatmap.png', 'extra':'TwoSoldiers-memphis.png', 'thumbnail':'TwoSoldiersIcon.jpg', 'title':'Two Soldiers'},\n\t\t{'icon':'#aild', 'book':'LD', 'content':map_content, 'manmade':'AILD-manmade.png', 'natural':'AILD-natural.png', 'heatmap':'AILD-heatmap.png', 'thumbnail':'aildcover.jpg', 'title':'As I Lay Dying'},\n\t\t{'icon':'#sas', 'book':'SAS', 'content':map_content, 'manmade':'SkirmishAtSartoris-manmade.png', 'natural':'SkirmishAtSartoris-natural.png', 'heatmap':'SkirmishAtSartoris-heatmap.png', 'thumbnail':'SkirmishAtSartoris.jpg', 'title':'Skirmish At Sartoris'},\n\t\t{'icon':'#snp', 'book':'SNP', 'content':map_content, 'manmade':'ShallNotPerish-manmade.png', 'natural':'ShallNotPerish-natural.png', 'heatmap':'ShallNotPerish-heatmap.png', 'thumbnail':'ShallNotPerish.jpg', 'title':'Shall Not Perish'},\n\t\t{'icon':'#old', 'book':'OLD', 'content':map_content, 'manmade':'OldPeople-manmade.png', 'natural':'OldPeople-natural.png', 'heatmap':'TheOldPeople-heatmap.png', 'thumbnail':'TheOldPeople.jpg', 'title':'The Old People'},\n\t\t{'icon':'#god', 'book':'GOD', 'content':map_content, 'manmade':'GoDownMoses-manmade.png', 'natural':'GoDownMoses-natural.png', 'heatmap':'GDMStory-heatmap.png', 'thumbnail':'GoDownMoses.jpg', 'title':'Go Down, Moses'},\n\t\t{'icon':'#raid', 'book':'RAI', 'content':map_content, 'manmade':'Raid-manmade.png', 'natural':'Raid-natural.png', 'heatmap':'Raid-heatmap.png', 'thumbnail':'Raid.jpg', 'title':'Raid'},\n\t\t{'icon':'#retreat', 'book':'RET', 'content':map_content, 'manmade':'Retreat-manmade.png', 'natural':'Retreat-natural.png', 'heatmap':'Retreat-heatmap.png', 'thumbnail':'Retreat.jpg', 'title':'Retreat'},\n\t\t{'icon':'#bear', 'book':'BAR', 'content':map_content, 'manmade':'TheBear-manmade.png', 'natural':'TheBear-natural.png', 'heatmap':'TheBear-heatmap.png', 'thumbnail':'TheBear.jpg', 'title':'The Bear'},\n\t\t{'icon':'#delta_autumn', 'book':'DEL', 'content':map_content, 'manmade':'DeltaAutumn-manmade.png', 'natural':'DeltaAutumn-natural.png', 'heatmap':'DeltaAutumn-heatmap.png', 'thumbnail':'DeltaAutumn.jpg', 'title':'Delta Autumn'},\n\t\t{'icon':'#vendee', 'book':'VEN', 'content':map_content, 'manmade':'Vendee-manmade.png', 'natural':'Vendee-natural.png', 'heatmap':'Vendee-heatmap.png', 'thumbnail':'Vendee.jpg', 'title':'Vendee'},\n\t\t{'icon':'#centaur', 'book':'CB', 'content':map_content, 'manmade':'Centaur-manmade.png', 'natural':'Centaur-natural.png', 'heatmap':'CentaurInBrass-heatmap.png', 'thumbnail':'CentaurInBrass.jpg', 'title':'Centaur In Brass'},\n\t\t{'icon':'#intruder', 'book':'ID', 'content':map_content, 'manmade':'Intruder-manmade.png', 'natural':'Intruder-natural.png', 'heatmap':'IntruderInTheDust-heatmap.png', 'thumbnail':'IntruderIcon.jpg', 'title':'Intruder In The Dust'},\n\t\t{'icon':'#dead_pilots', 'book':'ADP', 'content':map_content, 'manmade':'DeadPilots-manmade.png', 'natural':'DeadPilots-natural.png', 'extra':'DeadPilots-extra.png', 'heatmap':'DeadPilots-heatmap.png', 'thumbnail':'AllTheDeadPilots.jpg', 'title':'All The Dead Pilots'},\n\t\t{'icon':'#reivers', 'book':'R', 'content':map_content, 'manmade':'Reivers-manmade.png', 'natural':'Reivers-natural.png', 'extra':'Reivers-inset.png', 'heatmap':'TheReivers-heatmap.png', 'thumbnail':'ReiversCover.jpg', 'title':'Reivers'},\n\t\t{'icon':'#ajustice', 'book':'J', 'content':map_content, 'manmade':'AJustice-manmade.png', 'natural':'AJustice-natural.png', 'heatmap':'AJustice-heatmap.png', 'thumbnail':'AJustice.jpg', 'title':'A Justice'},\n\t\t{'icon':'#courtship', 'book':'CRT', 'content':map_content, 'manmade':'Courtship-manmade.png', 'natural':'Courtship-natural.png', 'heatmap':'ACourtship-heatmap.png', 'thumbnail':'ACourtship.jpg', 'title':'A Courtship'},\n\t\t{'icon':'#unvanqnovel', 'book':'UV', 'content':map_content, 'manmade':'UnvanqNovel-manmade.png', 'natural':'UnvanqNovel-natural.png', 'heatmap':'TheUnvanquished-heatmap.png', 'thumbnail':'UnvanqCover.jpg', 'title':'The Unvanquished'},\n\t\t\t{'icon':'#hamlet', 'book':'H', 'content':map_content, 'manmade':'Hamlet-manmade.png', 'natural':'Hamlet-natural.png', 'extra':'Hamlet-inset.png', 'heatmap':'TheHamlet-heatmap.png', 'thumbnail':'HamletCover.jpg', 'title':'Hamlet'},\n\t\t\t{'icon':'#hound', 'book':'TH', 'content':map_content, 'manmade':'Hound-manmade.png', 'natural':'Hound-natural.png', 'heatmap':'TheHound-heatmap.png', 'thumbnail':'TheHound.jpg', 'title':'The Hound'},\n\t\t\t{'icon':'#lizards', 'book':'LJC', 'content':map_content, 'manmade':'Lizards-manmade.png', 'natural':'Lizards-natural.png', 'heatmap':'JamshydsCourtyard-heatmap.png', 'thumbnail':'Lizards.jpg', 'title':'Lizards in Jamshyd&rsquo;s Courtyard'},\n\t\t\t{'icon':'#fool', 'book':'FAH', 'content':map_content, 'manmade':'FoolAboutHorse-manmade.png', 'natural':'FoolAboutHorse-natural.png', 'heatmap':'FoolAboutAHorse-heatmap.png', 'thumbnail':'FoolAboutHorse.jpg', 'title':'Fool About Horse'},\n\t\t\t{'icon':'#point', 'book':'POL', 'content':map_content, 'manmade':'PointOfLaw-manmade.png', 'natural':'PointOfLaw-natural.png', 'heatmap':'PointOfLaw-heatmap.png', 'thumbnail':'APointOfLaw.jpg', 'title':'A Point Of Law'},\n\t\t\t{'icon':'#tallmen', 'book':'TM', 'content':map_content, 'manmade':'Tallmen-manmade.png', 'natural':'TallMen-natural.png', 'heatmap':'TheTallMen-heatmap.png', 'thumbnail':'TheTallMen.jpg', 'title':'The Tall Men'},\n\t\t\t{'icon':'#goldnotalways', 'book':'GOL', 'content':map_content, 'manmade':'GoldNotAlways-manmade.png', 'natural':'GoldNotAlways-natural.png', 'heatmap':'GoldIsNotAlways-heatmap.png', 'thumbnail':'GoldIsNotAlways.jpg', 'title':'Gold Is Not Always'},\n\t\t\t{'icon':'#moses_novel', 'book':'GDM', 'content':map_content, 'manmade':'MosesNovel-manmade.png', 'natural':'MosesNovel-natural.png', 'heatmap':'GoDownMoses-heatmap.png', 'thumbnail':'GoDownMosesNovelCover.jpg', 'title':'Go Down, Moses'},\n\t\t\t{'icon':'#monk', 'book':'MNK', 'content':map_content, 'manmade':'Monk-manmade.png', 'natural':'Monk-natural.png', 'heatmap':'Monk-heatmap.png', 'thumbnail':'Monk.jpg', 'title':'Monk'},\n\t\t\t{'icon':'#lion', 'book':'LIO', 'content':map_content, 'manmade':'Lion-manmade.png', 'natural':'Lion-natural.png', 'heatmap':'Lion-heatmap.png', 'thumbnail':'Lion.jpg', 'title':'Lion'},\n\t\t\t{'icon':'#smoke', 'book':'SMO', 'content':map_content, 'manmade':'Smoke-manmade.png', 'natural':'Smoke-natural.png', 'heatmap':'Smoke-heatmap.png', 'thumbnail':'Smoke.jpg', 'title':'Smoke'},\n\t\t\t{'icon':'#race', 'book':'RAM', 'content':map_content, 'manmade':'RaceAtMorning-manmade.png', 'natural':'RaceAtMorning-natural.png', 'heatmap':'RaceAtMorning-heatmap.png', 'extra':'RaceAtMorning-extra.png', 'thumbnail':'RaceAtMorning.jpg', 'title':'Race At Morning'},\n//\t\t\t\t{'icon':'', 'book':'HEAT', 'content':map_content, 'manmade':'Lion-manmade.png', 'natural':'Lion-natural.png', 'heatmap':'Lion-heatmap.png', 'thumbnail':'Lion.jpg', 'title':'Lion'},\n\t\t\t{'icon':'#elly', 'book':'ELY', 'content':map_content, 'manmade':'Elly-manmade.png', 'natural':'Elly-natural.png', 'heatmap':'Elly-heatmap.png', 'thumbnail':'Elly.jpg', 'title':'Elly'},\n\t\t\t{'icon':'#hair', 'book':'HR', 'content':map_content, 'manmade':'Hair-manmade.png', 'natural':'Hair-natural.png', 'heatmap':'Hair-heatmap.png', 'thumbnail':'Hair.jpg', 'title':'Hair'},\n\t\t\t{'icon':'#willy', 'book':'UW', 'content':map_content, 'manmade':'UncleWilly-manmade.png', 'natural':'UncleWilly-natural.png', 'heatmap':'UncleWilly-heatmap.png', 'thumbnail':'UncleWilly.jpg', 'title':'Uncle Willy', 'extra':'UncleWilly-extra.png'},\n\t\t\t{'icon':'#grandmother', 'book':'MGM', 'content':map_content, 'manmade':'MyGrandmotherMillard-manmade.png', 'natural':'MyGrandmotherMillard-natural.png', 'heatmap':'Grandmother-heatmap.png', 'thumbnail':'MyGrandmotherMillard.jpg', 'title':'My Grandmother Millard'},\n\t\t\t{'icon':'#abearhunt', 'book':'ABH', 'content':map_content, 'manmade':'ABearHunt-manmade.png', 'natural':'ABearHunt-natural.png', 'heatmap':'ABearHunt-heatmap.png', 'thumbnail':'ABearHunt.jpg', 'title':'A Bear Hunt'},\n\t\t\t{'icon':'#bythepeople', 'book':'BP', 'content':map_content, 'manmade':'ByThePeople-manmade.png', 'natural':'ByThePeople-natural.png', 'heatmap':'ByThePeople-heatmap.png', 'thumbnail':'ByThePeople.jpg', 'title':'ByThe People'},\n\t\t\t{'icon':'#absalomabsalom', 'book':'AA', 'content':map_content, 'manmade':'Absalom-manmade.png', 'natural':'Absalom-natural.png', 'heatmap':'Absalom-heatmap.png', 'thumbnail':'aacover.jpg', 'title':'Absalom, Absalom!'},\n\t\t\t{'icon':'#town', 'book':'T', 'content':map_content, 'manmade':'Town-manmade.png', 'natural':'Town-natural.png', 'heatmap':'66_T.png', 'thumbnail':'Town.jpg', 'title':'The Town', 'extra':'Town-inset.png'},\n\t\t\t{'icon':'#fine', 'book':'TWB', 'content':map_content, 'manmade':'ThatWillBeFine-manmade.png', 'natural':'ThatWillBeFine-natural.png', 'heatmap':'ThatWillBeFine-heatmap.png', 'thumbnail':'ThatWillBeFine.jpg', 'title':'That Will Be Fine'},\n\t\t\t{'icon':'#error', 'book':'EIC', 'content':map_content, 'manmade':'ErrorInChemistry-manmade.png', 'natural':'ErrorInChemistry-natural.png', 'heatmap':'ErrorInChemistry-heatmap.png', 'thumbnail':'AnErrorInChemistry.jpg', 'title':'An Error In Chemistry'},\n\t\t\t{'icon':'#beyond', 'book':'BE', 'content':map_content, 'manmade':'Beyond-manmade.png', 'natural':'Beyond-natural.png', 'heatmap':'Beyond-heatmap.png', 'thumbnail':'Beyond.jpg', 'title':'Beyond'},\n\t\t\t{'icon':'#hand', 'book':'HUW', 'content':map_content, 'manmade':'HandUponWater-manmade.png', 'natural':'HandUponWater-natural.png', 'heatmap':'HandOnWaters-heatmap.png', 'thumbnail':'HandUponTheWaters.jpg', 'title':'Hand Upon The Waters'},\n\t\t\t{'icon':'#mansion', 'book':'M', 'content':map_content, 'manmade':'Mansion-manmade.png', 'natural':'Mansion-natural.png', 'heatmap':'67_M.png', 'thumbnail':'Mansion.jpg', 'title':'The Mansion', 'extra':'Mansion-extra.png'},\n\t\t\t{'icon':'#AppendixCompson', 'book':'AC', 'content':map_content, 'manmade':'AppendixCompson-manmade.png', 'natural':'AppendixCompson-natural.png', 'heatmap':'58_AC.png', 'thumbnail':'AppendixCompson.jpg', 'title':'Appendix: Compson'},\n\t\t\t{'icon':'#adastra', 'book':'AD', 'content':map_content, 'manmade':'AdAstra-manmade.png', 'natural':'AdAstra-natural.png', 'heatmap':'AdAstra-heatmap.png', 'thumbnail':'AdAstra.jpg', 'title':'Ad Astra', 'extra':'AdAstra-extra.png'},\n\t\t\t{'icon':'#zilphia', 'book':'MZG', 'content':map_content, 'manmade':'MissZilphia-manmade.png', 'natural':'MissZilphia-natural.png', 'heatmap':'20_MZG.png', 'thumbnail':'MissZilphiaGant.jpg', 'title':'MissZilphiaGant'},\n\t\t\t{'icon':'#name_city', 'book':'NC', 'content':map_content, 'manmade':'NameForCity-manmade.png', 'natural':'NameForCity-natural.png', 'heatmap':'', 'thumbnail':'NameForCity.jpg', 'title':'A Name for the City'},\n\t\t\t{'icon':'#gambit', 'book':'KGB', 'content':map_content, 'manmade':'Gambit-manmade.png', 'natural':'Gambit-natural.png', 'heatmap':'', 'thumbnail':'Gambit-cover-icon.jpg', 'title':'Knight&rsquo;s Gambit'},\n\t\t\t{'icon':'#requiem', 'book':'RQ', 'content':map_content, 'manmade':'Requiem-manmade.png', 'natural':'Requiem-natural.png', 'heatmap':'', 'thumbnail':'Requiem-cover-icon.jpg', 'title':'Requiem for a Nun'},\n\t\t\t\n\t];\n\tvar texts_by_publish_date = ['flags', 'sound', 'rose', 'aild', 'redleaves', 'dryseptember', 'sanctuary', 'eveningsun', 'adastra', 'hair', 'spottedhorses', 'hound', 'dead_pilots', 'ajustice', 'deathdrag', 'centaur', 'lizards', 'smoke', 'zilphia', 'light', 'therewasaqueen', 'beyond', 'wash', 'elly', 'abearhunt', 'mule', 'ambuscade', 'retreat', 'raid', 'sas', 'fine', 'willy', 'lion', 'fool', 'absalomabsalom', 'unvanquished', 'vendee', 'monk', 'unvanqnovel', 'barnburning','hand', 'hamlet', 'point', 'old', 'pantaloon', 'goldnotalways', 'tomorrow', 'god', 'tallmen', 'soldier', 'delta_autumn', 'bear', 'moses_novel', 'shingles', 'grandmother', 'snp', 'AppendixCompson', 'error', 'intruder', 'courtship', 'gambit', 'name_city', 'requiem', 'race', 'bythepeople', 'town', 'mansion', 'reivers'];\n\tvar texts_by_limited = ['flags', 'sas', 'fool', 'unvanquished', 'vendee', 'unvanqnovel', 'barnburning', 'point', 'hamlet', 'old', 'pantaloon', 'goldnotalways', 'shingles', 'snp', 'intruder', 'courtship', 'reivers'];\n\tvar texts_alphabetical = ['absalomabsalom', 'adastra', 'dead_pilots', 'ambuscade', 'AppendixCompson', 'aild', 'barnburning', 'bear', 'abearhunt', 'beyond', 'bythepeople', 'centaur', 'courtship', 'deathdrag', 'delta_autumn', 'dryseptember', 'elly', 'error', 'flags', 'fool', 'god', 'moses_novel', 'goldnotalways', 'hair', 'hamlet', 'hand', 'hound', 'intruder', 'ajustice', 'gambit', 'light', 'lion', 'lizards', 'mansion', 'zilphia', 'monk', 'mule', 'grandmother', 'name_city', 'old', 'pantaloon', 'point', 'race', 'raid', 'redleaves', 'reivers', 'requiem', 'retreat', 'rose', 'sanctuary', 'snp', 'shingles', 'sas', 'smoke', 'sound', 'spottedhorses', 'tallmen', 'eveningsun', 'fine', 'therewasaqueen', 'tomorrow', 'town', 'soldier', 'willy', 'unvanquished', 'unvanqnovel', 'vendee', 'wash'];\n\tvar texts_by_novels = ['flags', 'sound', 'aild', 'sanctuary', 'light', 'absalomabsalom', 'unvanqnovel', 'hamlet', 'moses_novel', 'AppendixCompson', 'intruder', 'requiem', 'town', 'mansion', 'reivers'];\n \tvar texts_by_collected_stories = ['barnburning', 'shingles', 'tallmen', 'abearhunt', 'soldier', 'snp', 'rose', 'hair', 'centaur', 'dryseptember', 'deathdrag', 'elly', 'willy', 'mule', 'fine', 'eveningsun', 'redleaves', 'ajustice', 'courtship', 'adastra', 'dead_pilots', 'wash', 'grandmother', 'therewasaqueen', 'beyond'];\n\tvar texts_by_uncollected_stories = ['ambuscade', 'retreat', 'raid', 'sas', 'unvanquished', 'vendee', 'fool', 'lizards', 'hound', 'spottedhorses', 'lion', 'old', 'point', 'goldnotalways', 'pantaloon', 'god', 'delta_autumn', 'bear', 'race', 'zilphia', 'name_city', 'bythepeople'];\n\tvar texts_by_knights = ['smoke', 'monk', 'hand', 'tomorrow', 'error', 'gambit'];\n\t\n\t\t\tfunction array_unique(arr) {\n\t\t\t    var result = [];\n\t\t\t    for (var i = 0; i < arr.length; i++) {\n\t\t\t        if (result.indexOf(arr[i]) == -1) {\n\t\t\t            result.push(arr[i]);\n\t\t\t        }\n\t\t\t    }\n\t\t\t    return result;\n\t\t\t}\n\t\t\t\n\t\t\tfunction get_events(loc,id, text) {\n\t\t\t\t// alert(id);\n\t\t\t\t$.ajax({ \n\t           type: 'GET', \n\t           url: '/sinatra/events_from_id?id='+encodeURIComponent(id)+'&text='+text, \n\t           // dataType:'json',\n\t           success: function (data) { \n\t\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t\t\t$(loc).html(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction sortHashTableByKey(hash, key_order, remove_key)\n\t\t\t{\n\t\t\t    var tmp = [],\n\t\t\t        end = [],\n\t\t\t        f_order = null;\n\t\t\t    remove_key = remove_key || false;\n\t\t\t    for (var key in hash)\n\t\t\t    {\n\t\t\t        if (hash.hasOwnProperty(key))\n\t\t\t        {\n\t\t\t            tmp.push(hash[key][key_order]);\n\t\t\t        }\n\t\t\t    }\n\t\t\t    if (hash && hash[0] && typeof(hash[0][key_order]) === 'number')\n\t\t\t    {\n\t\t\t        f_order = function (a, b) { return a - b; };\n\t\t\t    }\n\t\t\t    tmp.sort(f_order);\n\t\t\t    function getHash(hash, value)\n\t\t\t    {\n\t\t\t        for (k in hash)\n\t\t\t        {\n\t\t\t            if (hash[k] && hash[k][key_order] === value)\n\t\t\t            {\n\t\t\t                return { key : k, hash : hash[k] };\n\t\t\t            }\n\t\t\t        }\n\t\t\t    }\n\t\t\t    for (var i = 0, l = tmp.length; i < l; i++)\n\t\t\t    {\n\t\t\t        tmp[i] = getHash(hash, tmp[i]);\n\t\t\t        if (remove_key)\n\t\t\t        {\n\t\t\t            delete tmp[i].hash[key_order];\n\t\t\t        }\n\t\t\t        if (!hash.length)\n\t\t\t        {\n\t\t\t            end[tmp[i].key] = tmp[i].hash;\n\t\t\t        }\n\t\t\t        else\n\t\t\t        {\n\t\t\t            end.push(tmp[i].hash);\n\t\t\t        }\n\t\t\t    }\n\t\t\t    return end;\n\t\t\t}\n\t\t\tfunction SortArrayByKeys(inputarray) {\n\t\t\t  var arraykeys=[];\n\t\t\t  for(var k in inputarray) {arraykeys.push(k);}\n\t\t\t  arraykeys.sort();\n\n\t\t\t  var outputarray={};\n\t\t\t  for(var i=0; i<arraykeys.length; i++) {\n\t\t\t      outputarray[arraykeys[i]]=inputarray[arraykeys[i]];\n\t\t\t  }\n\t\t\t  return outputarray;\n\t\t\t}\n\t\t\tfunction GetURLParameter(sParam)\n\t\t\t{\n\t\t\t    var sPageURL = window.location.search.substring(1);\n\t\t\t    var sURLVariables = sPageURL.split('&');\n\t\t\t    for (var i = 0; i < sURLVariables.length; i++) \n\t\t\t    {\n\t\t\t        var sParameterName = sURLVariables[i].split('=');\n\t\t\t        if (sParameterName[0] == sParam) \n\t\t\t        {\n\t\t\t            return sParameterName[1];\n\t\t\t        }\n\t\t\t    }\n\t\t\t};\n\t\t\t\n\t\t\tfunction setTitle() {\n\t\t\t\tvar str = ''; //'<div id=\"info\" style=\"float: right;margin:2px\"> <img src=\"information-sm.png\"></div>';\n\t\t\t\tvar names = \"\";\n\t\t\t\tif ((current_text[\"Title\"] != null) && (current_text[\"Title\"].indexOf(\"\\\"\") >= 0)) {\n\t\t\t\t\tstr += \"<strong>\"+current_text[\"title\"]+\"</strong><img src=\\\"information-sm.png\\\"><br/><span class=\\\"edited\\\">EDITED BY</span><br/>\";\n\t\t\t\t} else {\n\t\t\t\t\tstr += \"<strong><i>\"+current_text[\"title\"]+\"</i></strong><br/><span class=\\\"edited\\\">EDITED BY</span><br/>\";\n\t\t\t\t}\n\t\t\t\tstr += '<div id=\"info\"><img src=\"information-sm.png\"></div>';\n\t\t\t\tif(current_editors.length > 3) {\n\t\t\t\t\t// $(\"#title\").css('width','250px');\n\t\t\t\t}\n\t\t\t\t$.each(current_editors, function(index, value) {\n\t\t\t\t\tnames += names != \"\" ? ', ' : '';\n\t\t\t\t\tnames += value['display_name']+\"\";\n\t\t\t\t})\n\t\t\t\t// wnm adding code to append associate editors' names after a semicolon in names string\n\t\t\t\tif(current_editors_assoc.length > 0) {\n\t\t\t\t\tnames += \" ; \" ;\n\t\t\t\t\t$.each(current_editors_assoc, function(index, value) {\n \t\t\t\t\t\tif(index > 0) {names += names != \"\" ? ', ' : ''; } \n \t\t\t\t\t\tnames += value['display_name']+\"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n \t\t\t\t}\n\t\t\t\t\n\t\t\t\t$('#title').html(str+'<div class=\"names\">'+names+\"</div>\");\n\t\t\t\t\n\t\t\t\t// str = \"<div id=\\\"text_tabs\\\"><ul><li><a href=\\\"#text_tabs-1\\\">About the Text</a></li><li><a href=\\\"#text_tabs-2\\\">About the Editors</a></li></ul><div id=\\\"text_tabs-1\\\" class=\\\"dialog_content\\\"></div><div id=\\\"text_tabs-2\\\" class=\\\"dialog_content\\\" ></div></div>\";\n\t\t\t\t// $( \"#about_text\" ).html(str);\n\t\t\t\t// $(\"#text_tabs-1\").html(current_text['About']);\n\t\t\t\t// $('#text_tabs-2').html(editor_text);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t$('#title').click(function() {\n\t\t\t\t\t// $('#text_tabs').tabs();\n\t\t\t\t\t// $('#about_text').dialog(\"open\");\n\t\t\t\t\tvar editor_text = \"\"\n\t\t\t\t\t$.each(current_editors, function(index, value) {\n\t\t\t\t\t\teditor_text += value['about']+\"<br/><br/>\";\n\t\t\t\t\t})\n\t\t\t\t\tvar str = \"<div id=\\\"tabs\\\"><ul><li><a href=\\\"#tabs-2\\\">About the Text</a></li><li><a href=\\\"#tabs-1\\\">About the Editors</a></li><li><a href=\\\"#tabs-3\\\">Citing This Resource</a></li></ul><div id=\\\"tabs-2\\\" class=\\\"dialog_content\\\"></div><div id=\\\"tabs-1\\\" class=\\\"dialog_content\\\" ></div><div id=\\\"tabs-3\\\" class=\\\"dialog_content\\\" ></div></div>\";\n\t\t\t\t\t$( \"#dialog\" ).html( str); //\"<strong>\"+value[\"LocationTitle\"]+\"</strong><br>\"+value[\"Description\"] );\n\t\t\t\t\t$( \"#tabs-2\" ).html(current_text['about'] );\n\t\t\t\t\t$( \"#tabs-3\" ).html(current_text['citation'] );\n\t\t\t\t\t$('#tabs-1').append(editor_text);\n\t\t\t\t\t$(\"#tabs\").tabs();\n\t\t\t\t\t$( \"#dialog\" ).dialog( {\n\t\t\t\t\t\t// title: 'Text'.\n\t\t\t\t\t\twidth: 400,\n\t\t\t\t\t\tclose: function(){\n\t\t\t\t\t\t\t$(\"#dialog\").css(\"width\", 300);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$( \"#dialog\" ).dialog( \"open\" );\n\t\t\t\t\t$( \"#dialog\").dialog('option', 'title', 'Information');\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t\n\t\t\tfunction getOtherResources(text) {\n\t\t\t\t// \n\t\t\t\t$.ajax({ \n             type: 'GET', \n\t\t\t\t\t\n\t\t\t url: '/sinatra/drupal_other_resources?code='+text,\n             dataType:'json',\n             success: function (data) { \n\t\t\t\t // if( data[\"results\"].length > 1) {\n\t\t\t\t\t $('#layer_dialog').append('<strong>Other Resources</strong>:<br>');\n\t\t\t\t // }\n\t\t\t\t\t\t\t$.each(data[\"results\"], function(index, value) {\n\t\t\t\t\t\t\t\tif (value['code'] != null) {\n\t\t\t\t\t\t\t\t\t$('#layer_dialog').append('<a href=\"http://faulkner.drupal.shanti.virginia.edu/node/'+value['nid']+'?canvas\" target=\"_blank\">'+value['display_title']+'</a><br>');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t$('#layer_dialog').append('<a href=\"characters-force.html?text='+text+'\" target=\"_blank\">Location-Character Graph</a>');\n             }\n         });\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction select_all_icons() {\n\t\t\t\t// console.log('books = '+books.length);\n\t\t\t\t// console.log('pub = '+texts_by_publish_date.length);\n\t\t\t\tvar b = {}\n\t\t\t\t$.each(books, function(k,v) {\n\t\t\t\t\tb[books[k]['icon']] = k;\n\t\t\t\t})\n\t\t\t\t$('.mac-dock').empty();\n\t\t\t\t$.each(texts_by_publish_date, function(k,v) {\n\t\t\t\t\tb[books[k]['icon']] = k;\n\t\t\t\t\tconsole.log(books[b['#'+v]]['icon']);\n\t\t\t\t\t$('.mac-dock').append('<img alt=\"'+books[b['#'+v]]['title']+'\" src=\"'+books[b['#'+v]]['thumbnail']+'\" id=\"'+books[b['#'+v]]['icon']+'\" title=\"'+books[b['#'+v]]['title']+'\"> ');\n\t\t\t\t\t$(books[b['#'+v]]['icon']).click(function() {\n\t\t\t\t\t\tconsole.log('click');\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t$('.mac-dock img').click(function() {\n\t\t\t\t\tvar i = $(this).attr('id');\n\t\t\t\t\tconsole.log(books[b[i]]);\n\t\t\t\t\tshow_book(books[b[i]]['book'], books[b[i]]['content'], books[b[i]]['manmade'], books[b[i]]['natural'], books[b[i]]['heatmap'], books[b[i]]['extra']);\n\t\t\t\t})\n\t\t\t\t$('.mac-dock img').show();\n\t\t\t\t$('.mac-dock').css('width',(texts_by_publish_date.length*43)+'px');\n\t\t\t\t$('.mac-dock img').resizeOnApproach();\n\t\t\t\t\n\t\t\t}\n\n\t\t\tfunction select_fewer_icons(icons) {\n\t\t\t\tif (icons == null) {\n\t\t\t\t\ticons = texts_alphabetical;\n\t\t\t\t}\n\t\t\t\tvar b = {}\n\t\t\t\t$.each(books, function(k,v) {\n\t\t\t\t\tb[books[k]['icon']] = k;\n\t\t\t\t})\n\t\t\t\t$('.mac-dock').empty();\n\t\t\t\t$.each(icons, function(k,v) {\n\t\t\t\t\tconsole.log(k);\n\t\t\t\t\t// b[books[k]['icon']] = k;\n\t\t\t\t\tconsole.log(books[b['#'+v]]['icon']);\n\t\t\t\t\t$('.mac-dock').append('<img alt=\"'+books[b['#'+v]]['title']+'\" src=\"'+books[b['#'+v]]['thumbnail']+'\" id=\"'+books[b['#'+v]]['icon']+'\" title=\"'+books[b['#'+v]]['title']+'\"> ');\n\t\t\t\t})\n\t\t\t\t$('.mac-dock img').click(function() {\n\t\t\t\t\tvar i = $(this).attr('id');\n\t\t\t\t\tconsole.log(books[b[i]]);\n\t\t\t\t\tshow_book(books[b[i]]['book'], books[b[i]]['content'], books[b[i]]['manmade'], books[b[i]]['natural'], books[b[i]]['heatmap'], books[b[i]]['extra']);\n\t\t\t\t})\n\t\t\t\tvar w = icons.length*44;\n\t\t\t\tif (w < 800) {\n\t\t\t\t\tw = 800;\n\t\t\t\t}\n\t\t\t\t$('.mac-dock').css('width',w+'px');\n\t\t\t\t$('.mac-dock img').resizeOnApproach();\n\t\t\t\t\n\t\t\t}\n\t\t\tvar heatmap_layer=null;\n\t\t\t// start up jquery\n\t\t\t$(function() {\t\t\t\t\n\t\t\t\t\n\t\t\t    $(\"#downClick\").on(\"click\" ,function(){\n\t\t\t\t\t// scroll pass visible width  (doc_width-visible_width)\n\t\t\t\t\tvar wid = books.length*42;\n\n\t\t\t\t\tif(scrolled < (wid-800))   \n\t\t\t                   scrolled=scrolled+100;\n        \n\t\t\t   \t\t\t\t$(\"#dock-container\").animate({\n\t\t\t   \t\t\t\t        scrollLeft:  scrolled\n\t\t\t   \t\t\t\t   });\n\t\t\t\t\t\t\t   console.log(scrolled);\n\t\t\t   \t\t\t});\n\n    \n\t\t\t       $(\"#upClick\").on(\"click\" ,function(){\n\t\t\t\t\t   if(scrolled > 0)\n\t\t\t   \t\t\t\tscrolled=scrolled-100;\n\t\t\t\t\n\t\t\t   \t\t\t\t$(\"#dock-container\").animate({\n\t\t\t   \t\t\t\t        scrollLeft:  scrolled\n\t\t\t   \t\t\t\t   });\n\t\t\t\t\t\t\t   console.log(scrolled);\n\n\t\t\t   \t\t\t});\n\t\t\t\t\n\t\t\t\tvar years = 75; //1850-1925\n\t\t\t\t// $('#date_years').append();\n\t\t\t\t// display coordinates if parameter is passed\n\t\t\t\tvar coords = GetURLParameter('coords');\n\t\t\t\tvar book_param=GetURLParameter('text');\n\n\t\t\t\tif (coords == \"y\") {\n\t\t\t\t\t$('#coords').show();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tload_credits();\n\t\t\t\t\n\t\t\t\tif(book_param == null) {\n\t\t\t\t\tselect_all_icons();\n\t\t\t\t\t// $('.mac-dock').css('width',(books.length*42)+'px');\n\t\t\t\t\t$('.mac-dock').show();\n\t\t\t\t\t$(\"#shelf_instructions\").show();\n\t\t\t\t\t$(\"#upClick\").show();\n\t\t\t\t\t$(\"#downClick\").show();\n\t\t\t\t\t$('.mac-dock img').resizeOnApproach();\n\t\t\t\t}\n\t\t\t\tfor(x=0; x <= max; x+=1) {\n\t\t\t\t\tevents[x] = [];\n\t\t\t\t\t// fitd_events[x] = [];\n\t\t\t\t\t// fd_dates[x] = [];\n\t\t\t\t\t// page_locations[x] = [];\n\t\t\t\t\t// rose_events[x] = [];\n\t\t\t\t\t// rose_dates[x] = [];\n\t\t\t\t\t// sh_events[x] = [];\n\t\t\t\t\t// sh_dates[x] = [];\n\t\t\t\t}\n\t\t\t\t$('#home').click(function() {\n\t\t\t\t\thome();\n\t\t\t\t})\n\n\t\t\t\t$('#about_tab').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\tif($('#about_links').is(':visible')) {\n\t\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#about_links').show();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tvar credits_visible = false;\n\t\t\t\t$('#credits').click(function() {\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\t$('#dock-container').hide();\n\t\t\t\t\t$('#upClick').hide();\n\t\t\t\t\t$('#downClick').hide();\n\t\t\t\t\t$('#shelf_instructions').hide();\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t\n\t\t\t\t\tshow_credits();\n\t\t\t\t\t\n\t\t\t\t})\n\t\t\t\t$('#search_tab').click(function() {\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\tif($('#search_links').is(':visible')) {\n\t\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#search_links').show();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t$('#visualize_tab').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\t$('#lc_graph_force').hide();\n\t\t\t\t\t$('#lc_graph_bipartite').hide();\n\t\t\t\t\t\n\t\t\t\t\t// $('#visualize_links').show();\n\t\t\t\t\tif($('#visualize_links').is(':visible')) {\n\t\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#visualize_links').show();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t$('#commentary_tab').click(function() {\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\tif($('#commentary_links').is(':visible')) {\n\t\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#commentary_links').show();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t$('#characters_tab, #characters_link').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\twindow.open('characters.html','_blank');\n\t\t\t\t})\n\t\t\t\t$('#events_tab, #events_link').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\twindow.open('events.html', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#locations_tab, #locations_link').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\twindow.open('locations.html', '_blank');\n\t\t\t\t})\n\t\t\t\t// $('#location_character_tab, #location_character_graph').click(function() {\n\t\t\t\t// \t$('#visualize_links').hide();\n\t\t\t\t// \twindow.open('http://faulkner.ontoligent.com/vis', '_blank');\n\t\t\t\t// })\n\t\t\t\t$('#character_event_graph').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('characters-graph.html?textkey_na='+current_book, '_blank');\n\t\t\t\t})\n\t\t\t\t$('#lc_graph_force').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('characters-force.html?text_na='+current_book, '_blank');\n\t\t\t\t})\n\t\t\t\t$('#lc_graph_bipartite').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('characters-bipart.html?text_na='+current_book, '_blank');\n\t\t\t\t})\n\t\t\t\t$('#character_character_graph').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('char-char-force.html?text_na='+current_book, '_blank');\n\t\t\t\t})\n\t\t\t\t$('#spatial_heatmap').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('http://faulkner.iath.virginia.edu/media/resources/DISPLAYS/HeatmapsHP.html', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#temporal_heatmap').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\twindow.open('http://faulkner.iath.virginia.edu/media/resources/DISPLAYS/TemporalHeatmapsHP.html', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#robbie_dedication').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/dedication', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#index_of_manuscripts').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/indexofmssetc', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#illustrations').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/indexofmagazineillustrations', '_blank');\n\t\t\t\t})\n\t\t\t\t$('#bibliography').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/digital-yoknapatawpha-bibliography', '_blank');\n\t\t\t\t})\n\n\t\t\t\t$('#re-presenting').click(function() {\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/digital-yoknapatawpha-articles-presentations', '_blank');\n\t\t\t\t})\n\n\t\t\t\t$('#faulkner_maps').click(function() {\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.iath.virginia.edu/media/resources/DISPLAYS/FaulknerMapsHP.html', '_blank');\n\t\t\t\t})\n\n\t\t\t\t$('#about_cemetary').click(function() {\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\twindow.open('YokCemeteries.html', '_blank');\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t$('#first_families').click(function() {\n\t\t\t\t\t$('#commentary_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.iath.virginia.edu/family', '_blank');\n\t\t\t\t})\n\n\t\t\t\t$('#photographs').click(function() {\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t$('#visual_sub_menu').hide();\n\t\t\t\t\t$('#about_links').hide();\n\t\t\t\t\twindow.open('http://faulkner.drupal.shanti.virginia.edu/content/indexofphotogalleries', '_blank');\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t// narrative_structure_analysis and narrative_structure_graphs both point to the same link, but present in two differnt tabs: Visualizations ad Commentaries\n//\t\t\t\t$('#narrative_structure_graphs').click(function() {\n//\t\t\t\t\t$('#visualize_links').hide();\n//\t\t\t\t\t$('#visual_sub_menu').hide();\n//\t\t\t\t\t$('#about_links').hide();\n//\t\t\t\t\twindow.open('http://hero.village.virginia.edu/~rwb3y/faulkner/narrative_status', '_blank');\n//\t\t\t\t})\n//\t\t\t\t\n//\t\t\t\t$('#narrative_structure_analysis').click(function() {\n//\t\t\t\t\t$('#commentary_links').hide();\n//\t\t\t\t\twindow.open('http://hero.village.virginia.edu/~rwb3y/faulkner/narrative_status', '_blank');\n//\t\t\t\t})\n//\t\t\t\t\n\t\t\t\t\n\t\t\t\t$('#career_tab').click(function() {\n\t\t\t\t\twindow.location = 'text.html';\n\t\t\t\t})\n\t\t\t\t$('.mac-dock img').click(function() {\n\t\t\t\t\t$('#search_links').hide();\n\t\t\t\t\t$('#visualize_links').hide();\n\t\t\t\t\t\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t$('#location_character_graph').click(function() {\n\t\t\t\t\t$('#spatial_heatmap').hide();\n\t\t\t\t\t$('#temporal_heatmap').hide();\n\t\t\t\t\t$('#visual_sub_menu').css('top', '25px');\n\t\t\t\t\t$('#visual_sub_menu').show();\n\t\t\t\t\t$('#lc_graph_force').show();\n\t\t\t\t\t$('#lc_graph_bipartite').show();\n\t\t\t\t})\n\t\t\t\t$('#heatmap').click(function() {\n\t\t\t\t\t$('#lc_graph_force').hide();\n\t\t\t\t\t$('#lc_graph_bipartite').hide();\n\t\t\t\t\t$('#visual_sub_menu').css('top', '79px');\n\t\t\t\t\t$('#visual_sub_menu').show();\n\t\t\t\t\t$('#spatial_heatmap').show();\n\t\t\t\t\t$('#temporal_heatmap').show();\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t$.each(books, function(index, value) {\n\t\t\t\t\t$(value['icon']).click(function() {\n\t\t\t\t\t\tshow_book(value['book'], value['content'], value['manmade'], value['natural'], value['heatmap'], value['extra']);\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t$('#show_character_list').click(function() {\n\t\t\t    if (this.checked) {\n\t\t\t\t\t\t$('#character_list').dialog('open');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#character_list').dialog('close');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\t$('#show_location_list').click(function() {\n\t\t\t    if (this.checked) {\n\t\t\t\t\t\n\t\t\t\t\t\t$('#location_list').dialog('open');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#location_list').dialog('close');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t$('#locations').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\tvalue.show();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t\t$('#event-locations').removeAttr('checked');\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\n\t\t\t\t$('#no-locations').click(function() {\n\t\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t});\n\n\t\t\t\t$(document).on('click', '#location-search', function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t$.each(search_locations, function(index, value) {\n\t\t\t\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\t\t\t\tvalue.show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t\t// $('#location-search').removeAttr('checked');\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\n\t\t\t\t$('#event-locations').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t$.each(current_events, function(index, value) {\n\t\t\t\t\t\t\t$.each(value, function(i, v) {\n\t\t\t\t\t\t\t\t$.each(v.replace(/, /g,'--').split(','), function(ii, vv) {\n\t\t\t\t\t\t\t\t\tif(current_locations[vv.replace('--',', ')] != null) {\n\t\t\t\t\t\t\t\t\t\tcurrent_locations[vv.replace('--',', ')].show();\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconsole.log('missing location: '+vv);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t$('#locations').removeAttr('checked');\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\n\t\t\t\t$('#events').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\t\t$.each(current_event_logos, function(index, value) {\n\t\t\t\t\t\t\t\tvalue.moveToBottom();\n\t\t\t\t\t\t\t\tvalue.setOpacity(0.5);\n\t\t\t\t\t\t\t\tvalue.show();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tif(inset_image != null) {\n\t\t\t\t\t\t\t\tinset_image.moveToBottom();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(out_yok != null) {\n\t\t\t\t\t\t\t\tout_yok.moveToBottom();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t\t$.each(event_dates, function(i, v) {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\thighlight_date(v);\n\t\t\t\t\t\t\t}) \n\t\t\t\t\t\t\tfade_dates();\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\t$.each(current_event_logos, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tif(inset_image != null) {\n\t\t\t\t\t\t\t\t\tinset_image.moveToBottom();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(out_yok != null) {\n\t\t\t\t\t\t\t\t\tout_yok.moveToBottom();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t\t\t$.each(event_dates, function(i, v) {\n\t\t\t\t\t\t\t\t\t$(v).hide();\n\t\t\t\t\t\t\t\t}) \n\t\t\t\t    }\n\t\t\t\t});\n\n\t\t\t\t$('#natural').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\tnatural.show();\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    } else {\n\t\t\t\t\t\tnatural.hide();\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\t\t\t\t$('#manmade').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\tmanmade.show();\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\tmanmade.hide();\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\t\t\t\t$('#characters').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\t\t\t$.each(current_characters, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.show();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\t\t\t$.each(current_characters, function(index, value) {\n\t\t\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t    }\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$('#heatmap_toggle').click(function() {\n\t\t\t\t    if (this.checked) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t\t\theatmap_image.show();\n\t\t\t\t\t\t\n\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\t\t\t\tvalue.hide();\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t$('#locations').removeAttr('checked');\n\t\t\t\t    } else {\n\t\t\t\t\t\theatmap_image.hide();\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t$.each(active_locations, function(index, value) {\n\t\t\t\t\t\t\tvalue.show();\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t$('#locations').attr('checked','true');\n\t\t\t\t\t\t\t\t\n\t\t\t\t    }\n\t\t\t\t    if ($('#locations').attr('checked')) {\n\t\t\t\t        // the checkbox was checked \n\t\t\t\t    } else {\n\t\t\t\t        // the checkbox was unchecked\n\t\t\t\t    }\n\t\t\t\t\t\n\t\t\t\t});\n\n\t\t\t\t// $( \"#slider\" ).slider({ min: min, \n\t\t\t\t// \t\tmax: max,\n\t\t\t\t// \t\tslide: function( event, ui ) {\n\t\t\t\t// \t\t\t// if (ui.value < start_page) {\n\t\t\t\t// \t\t\t// \t$('#slider').slider('value', start_page);\n\t\t\t\t// \t\t\t// } \n\t\t\t\t// \t\t\t// if (ui.value > end_page) {\n\t\t\t\t// \t\t\t// \t$('#slider').slider('value', end_page);\n\t\t\t\t// \t\t\t// } \n\t\t\t\t// \t\t\tanimate_location(prev, ui.value, current_events, current_locations);\n\t\t\t\t// \n\t\t\t\t// \t\t\tanimate_date(ui.value, current_dates);\n\t\t\t\t// \t\t\t\tcontentLayer.draw();\n\t\t\t\t// \t\t\t\t// $(\".range_item\").hide();\n\t\t\t\t// \t\t\t          $(\"#label\").text('Page '+ui.value);\n\t\t\t\t// \t\t\t          // $(\"#label\").css(\"margin-left\", (ui.value-min)/(max-min)*100+\"%\");\n\t\t\t\t// \t\t\t          // $(\"#label\").css(\"left\", \"-25px\");\n\t\t\t\t// \t\t\t\tprev = ui.value;\n\t\t\t\t// \t\t\t      } });\n\n\t\t\t\t\t\t$( \"#speed\" ).slider({ min: -500, \n\t\t\t\t\t\t\t\tmax: -10,\n\t\t\t\t\t\t\t\tvalue: -250,\n\t\t\t\t\t\t\t\tslide: function( event, ui ) {\n\t\t\t\t\t\t\t\t\tspeed = ui.value;\n\t\t\t      } });\n\t\t\t\t\t\t$( \"#e_speed\" ).slider({ min: -500, \n\t\t\t\t\t\t\t\tmax: -10,\n\t\t\t\t\t\t\t\tvalue: -250,\n\t\t\t\t\t\t\t\tslide: function( event, ui ) {\n\t\t\t\t\t\t\t\t\te_speed = ui.value;\n\t\t\t      } });\n\t\t\t\t\t\t$( \"#c_speed\" ).slider({ min: -500, \n\t\t\t\t\t\t\t\tmax: -10,\n\t\t\t\t\t\t\t\tvalue: -250,\n\t\t\t\t\t\t\t\tslide: function( event, ui ) {\n\t\t\t\t\t\t\t\t\tc_speed = ui.value;\n\t\t\t      } });\n\t\t\t\t\n\t\t\t\t    $( \"#plus\" )\n\t\t            .button({ icons: { primary: \"ui-icon-plus\" }, text: false })\n\t\t            .click(function( event ) {\n\t\t\t\t\t\t\t    if(contentLayer.getScale().x < 2.1) {\n\t\t\t\t\t\t\t\t\t\t// console.log(contentLayer.getX()+\",\"+contentLayer.getY()+\",\"+contentLayer.getScale());\n\t\t\t\t\t\t\t        // contentLayer.setScale(contentLayer.getScale().x+0.1);\n\t\t\t\t\t\t\t        contentLayer.scaleX(contentLayer.getScale().x+0.1);\n\t\t\t\t\t\t\t        contentLayer.scaleY(contentLayer.getScale().y+0.1);\n\t\t\t\t\t\t\t\t\t\t\t// console.log(contentLayer.getScale());\n\t\t\t\t\t\t\t\t\t\t\tvar tx = contentLayer.getX()-130;\n\t\t\t\t\t\t\t\t\t\t\tvar ty = contentLayer.getY()-80;\n\t\t\t\t\t\t\t\t\t\t\tif (tx > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\ttx = 0;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (ty > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\tty = 0;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tcontentLayer.position({x:tx, y:ty});\n\t\t\t\t\t\t\t\t\t\t\t// contentLayer.setPosition(contentLayer.getX()/contentLayer.getScale().x  ,contentLayer.getY()/contentLayer.getScale().y );\n\t\t\t\t\t\t\t        contentLayer.draw();\n\t\t\t\t\t\t\t    }\n\t\t            });\n\t\t        $( \"#minus\" )\n\t\t            .button({ icons: { primary: \"ui-icon-minus\" }, text: false })\n\t\t            .click(function( event ) {\n\t\t\t\t\t\t\t\t\t// console.log(contentLayer.getScale().x);\n\t\t\t\t\t\t\t    if(contentLayer.getScale().x > 0.306) {\n\t\t\t\t\t\t\t        // contentLayer.setScale(contentLayer.getScale().x-0.1);\n\t\t\t\t\t\t\t        contentLayer.scaleX(contentLayer.getScale().x-0.1);\n\t\t\t\t\t\t\t        contentLayer.scaleY(contentLayer.getScale().y-0.1);\n\t\t\t\t\t\t\t\t\t\t\tvar tx = contentLayer.getX()+130;\n\t\t\t\t\t\t\t\t\t\t\tvar ty = contentLayer.getY()+80;\n\t\t\t\t\t\t\t\t\t\t\tif (tx > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\ttx = 0;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (ty > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\tty = 0;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tcontentLayer.position({x:tx, y:ty});\n\t\t\t\t\t\t\t\t\t\t\t// contentLayer.setPosition(contentLayer.getX()+130  ,contentLayer.getY()+80 );\n\t\t\t\t\t\t\t        contentLayer.draw();\n\t\t\t\t\t\t\t    }\n\t\t            });\n\t\t        $( \"#reset\" )\n\t\t            .button()\n\t\t            .click(function( event ) {\n\t\t\t\t\t\t\t\t\treset();\n\t\t            });\n\t\t    \n        stage = new Konva.Stage({\n          container: \"container\",\n          width: 800,\n          height: 500\n        });\n\t\t\t\tcontentLayer.setDraggable(\"draggable\");\n        var imageLogo = new Image();\n        var imageObj = new Image();\n        var image_out_yok = new Image();\n\t\t\t\tvar m_down = false;\n\t\t\t\tvar start = 0;\n\t\t\t\tvar stop = 0;\n\t\t\t\t\n\t\t\t\timageLogo.onload = function() {\n          logo = new Konva.Image({\n            x: stage.getWidth() / 2 ,\n            y: stage.getHeight() / 2 -220, // - 231,\n            image: imageLogo,\n            width: 600,\n            height: 462\n          });\n          // add the shape to the contentLayer\n\t\t\t\t\t// logo.setScale(3);\n\t\t\t\t\tlogo.scaleX(3);\n\t\t\t\t\tlogo.scaleY(3);\n          contentLayer.add(logo);\n\t\t\t\t\tlogo.setZIndex(10);\n\t\t\t\t\t// contentLayer.draw();\n\t\t\t\t\t// map.moveToBottom();\n\t\t\t\t\tif(book_param != null) {\n\t\t\t\t\t\tlogo.hide();\n\t\t\t\t\t}\n\n\n        };\n        imageLogo.src = \"title.png\";\n        \n        imageObj.onload = function() {\n          map = new Konva.Image({\n            x: 0, //stage.getWidth() / 2 - 1300,\n            y: 0, //stage.getHeight() / 2 - 800,\n            image: imageObj,\n            width: 2640,\n            height: 1650\n          });\n          // add the shape to the contentLayer\n\t\t\t\t\t// contentLayer.setX(-820+(stage.getWidth() / 2));\n\t\t\t\t\t// contentLayer.setY(-425+(stage.getHeight() / 2));\n\t\t\t\t\tcontentLayer.setX((-1320*0.305)+(stage.getWidth() / 2));\n\t\t\t\t\tcontentLayer.setY((-825*0.305)+(stage.getHeight() / 2));\n          // contentLayer.add(map);\n          backgroundLayer.add(map);\n\t\t\t\t\tmap.setZIndex(-10);\n\t\t\t\t\tmap.moveToBottom();\n\t\t\t\t\t// contentLayer.setScale(0.305);\n\t\t\t\t\tcontentLayer.scaleX(0.305);\n\t\t\t\t\tcontentLayer.scaleY(0.305);\n\t\t\t\t\t// backgroundLayer.setScale(0.305);\n\t\t\t\t\tbackgroundLayer.scaleX(0.305);\n\t\t\t\t\tbackgroundLayer.scaleY(0.305);\n\t\t\t\t\ttooltip = new Konva.Text({\n             text: \"junk\",\n             fontFamily: \"Calibri\",\n             fontSize: 14,\n\t\t\t\t\t\tfontStyle: 'bold',\n             padding: 5,\n             textFill: \"white\",\n             fill: \"black\",\n             alpha: 0.5\n         });\n\t\t\t\trect = new Konva.Rect({\n\t\t\t\t        x: 0,\n\t\t\t\t        y: 0,\n\t\t\t\t        stroke: '#555',\n\t\t\t\t        strokeWidth: 1,\n\t\t\t\t        fill: '#ddd',\n\t\t\t\t        width: 380,\n\t\t\t\t        height: tooltip.getHeight(),\n\t\t\t\t        shadowColor: 'black',\n\t\t\t\t        shadowBlur: 10,\n\t\t\t\t        shadowOffset: [10, 10],\n\t\t\t\t        shadowOpacity: 0.35,\n\t\t\t\t        cornerRadius: 10\n\t\t\t\t      });\n\n\t\t\t   tooltip_group = new Konva.Group({\n\t\t\t        x: 220,\n\t\t\t        y: 40\n\t\t\t      });\n\n\t\t\t\t\ttooltip_group.add(rect);\n\t\t\t\t\ttooltip_group.add(tooltip);\n\t\t\t\t\ttooltip_group.hide();\n          //tooltipLayer.listen(false);\n          tooltipLayer.add(tooltip_group);\n\n\t\t\t   contentLayer_group = new Konva.Group({\n\t\t\t        x: 800,\n\t\t\t        y: 500,\n\t\t\t\t\t\t\tdraggable: true,\n\t\t\t\t\t\t\tdragBoundFunc: function(pos) {\n\t\t\t\t\t\t\t\t// console.log(pos);\n\t\t\t\t\t\t\t}\n\t\t\t      });\n\t\t\t\t\t// contentLayer_group.add(contentLayer);\n\t\t\t\t \n          // add the contentLayer to the stage\n\t\t\t\t\t// contentLayer.hide();\n          stage.add(backgroundLayer);\n          stage.add(contentLayer);\n\t\t\t\t\tstage.add(controlLayer);\n\t\t\t\t\tstage.add(tooltipLayer);\n\t\t\t\t\t\n\n\n        };\n        imageObj.src = \"papertex2b-solid.png\";\n\n\n\t\t\t\t\t        image_out_yok.onload = function() {\n\t\t\t\t\t          out_yok = new Konva.Image({\n\t\t\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t\t\t            image: image_out_yok,\n\t\t\t\t\t            width: 2640,\n\t\t\t\t\t            height: 1650,\n\t\t\t\t\t\t\t\t\t\t\topacity: 0.75\n\t\t\t\t\t          });\n\t\t\t\t\t          // add the shape to the contentLayer\n\t\t\t\t\t\t\t\t\t\tfd_content_outside.push(out_yok);\n\t\t\t\t\t\t\t\t\t\tif(book_param == null) {\n\t\t\t\t\t\t\t\t\t\t\tout_yok.hide();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t          contentLayer.add(out_yok);\n\t\t\t\t\tout_yok.setZIndex(2);\n\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t// map.moveToBottom();\n\t\t\t\t\t        };\n\t\t\t\t\t        image_out_yok.src = \"out_of_yok.png\";\n\n\n\t\t\t\tif(book_param != null) {\n\t\t\t\t\t$.each(books, function(index,value) {\n\t\t\t\t\t\tif (value['book'] == book_param) {\n\t\t\t\t\t\t\tshow_book(book_param, value['content'], value['manmade'], value['natural'], value['heatmap'], value['extra'])\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t// show_book(book_param);\n\t\t\t\t}\n\n\t    });\n\n\n\t\t\tfunction parseDate(str) {\n\t\t\t    var mdy = str.split('-');\n\t\t\t\tvar o = Date.UTC(date_start,01,01)/86400000.0;  // 86400000.0 milliseconds in day\n\t\t\t\t\t// console.log(o);\n\t\t\t\t\tif (parseInt(mdy[0]) < date_start) {\n\t\t\t\t\t\t// mdy = ['1799','6','1']\n\t\t\t\t\t\tmdy = [date_start-1,'6','1']\n\t\t\t\t\t}\n\t\t\t    var d = (Date.UTC(mdy[0], mdy[1], mdy[2].split(\" \")[0]))/86400000.0;\n\t\t\t\treturn [d-o, d-o];\n\t\t\t}\n\t\t\tfunction parseRangeDate(str) {\n\t\t\t    var pair = str.split(' to ')\n\t\t\t\t\tvar mdy = pair[0].split('-');\n\t\t\t\t\tif (parseInt(mdy[0]) < date_start) {\n\t\t\t\t\t\t// mdy = ['1799','6','1']\n\t\t\t\t\t\tmdy = [date_start-1,'6','1']\n\t\t\t\t\t}\n\t\t\t\t\tvar o = Date.UTC(date_start-1,12,31)/86400000.0;\n\t\t\t    var start = (Date.UTC(mdy[0], mdy[1], mdy[2].split(\" \")[0]))/86400000.0;\n\t\t\t\t\t// console.log(o + \" = \"+start);\n\t\t\t\t\tmdy = pair[1].split('-');\n\t\t\t\t\tif (parseInt(mdy[0]) < date_start) {\n\t\t\t\t\t\t// mdy = ['1799','6','1']\n\t\t\t\t\t\tmdy = [date_start-1,'6','1']\n\t\t\t\t\t}\n\t\t\t    var stop = (Date.UTC(mdy[0], mdy[1], mdy[2].split(\" \")[0]))/86400000.0;\n\t\t\t\treturn [start-o, stop-o];\n\t\t\t}\n\t\n\t\tvar hide_locations = function() {\n\t\t\t$.each(locations, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\tcontentLayer.draw();\n\t\t};\n\t\tvar show_locations = function() {\n\t\t\t$.each(locations, function(index, value) {\n\t\t\t\tvalue.show();\n\t\t\t});\n\t\t\tcontentLayer.draw();\n\t\t};\n\t\t\n\t\tfunction animate_characters(prev, current, data) {\n\t\t\tvar offset = 50;\n\t\t\tfor (var loc in page_locations[prev]) {\n\t\t\t\tfor (var evt in page_locations[prev][loc]) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(page_locations[prev][loc][\"characters\"], function (index, value) {\n\t\t\t\t\t\t\tif(data[value] != null) {\n\t\t\t\t\t\t\t\tdata[value][\"image\"].hide();\n\t\t\t\t\t\t\t\t// console.log('show');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(loc);\n\t\t\t\t\t}\n\t\t\t\t\t$.each(page_locations[prev][loc][\"characters\"], function (index, value) {\n\t\t\t\t\t\tif(data[value] != null) {\n\t\t\t\t\t\t\tdata[value][\"image\"].setScale(1);\n\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar char_mode = \"all\";\n\t\t\tif ($('#characters-major').attr('checked')) {\n\t\t\t\tchar_mode = \"major\"\n\t\t\t} else if ($('#characters-major-regular').attr('checked')) {\n\t\t\t\tchar_mode = \"major-regular\"\n\t\t\t} else if ($('#characters-none').attr('checked')) {\n\t\t\t\tchar_mode = \"none\"\n\t\t\t}\n\t\t\t// Iterate over everything occuring on this page, checking for characters in the specified data set. \n\t\t\t// Highlight the origin of the character on the map.\n\t\t\tfor (var loc in page_locations[current]) {\n\t\t\t\tfor (var evt in page_locations[current][loc]) {\n\t\t\t\t\tvar startX=0;\n\t\t\t\t\tvar startY=0;\n\t\t\t\t\tvar hash = {}\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\t$.each(page_locations[current][loc][\"characters\"], function (index, value) {\n\t\t\t\t\t\t\t// current book has character\n\t\t\t\t\t\t\tif (value == \"Unnamed Scottish Engineer\") {\n\t\t\t\t\t\t\t\tconsole.log(all_locations[data[value][\"location\"]]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(data[value] != null) {\n\t\t\t\t\t\t\t\tvar current_class = data[value][\"rank\"];\n\t\t\t\t\t\t\t\t// console.log(current_class);\n\t\t\t\t\t\t\t\tvar display = false;\n\t\t\t\t\t\t\t\tif(char_mode == \"all\") {\n\t\t\t\t\t\t\t\t\tdisplay = true\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tif ((char_mode == \"major\") && (current_class == \"Major\")) {\n\t\t\t\t\t\t\t\t\tdisplay = true;\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tif ((char_mode == \"major-regular\") && ((current_class == \"Major\") || (current_class == \"Secondary\")) ) {\n\t\t\t\t\t\t\t\t\tdisplay = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (display) {\n\t\t\t\t\t\t\t\t\tif (hash[data[value][\"location\"]] == null) {\n\t\t\t\t\t\t\t\t\t\thash[data[value][\"location\"]] = new Array;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thash[data[value][\"location\"]].push(1)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (data[value][\"location\"] == loc) {\n\t\t\t\t\t\t\t\t\t\tdata[value][\"image\"].setX(all_locations[loc].getX()-offset-(offset*hash[data[value][\"location\"]].length));\n\t\t\t\t\t\t\t\t\t\tdata[value][\"image\"].setY(all_locations[loc].getY());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdata[value][\"image\"].setX(all_locations[data[value][\"location\"]].getX()-offset-(offset*hash[data[value][\"location\"]].length));\n\t\t\t\t\t\t\t\t\t\tdata[value][\"image\"].setY(all_locations[data[value][\"location\"]].getY());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// console.log(fitd_locations[loc].getX());\n\t\t\t\t\t\t\t\t\t// offset += 50;\n\t\t\t\t\t\t\t\t\tdata[value][\"image\"].setScale(3);\n\t\t\t\t\t\t\t\t\tdata[value][\"image\"].moveToTop(); //setZIndex(20);\n\t\t\t\t\t\t\t\t\tdata[value][\"image\"].show();\n\t\t\t\t\t\t\t\t\t// console.log('show');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e+\" : \"+loc);\n\t\t\t\t\t}\n\t\t\t\t\t// $.each(page_locations[current][loc][\"characters\"], function (index, value) {\n\t\t\t\t\t// \tif(data[value] != null) {\n\t\t\t\t\t// \t\tdata[value][\"image\"].setScale(3);\n\t\t\t\t\t// }\n\t\t\t\t\t// })\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\tfunction reset_character_selection() {\n\t\t\t$.each(current_characters, function(index, value) {\n\t\t\t\tvalue[\"image\"].hide();\n\t\t\t});\n\t\t\tcontentLayer.draw();\n\t\t\t$.each($('#character_list_content input'), function(i,v) {\n\t\t\t\t$(v).prop(\"checked\",false);\n\t\t\t});\n\t\t}\n\t\t\n\t\tfunction show_specific_characters() {\n\t\t\t$.each(current_characters, function(index, value) {\n\t\t\t\tvalue[\"image\"].hide();\n\t\t\t});\n\t\t\t\n\t\t\tvar show_names = new Array();\n\t\t\t$.each($('#character_list_content input'), function(i,v) {\n\t\t\t\tif (v.checked) {\n\t\t\t\t\tshow_names.push(v.nextSibling.innerHTML);\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar data = current_characters;\n\t\t\tvar offset = 50;\n\n\t\t\t\t\tvar startX=0;\n\t\t\t\t\tvar startY=0;\n\t\t\t\t\tvar hash = {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('--------show characters');\n\t\t\t\t\t\t$.each(character_origin, function (index, value) {\n\t\t\t\t\t\t\tif(data[index] != null) {\n\t\t\t\t\t\t\t\tvar current_class = data[index][\"rank\"];\n\t\t\t\t\t\t\t\t// console.log(current_class);\n\t\t\t\t\t\t\t\tif (show_names.indexOf(index) >= 0) {\n\t\t\t\t\t\t\t\t\tif (hash[data[index][\"location\"]] == null) {\n\t\t\t\t\t\t\t\t\t\thash[data[index][\"location\"]] = new Array;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thash[data[index][\"location\"]].push(1)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (current_locations[data[index][\"location\"]] != null) {\n\t\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setX(current_locations[data[index][\"location\"]].getX()-offset-(offset*hash[data[index][\"location\"]].length));\n\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setY(current_locations[data[index][\"location\"]].getY());\n\t\t\t\t\t\t\t\t\t\t// console.log(data[index][\"image\"].getX()+\",\"+data[index][\"image\"].getY());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconsole.log('missing '+data[index][\"location\"]);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setScale(1.5);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].moveToTop(); //setZIndex(20);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].show();\n\t\t\t\t\t\t\t\t\t// console.log('show');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e+\" : \");\n\t\t\t\t\t}\n\t\t\t\tcontentLayer.draw();\n\t\t}\n\n\t\tfunction reset_location_selection() {\n\t\t\t$('#locations').removeAttr('checked');\n\t\t\t$('#event-locations').removeAttr('checked');\n\t\t\t\n\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\tcontentLayer.draw();\n\t\t\t$.each($('#location_list_content input'), function(i,v) {\n\t\t\t\t$(v).prop(\"checked\",false);\n\t\t\t});\n\t\t}\n\n\t\tfunction show_specific_locations() {\n\t\t\t$('#locations').removeAttr('checked');\n\t\t\t$('#event-locations').removeAttr('checked');\n\t\t\t\n\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\t$.each($('#location_list_content input'), function(i,v) {\n\t\t\t\tif (v.checked) {\n\t\t\t\t\tcurrent_locations[$(this).val().replace('&quot;','\"')].show();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t\tcontentLayer.draw();\n\t\t}\n\t\t\n\t\tfunction sortObject(obj) {\n\t\t    var arr = [];\n\t\t    var prop;\n\t\t    for (prop in obj) {\n\t\t        if (obj.hasOwnProperty(prop)) {\n\t\t            arr.push({\n\t\t                'key': prop,\n\t\t                'value': obj[prop]\n\t\t            });\n\t\t        }\n\t\t    }\n\n\t\t    var property_type = typeof arr[0].value == 'string';\n\t\t    // property_type: true~string, false~number\n\n\t\t    arr.sort(function(a, b) {\n\t\t        return property_type ? a.value.toLowerCase().localeCompare(b.value.toLowerCase()) : a.value - b.value;\n\t\t    });\n\t\t    return arr; // returns array\n\t\t}\n\t\t\t\t\n\t\tfunction show_characters() {\n\t\t\tvar data = current_characters;\n\t\t\t\n\t\t\tif ($('#characters-search').attr('checked')) {\n\t\t\t\t$.each(data, function(i,v) {\n\t\t\t\t\tdata[i][\"image\"].hide();\n\t\t\t\t})\n\t\t\t\tdata = search_characters;\n\t\t\t}\n\t\t\tvar offset = 50;\n\n\t\t\tvar char_mode = \"all\";\n\t\t\tif ($('#characters-major').attr('checked')) {\n\t\t\t\tchar_mode = \"major\"\n\t\t\t} else if ($('#characters-major-regular').attr('checked')) {\n\t\t\t\tchar_mode = \"major-regular\"\n\t\t\t} else if ($('#characters-none').attr('checked')) {\n\t\t\t\tchar_mode = \"none\"\n\t\t\t}\n\t\t\t\t\tvar startX=0;\n\t\t\t\t\tvar startY=0;\n\t\t\t\t\tvar hash = {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('--------show characters');\n\t\t\t\t\t\t// var chars = sortHashTableByKey(character_origin,'rank')\n\t\t\t\t\t\tvar chars = sortObject(character_origin);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(chars, function (i, v) {\n\t\t\t\t\t\t\tindex = v.key;\n\t\t\t\t\t\t\tif(data[index] != null) {\n\t\t\t\t\t\t\t\tvar current_class = data[index][\"rank\"];\n\t\t\t\t\t\t\t\t// console.log(current_class);\n\t\t\t\t\t\t\t\tvar display = false;\n\t\t\t\t\t\t\t\tif(char_mode == \"all\") {\n\t\t\t\t\t\t\t\t\tdisplay = true\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tif ((char_mode == \"major\") && (current_class == \"Major\")) {\n\t\t\t\t\t\t\t\t\tdisplay = true;\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tif ((char_mode == \"major-regular\") && ((current_class == \"Major\") || (current_class == \"Secondary\")) ) {\n\t\t\t\t\t\t\t\t\tdisplay = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ((display) && (data[index]['current'] != null)) {\n\t\t\t\t\t\t\t\t\tif (hash[data[index][\"location\"]] == null) {\n\t\t\t\t\t\t\t\t\t\thash[data[index][\"location\"]] = new Array;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thash[data[index][\"location\"]].push(1)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// if (data[index][\"location\"] == loc) {\n\t\t\t\t\t\t\t\t\t// \t\tdata[index][\"image\"].setX(all_locations[value].getX()-offset-(offset*hash[data[index][\"location\"]].length));\n\t\t\t\t\t\t\t\t\t// \t\tdata[index][\"image\"].setY(all_locations[value].getY());\n\t\t\t\t\t\t\t\t\t// \t} else {\n\t\t\t\t\t\t\t\t\t\tif (current_locations[data[index][\"location\"]] != null) {\n\t\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setX(current_locations[data[index][\"location\"]].getX()-offset-(offset*hash[data[index][\"location\"]].length));\n\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setY(current_locations[data[index][\"location\"]].getY());\n\t\t\t\t\t\t\t\t\t\t// console.log(data[index][\"image\"].getX()+\",\"+data[index][\"image\"].getY());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconsole.log('missing '+data[index][\"location\"]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t// console.log(fitd_locations[loc].getX());\n\t\t\t\t\t\t\t\t\t// offset += 50;\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setScale(1.5);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].moveToTop(); //setZIndex(20);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].show();\n\t\t\t\t\t\t\t\t\t// console.log('show');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e+\" : \");\n\t\t\t\t\t}\n\t\t\t\t\t// $.each(page_locations[current][loc][\"characters\"], function (index, value) {\n\t\t\t\t\t// \tif(data[value] != null) {\n\t\t\t\t\t// \t\tdata[value][\"image\"].setScale(3);\n\t\t\t\t\t// }\n\t\t\t\t\t// })\n\t\t\t\n\t\t}\n\n\t\tfunction show_characters_home() {\n\t\t\tvar data = current_characters;\n\t\t\tvar offset = 50;\n\n\t\t\t\t\tvar startX=0;\n\t\t\t\t\tvar startY=0;\n\t\t\t\t\tvar hash = {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('--------show characters home');\n\t\t\t\t\t\t$.each(character_home, function (index, value) {\n\t\t\t\t\t\t\tif(data[index] != null) {\n\t\t\t\t\t\t\t\tvar current_class = data[index][\"rank\"];\n\t\t\t\t\t\t\t\t// console.log(current_class);\n\t\t\t\t\t\t\t\tvar display = false;\n\t\t\t\t\t\t\t\tif(value != \"\") {\n\t\t\t\t\t\t\t\t\tdisplay = true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (display) {\n\t\t\t\t\t\t\t\t\tif (hash[value] == null) {\n\t\t\t\t\t\t\t\t\t\thash[value] = new Array;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thash[value].push(1)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (current_locations[value] != null) {\n\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setX(current_locations[value].getX()-offset-(offset*hash[value].length));\n\t\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setY(current_locations[value].getY());\n\t\t\t\t\t\t\t\t\t\t// console.log(data[index][\"image\"].getX()+\",\"+data[index][\"image\"].getY());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconsole.log('missing '+value);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t// console.log(fitd_locations[loc].getX());\n\t\t\t\t\t\t\t\t\t// offset += 50;\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].setScale(1.5);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].moveToTop(); //setZIndex(20);\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].show();\n\t\t\t\t\t\t\t\t\t// console.log('show');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdata[index][\"image\"].hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e+\" : \");\n\t\t\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\tfunction animate_location(prev, current, events, locations) {\n\t\t\tif (events[prev] != null) {\n\t\t\t\t$.each(events[prev], function(index, value) {\n\t\t\t\t\t// console.log(value);\n\t\t\t\t\tif (current_event_logos[value] != null) {\n\t\t\t\t\t\tcurrent_event_logos[value].show();\n\t\t\t\t\t\tcurrent_active_event_logos[value].setOpacity(0.35);\n\t\t\t\t\t\tcurrent_active_event_logos[value].hide();\n\t\t\t\t\t\t// current_event_logos[value].setScale(1.25);\n \t\t\t\t\t}\n\t\t\t\t\t// if (locations[value] != null) {\n\t\t\t\t\t// \tlocations[value].setScale(1);\n\t\t\t\t\t// }\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (events[current] != null) {\n\t\t\t\t$.each(events[current], function(index, value) {\n\t\t\t\t\t// console.log(value);\n\t\t\t\t\tif (current_event_logos[value] != null) {\n\t\t\t\t\t\t// current_event_logos[value].moveToBottom();\n\t\t\t\t\t\tcurrent_event_logos[value].show();\n\t\t\t\t\t\tcurrent_active_event_logos[value].setOpacity(0.35);\n\t\t\t\t\t\tcurrent_active_event_logos[value].hide();\n\t\t\t\t\t\t// current_event_logos[value].setZIndex(10);\n\t\t\t\t\t\t// current_event_logos[value].setOpacity(0.35);\n\t\t\t\t\t\t// current_event_logos[value].setScale(1.25);\n\t\t\t\t\t\t// current_event_logos[value].show();\n\t\t\t\t\t}\n\t\t\t\t\t// if (locations[value] != null) {\n\t\t\t\t\t// \tlocations[value].setScale(3);\n\t\t\t\t\t// }\n\t\t\t\t});\n\t\t\t\tif (current_event_logos[events[current][0]] != null) {\n\t\t\t\t\t// current_event_logos[events[current][0]].setScale(1);\n\t\t\t\t\tcurrent_active_event_logos[events[current][0]].setOpacity(1);\n\t\t\t\t\t// current_active_event_logos[events[current][0]].moveToBottom();\n\t\t\t\t\tcurrent_active_event_logos[events[current][0]].show();\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t\t\n\t\tfunction fade_dates() {\n\t\t\tvar fade = GetURLParameter('fade');\n\t\t\t// if (fade == \"y\") {\n\t\t\t\t$(\".range_item\").css('opacity','0.50');\n\t\t\t// }\n\t\t\t$(\".range_item\").css('z-index','99');\n\t\t\t$(\".range_item\").css('background-color','#b227da');\n\t\t\t$(\".range_item\").css('cursor','auto');\n\t\t}\n\t\t\n\t\tfunction highlight_date(value) {\n\t\t\t$(value).css('cursor','pointer');\n\t\t\t\t$(value).css('opacity','1');\n\t\t\t\t$(value).css('background-color','red');\n\t\t\t\t$(value).css('z-index','100');\n\t\t\t\t$(value).show();\n\t\t}\n\t\t\n\t\tfunction animate_date(value, dates) {\n\t\t\t// $(\".range_item\").hide();\n\t\t\tfade_dates();\n\t\t\tif (dates[value] != null) {\n\t\t\t\t$.each(dates[value], function(index, value) {\n\t\t\t\t\t\thighlight_date(value);\n\t\t\t\t\t});\n\t\t\t}\t\t\t\n\t\t}\n\n\t\tfunction animate_event_date() {\n\t\t\t// $(\".range_item\").hide();\n\t\t\tfade_dates();\n\t\t\thighlight_date(event_dates[$('#e_slider').slider('value')]);\n\t\t\t// $(event_dates[$('#e_slider').slider('value')]).css('opacity','1');\n\t\t\t// $(event_dates[$('#e_slider').slider('value')]).css('background-color','red');\n\t\t\t// $(event_dates[$('#e_slider').slider('value')]).show();\n\t\t}\n\t\t\n\t\tfunction animate_section(pos) {\n\t\t\tvar section;\n\t\t\t$.each(current_sections, function(index, value) {\n\t\t\t\tif ((pos >= value['start']) && (pos <= value['stop'])) {\n\t\t\t\t\tsection = index;\n\t\t\t\t\tif (section != current_section) {\n\t\t\t\t\t\t$(\".section_item\").css('background', '#E8E8E8');\n\t\t\t\t\t\tif(GetURLParameter('section') == null) {\n\t\t\t\t\t\t\t$(\"#\"+section).css('background', '#C0C0C0');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$(\"#\"+section).css('background', 'red');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent_section = section;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\t\n\t\tfunction load_images(book, content_container, manmade_image, natural_image, heatmap, extra) {\n\t\t\tdata_loaded = false;\n\t\t\tvar imageObject = new Image();\n\t\t\t        imageObject.onload = function() {\n\t\t\t           natural = new Konva.Image({\n\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t            image: imageObject,\n\t\t\t            width: 2640,\n\t\t\t            height: 1650\n\t\t\t          });\n\t\t\t          // add the shape to the contentLayer\n\t\t\t\tcontent_container.push(natural);\n\t\t\t\t// if(book_param != 'BB') {\n\t\t\t\t// \tbb_natural.hide();\n\t\t\t\t// }\n\t\t\t          contentLayer.add(natural);\n\t\t\t\tnatural.setZIndex(2);\n\t\t\t\tcontentLayer.draw();\n\t\t\t\t// map.moveToBottom();\n\t\t\t        };\n\t\t\t        imageObject.src = natural_image;\n\t\t\t\n\t\t\t\t\t\t\tvar imageObject2 = new Image();\n\t\t\t        imageObject2.onload = function() {\n\t\t\t           manmade = new Konva.Image({\n\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t            image: imageObject2,\n\t\t\t            width: 2640,\n\t\t\t            height: 1650\n\t\t\t          });\n\t\t\t          // add the shape to the contentLayer\n\t\t\t\tcontent_container.push(manmade);\n\t\t\t\t// if(book_param != 'BB') {\n\t\t\t\t// \tbb_manmade.hide();\n\t\t\t\t// }\n\t\t\t          contentLayer.add(manmade);\n\t\t\t\tmanmade.setZIndex(2);\n\t\t\t\tcontentLayer.draw();\n\t\t\t\t// map.moveToBottom();\n\t\t\t    manmade.on('mousemove', function() {\n\t\t\t                                   var mousePos = stage.getPointerPosition();\n\t\t\t                                   var x = mousePos.x;\n\t\t\t                                   var y = mousePos.y;\n\t\t\t                                                           var xo = x/contentLayer.getScale().x-(contentLayer.getX()/contentLayer.getScale().x)-25;\n\t\t\t                                                           var yo = y/contentLayer.getScale().x-(contentLayer.getY()/contentLayer.getScale().x)+50;\n\t\t\t                                                           $('#coords').html(Math.floor(xo)+', '+Math.floor(yo));\n\t\t\t                                   // console.log( 'x: ' + x + ', y: ' + y+', xo: '+xo+', yo: '+yo+\", o:\"+contentLayer.getX()+', s: '+contentLayer.getScale().x);\n\t\t\t                                 });\n\t\t\t\t\n\t\t\t        };\n\t\t\t        imageObject2.src = manmade_image;\n\t\t\t\t\t\n\t\t\t\t\tvar imageObject4 = new Image();\n\t\t\t\t\tif(extra != null) {\n\t\t\t\t\t\tvar imageObject3 = new Image();\n\t\t\t\t\t\t        imageObject3.onload = function() {\n\t\t\t\t\t\t           var extra_img = new Konva.Image({\n\t\t\t\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t\t\t\t            image: imageObject3,\n\t\t\t\t\t\t            width: 2640,\n\t\t\t\t\t\t            height: 1650\n\t\t\t\t\t\t          });\n\t\t\t\t\t\t\t\t  inset_image = extra_img;\n\t\t\t\t\t\t          // add the shape to the contentLayer\n\t\t\t\t\t\t\tcontent_container.push(extra_img);\n\t\t\t\t\t\t\t// if(book_param != 'BB') {\n\t\t\t\t\t\t\t// \tbb_natural.hide();\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t          contentLayer.add(extra_img);\n\t\t\t\t\t\t\textra_img.setZIndex(30);\n\t\t\t\t\t\t\tcontentLayer.draw();\n\t\t\t\t\t\t\t// map.moveToBottom();\n\t\t\t\t\t        imageObject4.onload = function() {\n\t\t\t\t\t           var heat_img = new Konva.Image({\n\t\t\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t\t\t            image: imageObject4,\n\t\t\t\t\t            width: 2640,\n\t\t\t\t\t            height: 1650\n\t\t\t\t\t          });\n\t\t\t\t\t\t\t  heatmap_image = heat_img;\n\t\t\t\t\t\t\t  heat_img.hide();\n\t\t\t\t\t          // add the shape to the contentLayer\n\t\t\t\t\t\tcontent_container.push(heat_img);\n\t\t\t\t\t\t// if(book_param != 'BB') {\n\t\t\t\t\t\t// \tbb_natural.hide();\n\t\t\t\t\t\t// }\n\t\t\t\t\t          contentLayer.add(heat_img);\n\t\t\t\t\t\theat_img.setZIndex(45);\n\t\t\t\t\t\t// contentLayer.draw();\n\t\t\t\t\t\t// map.moveToBottom();\n\t\t\t\t\t        };\n\t\t\t\t\t        imageObject4.src = heatmap;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t        };\n\t\t\t\t\t\t        imageObject3.src = extra;\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t        imageObject4.onload = function() {\n\t\t\t\t\t\t           var heat_img = new Konva.Image({\n\t\t\t\t\t\t            x: 0, //stage.getWidth() / 2 - 1300,\n\t\t\t\t\t\t            y: 0, //stage.getHeight() / 2 - 800,\n\t\t\t\t\t\t            image: imageObject4,\n\t\t\t\t\t\t            width: 2640,\n\t\t\t\t\t\t            height: 1650\n\t\t\t\t\t\t          });\n\t\t\t\t\t\t\t\t  heatmap_image = heat_img;\n\t\t\t\t\t\t\t\t  heat_img.hide();\n\t\t\t\t\t\t          // add the shape to the contentLayer\n\t\t\t\t\t\t\tcontent_container.push(heat_img);\n\t\t\t\t\t\t\t// if(book_param != 'BB') {\n\t\t\t\t\t\t\t// \tbb_natural.hide();\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t          contentLayer.add(heat_img);\n\t\t\t\t\t\t\theat_img.setZIndex(45);\n\t\t\t\t\t\t\t// contentLayer.draw();\n\t\t\t\t\t\t\t// map.moveToBottom();\n\t\t\t\t\t\t        };\n\t\t\t\t\t\t        imageObject4.src = heatmap;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\n\t\t\tgetText(book);\n\t\t\t$('#bb_title').show();\n      $.each(content_container, function(index, value) {\n\t\t\t\tvalue.show();\n\t\t\t});\n\t\t\t\n\t\t}\n\t\tvar show_book = function(book, content_container, manmade_image, natural_image, heatmap, extra) {\n\t\t\t// stage.add(contentLayer);\n\t\t\t// $(\"#slider\").slider(\"refresh\");\n\t\t\t$('#credits_content').hide();\n\t\t\t\n\t\t\t$('#loading').show();\n\t\t\ttry {\n\t\t\t\tlogo.hide();\n\t\t\t} catch(e) {\n\t\t\t\t\n\t\t\t}\n\t\t\t$('#zoom').show();\n\t\t\t//       $.each(current_content, function(index, value) {\n\t\t\t// \tvalue.hide();\n\t\t\t// });\n\t\t\tcurrent_book = book;\n\t\t\t\n\t\t\tif (book == 'HEAT') {\n\t\t\t\tdate_start = 1929;\n\t\t\t\t$('#date_labels').html('<span>1930</span><span></span><span></span><span>1940</span><span></span><span></span><span>1950</span><span></span><span></span><span>1960</span>');\n\t\t\t\t// $('#date_labels span').css('width','44px');\n\t\t\t\t$('#date_labels span').css('width','81px');\n\t\t\t\t$('#date_labels').css('margin-left','-17px');\n\t\t\t\t$('#date_labels').css('margin-top','-40px');\n\t\t\t\t$('#dates').css('width','808px');\n\t\t\t\t$('#dates').css('border','none');\n\t\t\t\t$('#dates').css('border-top','2px solid black');\n\t\t\t\t$('#dates').css('margin-top','25px');\n\t\t\t\t// $('#dates').css('background-image', 'url(heat-ticks.png)');\n\t\t\t\tb = Date.UTC(1929,01,01)/86400000.0;\n\t\t\t\te = Date.UTC(1962,01,01)/86400000.0;\n\t\t\t\tdiff = e-b;\n\t\t\t\t\n\t\t\t\t$(\"<div class=\\\"first_event tick\\\" style=\\\"left:\"+800/diff*((365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$(\"<div class=\\\"first_event tick\\\" style=\\\"left:\"+800/diff*(365+(10*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$(\"<div class=\\\"first_event tick\\\" style=\\\"left:\"+800/diff*(365+(20*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$(\"<div class=\\\"first_event tick\\\" style=\\\"left:\"+800/diff*(365+(30*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$('.first_event').css('margin-top','0px');\n\t\t\t\t\n\t\t\t\t$(\"<div class=\\\"small_tick tick\\\" style=\\\"left:\"+800/diff*(365+(5*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$(\"<div class=\\\"small_tick tick\\\" style=\\\"left:\"+800/diff*(365+(15*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\t\t\t\t$(\"<div class=\\\"small_tick tick\\\" style=\\\"left:\"+800/diff*(365+(25*365))+\"px;width:1px\\\"></div>\").appendTo('#dates');\n\n\t\t\t\t// $('.first_event').css('display','none !important');\n\t\t\t}\n\t      $.each(books, function(index, value) {\n\t\t\t  if (value['content'].length > 0)\n\t\t\t  \tvalue['content'].hide();\n\t\t  });\n\t\t\t\n\t\t\tstart_page = 1000;\n\t\t\t\n\t\t\tload_images(book, content_container, manmade_image, natural_image, heatmap, extra);\n\t\t\tif (GetURLParameter('heat') != null) {\n\t\t\t\tvar mo = GetURLParameter('mo') || 0.8;\n\t\t\t\tvar mino = GetURLParameter('mino') || 0;\n\t\t\t\tvar r = GetURLParameter('r') || 40;\n\t\t\t\tvar bl = GetURLParameter('bl') || 0.9;\n\t\t\t\tvar g0v = GetURLParameter('g0v') || 0.01;\n\t\t\t\tvar g0c = GetURLParameter('g0c') || \"FFFFFF\";\n\t\t\t\tvar g1v = GetURLParameter('g1v') || 0.2;\n\t\t\t\tvar g1c = GetURLParameter('g1c') || \"0000FF\";\n\t\t\t\tvar g2v = GetURLParameter('g2v') || 0.55;\n\t\t\t\tvar g2c = GetURLParameter('g2c') || \"00FF00\";\n\t\t\t\tvar g3v = GetURLParameter('g3v') || 0.85;\n\t\t\t\tvar g3c = GetURLParameter('g3c') || \"FFFF00\";\n\t\t\t\tvar g4v = GetURLParameter('g4v') || 1.0;\n\t\t\t\tvar g4c = GetURLParameter('g4c') || \"FF0000\";\n\t\t\t\tvar baselayer = GetURLParameter('base') || false;\n\t\t\t\tvar baselayer_save = GetURLParameter('base-save') || false;\n\t\t\t\tvar base_x = GetURLParameter('base-x') || '20';\n\t\t\t\tvar base_y = GetURLParameter('base-y') || '20';\n\t\t\t\tbase_x = parseInt(base_x);\n\t\t\t\tbase_y = parseInt(base_y);\n\t\t\t\tvar gd = {};\n\t\t\t\tgd[g0v] = '#'+g0c;\n\t\t\t\tgd[g1v] = '#'+g1c;\n\t\t\t\tgd[g2v] = '#'+g2c;\n\t\t\t\tgd[g3v] = '#'+g3c;\n\t\t\t\tgd[g4v] = '#'+g4c;\n\t\t\t\t\n\t\t\t\t// $('#heatmap-canvas').show();\n\t\t        heatmap_layer = h337.create({\n\t\t          container: document.getElementById('container'),\n\t\t\t\t\tgradient: gd,\n\t\t\t\t\t// gradient: {.2: '#'+g2c, .55: '#'+g2c, .85: '#'+g3c, 1: '#'+g4c},\n\t\t          // a waterdrop gradient ;-)\n\t\t          // gradient: { .1: 'rgba(0,0,0,0)', 0.25: \"rgba(0,0,90, .6)\", .5: \"blue\", .75: \"cyan\", .95: 'rgba(255,255,255,.4)'},\n\t\t          maxOpacity: mo,\n\t\t\t\t\tminOpacity: mino,\n\t\t          radius: r,\n\t\t\t\t\tblur: bl\n\t\t        });\n\t\t\t\t\n\t\t\t\theatmap_layer.addData({x:0, y:0, value:1})\n\t\t\t\tif(baselayer) {\n\t\t\t\t\tconsole.log(base_x+1);\n\t\t\t\t\tfor(var x=0;x <= 800; x+=base_x) {\n\t\t\t\t\t\tfor(var y=0;y <= 500; y+=base_y) {\n\t\t\t\t\t\t\theatmap_layer.addData({x:x, y:y, value:1})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.log('contents:');\n\t\t\t\tconsole.log(heatmap_layer.getData());\n\n\t\t        heatmap_layer_save = h337.create({\n\t\t          container: document.getElementById('heatmap-canvas'),\n\t\t\t\t\tgradient: gd,\n\t\t\t\t\t// gradient: {.2: '#'+g2c, .55: '#'+g2c, .85: '#'+g3c, 1: '#'+g4c},\n\t\t          // a waterdrop gradient ;-)\n\t\t          // gradient: { .1: 'rgba(0,0,0,0)', 0.25: \"rgba(0,0,90, .6)\", .5: \"blue\", .75: \"cyan\", .95: 'rgba(255,255,255,.4)'},\n\t\t          maxOpacity: mo,\n\t\t\t\t\tminOpacity: mino,\n\t\t          radius: r*3.5,\n\t\t\t\t\tblur: bl\n\t\t        });\n\t\t\t\t\n\t\t\t\theatmap_layer_save.addData({x:0, y:0, value:0})\n\t\t\t\tif(baselayer_save) {\n\t\t\t\t\tfor(var x=0;x < 2460; x+=(base_x*4)) {\n\t\t\t\t\t\tfor(var y=0;y < 1650; y+=(base_y*4)) {\n\t\t\t\t\t\t\theatmap_layer_save.addData({x:x, y:y, value:1})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$('#heat-info').append('<button type=\"button\" onclick=\"saveImage()\">save image</button>')\n\t\t\t\t$('#heat-info').append(\"<button type=\\\"button\\\" onclick=\\\"$('#heat-info-table').tableToCSV()\\\">export csv</button>\");\n\t\t\t}\n\n      $.each(fd_content_outside, function(index, value) {\n\t\t\t\tvalue.show();\n\t\t\t});\n\n\t\t\t// s = $(\"#slider\").slider(\"value\", start_page);\n\t\t\t// $('#label').html('Page '+start_page);\n\t\t\t// \n\t\t\t// contentLayer.draw();\n\t\t\t// $('.mac-dock img').hide();\n\t\t\t// $(\"#layers\").show();\n\t\t\t// $(\"#playback_controls\").show();\n\t\t\t// $(\"#controls\").show();\n\t\t\t// $(\"#dates\").show();\n\t\t\t// $(\"#date_labels\").show();\n\t\t}\n\t\t\n\t\tvar home = function() {\n\t\t\t$('#search_links').hide();\n\t\t\twindow.location = window.location.href.substring(0,window.location.href.indexOf(\"?\"));\n\t\t\t\n\t\t}\n\t\tfunction show_credits() {\n\t\t\tstarted_event_mode = false;\n\t\t\tstarted_chron_mode = false;\n\t\t\tstart_page = 1000;\n\t\t\tend_page = 1;\n\t\t\tevents_images_in_order = new Array();\n\t\t\tevents_images_in_chron_order = new Array();\n\t\t\tchron_order = new Array();\n\t\t\tcurrent_sections = new Array();\n\t\t\tcurrent_editors = new Array();\n\t\t\tevent_data = {};\n\t\t\tevent_dates = new Array();\n\t\t\t// current_events_start = {};\n\t\t\t// current_event_logos = {};\n\t\t\t// current_characters = {};\n\t\t\t// current_events = {};\n\t\t\t// current_locations = {};\n\t\t\t// current_data = {};\n\t\t\t// current_dates = {};\n\t\t\t// current_text = {};\n\t\t\t// current_section = '';\n\t\t\t// locations_people = {};\n\t\t\t// locations_events = {};\n\t\t\tlocation_descriptions = {};\n\t\t\tlocation_labels = {};\n\t\t\tcurrent_events_start = {};\n\t\t\t\n\t\t\tcontentLayer.setScale(0.305);\n\t\t\tcontentLayer.setPosition(0,0);\n\t\t\tcontentLayer.show();\n\t\t\t$('#credits_content').show();\n\t\t\tlogo.hide();\n\t\t\tcontentLayer.draw();\n\t\t\t\n\t\t\ttry {\n\t\t\t$('#sections').html('');\n\t\t\t$('#title').hide();\n\t\t\t$('#events').prop('checked',false);\n\t\t\t$('#natural').prop('checked',true);\n\t\t\t$('#manmade').prop('checked',true);\n\t\t\t$('#locations').prop('checked',true);\n\t\t\t$('#characters-none').prop('checked',true);\n\t\t\t$('#show_character_list').prop('checked',false);\n\t\t\t$('#dialog').dialog(\"close\");\n\t\t\t$('#layer_dialog').dialog(\"close\");\n\t\t\t$('#character_list').dialog(\"close\");\n\t\t\t$('#character_list_content').html(\"\");\n\t\t\t$('#zoom').hide();\n\t\t\t$('#reset_all').hide();\n\t\t\t$('#section_label').hide();\n\t\t\t$.each(fd_content, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\t$.each(fd_content_outside, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\t//       $.each(re_content, function(index, value) {\n\t\t\t// \tvalue.hide();\n\t\t\t// });\n\t\t\t//       $.each(sh_content, function(index, value) {\n\t\t\t// \tvalue.hide();\n\t\t\t// });\n\t\t\t//       $.each(ds_content, function(index, value) {\n\t\t\t// \tvalue.hide();\n\t\t\t// });\n\t\t\t//       $.each(bb_content, function(index, value) {\n\t\t\t// \tvalue.hide();\n\t\t\t// });\n\t\t\t$.each(current_characters, function(index, value) {\n\t\t\t\tvalue[\"image\"].hide();\n\t\t\t});\n\t\t\t$.each(current_locations, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\t$.each(current_event_logos, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\t$.each(current_active_event_logos, function(index, value) {\n\t\t\t\tvalue.hide();\n\t\t\t});\n\t\t\tcontentLayer.draw();\n\t\t\t// $('.mac-dock img').show();\n\t\t\t$(\"#layers\").hide();\n\t\t\t$(\"#playback_controls\").hide();\n\t\t\t$(\"#controls\").hide();\n\t\t\t$(\"#event_controls\").hide();\n\t\t\t$(\"#chron_controls\").hide();\n\t\t\t$(\"#sections\").hide();\n\t\t\t$(\"#dates\").hide();\n\t\t\t$(\"#dates\").html('');\n\t\t\t$(\"#date_labels\").hide();\n\t\t\t$(\".range_item\").hide();\n\t\t\t$('#titles').children('div').each( function(index) {\n\t\t\t\tthis.style.display = \"none\";\n\t\t\t});\n\t\t\t$('#e_slider').slider('value',0);\n\t\t\t$('#c_slider').slider('value',0);\n\t\t} catch(e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t\t}\n    </script>\n  </head>\n  <body>\n\t    <div id=\"heatmap-canvas\">\n\t    </div>\n\t\t<div id=\"loading\">Loading...</div>\n\t\t<div id=\"dialog\" title=\"Information\"></div>\n\t\t<div id=\"search_criteria\" title=\"Seach Criteria\"></div>\n\t\t<div id=\"event_words\"></div>\n\t\t<div id=\"content\">\n\t\t\t<div id=\"home\">Home</div>\n\t\t\t<div id=\"about_tab\">About</div>\n\t\t\t<div id=\"about_links\">\n\t\t\t\t<div id=\"credits\">Credits</div>\n\t\t\t\t<div id=\"robbie_dedication\">Dedication</div>\n\t\t\t\t<div id=\"index_of_manuscripts\">Index of Manuscripts Etc.</div>\n\t\t\t\t<div id=\"illustrations\">Index Of Illustrations</div>\n\t\t\t\t<div id=\"bibliography\">Bibliography</div>\n\t\t\t\t<div id=\"re-presenting\">Re-Presenting DY</div>\n\t\t\t</div>\n\t\t\t<div id=\"search_tab\">Search</div>\n\t\t\t<!-- <div id=\"events_tab\">Search Events</div>\n\t\t\t<div id=\"locations_tab\">Search Locations</div> -->\n\t\t\t<!-- <div id=\"career_tab\">Career</div> -->\n\t\t\t<div id=\"search_links\">\n\t\t\t\t<div id=\"events_link\">Events</div>\n\t\t\t\t<div id=\"characters_link\">Characters</div>\n\t\t\t\t<div id=\"locations_link\">Locations</div>\n\t\t\t</div>\n\t\t\t<div id=\"visualize_tab\">Visualizations</div>\n\t\t\t<div id=\"visualize_links\">\n\t\t\t\t<div id=\"location_character_graph\">Location-Character Graphs</div>\n\t\t\t\t<div id=\"character_character_graph\">Character-Character Graphs</div>\n\t\t\t\t<div id=\"character_event_graph\">Character-Event Graphs</div>\n\t\t\t\t<div id=\"heatmap\">Heatmaps</div>\n\t\t\t\t<div id=\"photographs\">Photographs</div>\n<!--\t\t\t\t<div id=\"narrative_structure_graphs\">Narrative Structure Graphs</div>\n-->\t\t\t\t\n\t\t\t</div>\n\t\t\t<div id=\"visual_sub_menu\">\n\t\t\t\t<div id=\"lc_graph_force\">Force Directed</div>\n\t\t\t\t<div id=\"lc_graph_bipartite\">Bipartite</div>\n\t\t\t\t<div id=\"spatial_heatmap\">Spatial</div>\n\t\t\t\t<div id=\"temporal_heatmap\">Temporal</div>\n\t\t\t</div>\n\t\t\t<div id=\"commentary_tab\">Commentaries</div>\n\t\t\t<div id=\"commentary_links\">\n\t\t\t\t<div id=\"faulkner_maps\">Faulkner &amp; Maps</div>\n\t\t\t\t<div id=\"about_cemetary\">Faulkner's Cemeteries</div>\n\t\t\t\t<div id=\"first_families\">Genealogies</div>\n\t\t\n\t\t\t</div>\n\t\t\t<div id=\"mapit_tab\">\n\t\t\t\tDIGITAL YOKNAPATAWPHA: MapIt\n\t\t\t</div>\n\t\t\t <div id=\"close_window\" onclick=\"window.close()\">\n\t\t\t\t <span>CLOSE WINDOW</span>\n\t\t\t </div>\n\t    <div id=\"container\"><div class=\"konvajs-content\" role=\"presentation\" style=\"position: relative; width: 800px; height: 500px;\"><canvas width=\"1600\" height=\"1000\" style=\"padding: 0px; margin: 0px; border: 0px; background: transparent; position: absolute; top: 0px; left: 0px; width: 800px; height: 500px;\"></canvas><canvas width=\"1600\" height=\"1000\" style=\"padding: 0px; margin: 0px; border: 0px; background: transparent; position: absolute; top: 0px; left: 0px; width: 800px; height: 500px;\"></canvas><canvas width=\"1600\" height=\"1000\" style=\"padding: 0px; margin: 0px; border: 0px; background: transparent; position: absolute; top: 0px; left: 0px; width: 800px; height: 500px;\"></canvas><canvas width=\"1600\" height=\"1000\" style=\"padding: 0px; margin: 0px; border: 0px; background: transparent; position: absolute; top: 0px; left: 0px; width: 800px; height: 500px;\"></canvas></div></div>\n\t    \t<div id=\"credits_content\"><table><tbody><tr><td colspan=\"2\">Created &amp; Directed by:</td>\n<td>Stephen Railton  (University of Virginia)</td>\n</tr><tr><td colspan=\"2\">Project Manager:</td>\n<td>Worthy Martin (University of Virginia)</td>\n</tr><tr><td colspan=\"2\">Lead Technologist:</td>\n<td>Robbie Bingler (University of Virginia)</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr></tr><tr><td colspan=\"2\">Associate Directors:</td>\n<td>\n<p>Johannes Burgers (Ashoka University, India)<br>Theresa M. Towner (University of Texas, Dallas)</p>\n<p>2013-2014: Dotty Dye (Arizona State University); Julie Napolin (The New School)</p>\n</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr></tr><tr><td colspan=\"2\">Advisory Editors:</td>\n<td>\n<p>John N. Duvall (Purdue University)<br>Brian McDonald (The School District of Lancaster)<br>John T. Matthews (Boston University)<br>John Padgett (Brevard College)<br>Hortense Spillers (Vanderbilt University)<br>Melanie Benson Taylor (Dartmouth College)<br>Jay Watson (University of Mississippi)</p>\n<p>2012-2014&nbsp; Thadious Davis (University of Pennsylvania); Robert W. Hamblin (Southeast Missouri State University)</p>\n</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr></tr><tr><td colspan=\"2\">Senior Collaborating Editors:</td>\n<td>\n<p>James Carothers (University of Kansas)<br>John Corrigan (National Chengchi University, Taiwan)<br>Jennie J. Joiner (Keuka College)<br>John Padgett (Brevard College)<br>Erin Penner (Asbury University)<br>Christopher Rieger (Southeast Missouri State University)<br> Ben Robbins (University of Innsbruck)<br>Lorie Watkins (William Carey University)</p>\n</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr><td colspan=\"2\">Collaborating Editors:</td>\n<td>\n<p>Scott T. Chancellor (United States Army)<br>Robert Coleman (University of South Alabama)<br>Elizabeth Cornell (Fordham University)<br>Ren Denton (East Georgia State College)<br>Dotty Dye (Arizona State University)<br>Taylor Hagood (Florida Atlantic University)<br>Kristi Humphreys (Texas Tech University)<br>Chad Jewett (University of Connecticut)<br><steven>Cheryl Lester (University of Kansas)<br>Julie Napolin (The New School)<br>Sarah Perkins (Stanford)<br>Dorette Sobolewski (University of Glasgow)<br>Bill Teem (Independent Scholar)<br>Mike Wainwright (University of London)<br>Laura Wilson (University of Mississippi)</steven></p>\n<p><steven><br>Peter Froehlich (Penn State Hazelton)<br>Peter Lurie (University of Richmond)<br>Garrett Morrison (Northwestern University)</steven></p>\n</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr><td colspan=\"2\">Collaborating Teachers:</td>\n<td>\n<p>Victoria Bryan (Cleveland State Community College)<br> Ren Denton (East Georgia State College)<br> David Finley (Chandler-Gilbert Community College)<br> Katie Hamilton (University of Nottingham)<br> Hollis Carolyn Heyn (Lindenwood University)<br> Kristi Humphreys (Texas Tech University)<br>Jennie J. Joiner (Keuka College)<br> Brian McDonald (The School District of Lancaster)<br> Willard Pate (Furman University)<br>Harriet Pollack (Bucknell University)<br>Jenna Grace Sciuto (Massachusetts College of Liberal Arts)<br>George Thomas (University of California, Davis)<br> Jeremy Wells (Indiana University Southeast)<br> Sherry Young (Lone Star Community College)</p>\n</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr><td colspan=\"2\">Cartographer|Illustrator:</td>\n<td>Rick Britton</td>\n</tr><tr><td>&nbsp;</td>\n</tr><tr><td colspan=\"3\">Collaborating Technologists (University of Virginia)</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Institute for Advanced Technology in the Humanities</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>\n<p>Worthy Martin<br>Robbie Bingler<br>Shayne Brandon<br>Sarah Wells<br>Lauren Massari<br>Doug Ross<br>Daniel Pitti</p>\n</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Data Science Institute</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Rafael Alvarado</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Digital Media Lab</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Jama Coartney<br>Will Rourk<br>Arin Bennett<br>Kristy Haney</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Scholars' Lab</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Chris Gist</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Sciences, Humanities and Arts Network of Technological Initiatives</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Bill Ferster</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>&nbsp;</td>\n</tr><tr><td></td>\n</tr><tr><td colspan=\"3\">Contributing Institutions:</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">William Faulkner Foundation Collection, Albert &amp; Shirley Small<br>Special Collections Library, University of Virginia</span>:</td>\n</tr><tr></tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Molly Schwartzburg<br>George Riser<br>Heather Riser<br>Penny White</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Digital Production Group, University of Virginia</span>:</td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Christina Deane<br>June Trainum<br>Lucy Fitzgerald<br>Tyler Gaedecke<br>Kriti Gangal<br>Kaila Grenier<br>Jason Guinto<br>Stile Kang<br>Robert Rust<br>Tatiana Sokolova</td>\n</tr><tr><td></td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Center for Faulkner Studies, Southeast Missouri State University</span></td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Christopher Rieger<br>Roxanne Dunn<br>Tyson Koenig</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Special Collections, University of Mississippi Library</span></td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>Alan Munshower</td>\n</tr><tr><td>&nbsp;</td>\n<td colspan=\"2\"><span style=\"text-decoration: underline;\">Mississippi Department of Archives and History</span></td>\n</tr><tr><td colspan=\"2\">&nbsp;</td>\n<td>David Pilcher<br>Jeff Rodgers</td>\n</tr><tr><td></td>\n</tr><tr><td colspan=\"2\">Special Thanks:</td>\n<td>\n<p>Will St. Amand (Lafayette County Historical Society)<br>Sarah Arrington (University of Virginia)<br>Ted Atkinson (Mississippi State University)<br>Jordan Buysse (University of Virginia)<br>Sarah Ingle (University of Virginia)<br>Kassandra Knoff (University of Kansas)<br>Claude Pruitt (Faulkner ListServ)<br>Cynthia Wall (University of Virginia)<br> Gerald Walton (University of Mississippi)<br>June Webb (University of Virginia)<br>Daniel Zimmerman (University of Virginia)</p>\n</td>\n</tr><tr><td colspan=\"2\">Funding:</td>\n<td>\n<p>The National Endowment for the Humanities<br>The Department of English, UVA<br>The Office of the Dean, College of Arts &amp; Sciences, UVA</p>\n</td>\n</tr></tbody></table></div>\n\t\t\t<div id=\"layers\">\n\t\t\t</div>\n\t\t\t<div id=\"reset_all\">\n\t\t\t\t<input type=\"button\" value=\"Reset\" onclick=\"reset()\">\n\t\t\t</div>\n\t\t\t<div id=\"show_all\">\n\t\t\t\t<input type=\"checkbox\" value=\"Reset\" onclick=\"reset()\"> All\n\t\t\t</div>\n\t\t\t<div id=\"section_label\">Limit by Section</div>\n\t\t\t<div>\n\t\t\t\t<div id=\"playback_controls\">\n\t\t\t\t\t \n\t\t\t\t\t<!-- <input type=\"radio\" value=\"page\" name=\"step_type\" checked>Page <input id=\"event_type\" type=\"radio\" value=\"event\" name=\"step_type\">Event -->\n\t\t\t\t\t <!-- <input type=\"button\" value=\"Reset\" onclick=\"reset()\"> -->\n\t\t\t\t\t<span id=\"coords\" style=\"display:none\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"sections\">\n\t\t\t\t</div>\n\t\t\t\t<div id=\"controls\">\n\t\t\t\t\t<div id=\"slider\"></div>\n\t\t\t\t\t<div id=\"page_play\"><input type=\"button\" value=\"Play\" onclick=\"play()\"><input type=\"button\" value=\"Stop\" onclick=\"stop_play()\"></div>\n\t\t\t\t\t<div id=\"speed_control\"><div id=\"speed\" class=\"ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\"><a class=\"ui-slider-handle ui-state-default ui-corner-all\" href=\"#\" style=\"left: 51.0204%;\"></a></div>Speed</div>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"event_controls\">\n\t\t\t\t\t<div id=\"label\"></div>\n\t\t\t\t\t<div id=\"e_slider\"></div>\n\t\t\t\t\t<div id=\"e_page_play\">\n\t\t\t\t\t\t<img alt=\"\" src=\"rewind.png\" height=\"20\" onclick=\"prev_event()\" title=\"Previous Event\"><img alt=\"\" src=\"play.png\" height=\"20\" onclick=\"play_timeline_by_events()\" title=\"Play\"><img alt=\"\" src=\"stop.png\" height=\"20\" onclick=\"stop_play()\" title=\"Stop\"><img alt=\"\" src=\"ff.png\" height=\"20\" onclick=\"next_event(true)\" title=\"Next Event\">\n\t\t\t\t\t\t<!-- <input type=\"button\" value=\"Play\" onclick=\"play_events()\"><input type=\"button\" value=\"Stop\" onclick=\"stop_play()\"><br>\n\t\t\t\t\t\t<input type=\"button\" value=\"Prev\" onclick=\"prev_event()\"><input type=\"button\" value=\"Next\" onclick=\"next_event()\"> -->\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<span id=\"page-order\">\n\t\t\t\t\t\tPage Order\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id=\"start\">1</div>\n\t\t\t\t\t\t<div id=\"stop\">1</div>\n\t\t\t\t\t<div id=\"e_speed_control\"><div id=\"e_speed\" class=\"ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\"><a class=\"ui-slider-handle ui-state-default ui-corner-all\" href=\"#\" style=\"left: 51.0204%;\"></a></div>Speed</div>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"dates\">\n\t\t\t\t</div>\n\t\t\t\t<div id=\"date_labels\">\n\t\t\t\t\t<span>1800</span>\n\t\t\t\t\t<span>1816</span>\n\t\t\t\t\t<span>1832</span>\n\t\t\t\t\t<span>1848</span>\n\t\t\t\t\t<span>1864</span>\n\t\t\t\t\t<span>1880</span>\n\t\t\t\t\t<span>1896</span>\n\t\t\t\t\t<span>1912</span>\n\t\t\t\t\t<span>1928</span>\n\t\t\t\t\t<span>1944</span>\n\t\t\t\t\t<span>1960</span>\n\t\t\t\t\t<!-- <span>1850</span>\n\t\t\t\t\t<span>1857</span>\n\t\t\t\t\t<span>1864</span>\n\t\t\t\t\t<span>1874</span>\n\t\t\t\t\t<span>1881</span>\n\t\t\t\t\t<span>1888</span>\n\t\t\t\t\t<span>1896</span>\n\t\t\t\t\t<span>1903</span>\n\t\t\t\t\t<span>1910</span>\n\t\t\t\t\t<span>1917</span>\n\t\t\t\t\t<span>1925</span> -->\n\t\t\t\t</div>\n\t\t\t\t<div id=\"chron_controls\">\n\t\t\t\t\t<div id=\"c_slider\"></div>\n\t\t\t\t\t<div id=\"c_page_play\">\n\t\t\t\t\t\t<img alt=\"\" src=\"rewind.png\" height=\"20\" onclick=\"prev_chron()\" title=\"Previous Event\"><img alt=\"\" src=\"play.png\" height=\"20\" onclick=\"play_chron()\" title=\"Play\"><img alt=\"\" src=\"stop.png\" height=\"20\" onclick=\"stop_play()\" title=\"Stop\"><img alt=\"\" src=\"ff.png\" height=\"20\" onclick=\"next_chron()\" title=\"Next Event\"><br>Chronological Order\n\t\t\t\t\t\t<!-- <input type=\"button\" value=\"Play\" onclick=\"play_chron()\"><input type=\"button\" value=\"Stop\" onclick=\"stop_play()\"><br>\n\t\t\t\t\t\t<input type=\"button\" value=\"Prev\" onclick=\"prev_chron()\"><input type=\"button\" value=\"Next\" onclick=\"next_chron()\"> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"c_speed_control\"><div id=\"c_speed\" class=\"ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\"><a class=\"ui-slider-handle ui-state-default ui-corner-all\" href=\"#\" style=\"left: 51.0204%;\"></a></div>Speed</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button id=\"upClick\">&lt;&lt;</button> <button id=\"downClick\">&gt;&gt;</button>\n\t\t\t\t\t<div id=\"shelf_instructions\">\n\t\t\t\t\t\t<div class=\"title-section center-text\">\n\t\t\t\t\t\t\t<h1>Digital Yoknapatawpha</h1>\n\t\t\t\t\t\t\t<img alt=\"Digital Yoknapatawpha Stamp\" src=\"stamp.png\">\n\t\t\t\t\t\t\t<h4>A Collaboration between an International Team of Faulkner Scholars<br>\nand Technologists at the University of Virginia<br>\nMajor Funding provided by the National Endowment in the Humanities</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"center-text\"><span class=\"note\">NOTE</span>: This is the working prototype of a project that is still very much a work in progress. <br>\nSelect a text from the shelf below to explore it \u2014 or use the tabs above for multi-text searching<br>\u2014 or view a <a href=\"http://www.people.virginia.edu/~sfr/DYDemo/2016DYDemos/DYDemoHP.html\" target=\"_blank\">demonstration video</a> on using this prototype.<br>\n</div><br>On the shelf texts are currently arranged <a href=\"#\" onclick=\"select_fewer_icons(texts_by_publish_date)\">chronologically</a>, by their date of publication between 1929 and 1962, but you can re-order them <a href=\"#\" onclick=\"select_fewer_icons(texts_alphabetical)\">alphabetically</a>, or in any of the following categories: <a href=\"#\" onclick=\"select_fewer_icons(texts_by_novels)\">novels</a>, or <a href=\"#\" onclick=\"select_fewer_icons(texts_by_collected_stories)\">Faulkner's Collected Stories</a> (arranged in the order he created), or the <a href=\"#\" onclick=\"select_fewer_icons(texts_by_uncollected_stories)\">Uncollected Stories</a> (arranged in the order Joseph Blotner created), or the <a href=\"#\" onclick=\"select_fewer_icons(texts_by_knights)\">Knight's Gambit stories</a>. <br>\n\t\t\t\t\t</div>\n\t\t\t<div id=\"dock-container\" style=\"width:800px;height:110px;position:absolute;top:600px;overflow:auto;\">\n\t\t\t<div class=\"mac-dock\" style=\"text-align: center; position: absolute; width: 2924px; left: -30px;\"><img alt=\"Flags in the Dust\" src=\"FlagsCover_icon.jpg\" id=\"#flags\" title=\"Flags in the Dust\" style=\"width: 35px;\"> <img alt=\"The Sound and the Fury\" src=\"sandfcovert.jpg\" id=\"#sound\" title=\"The Sound and the Fury\" style=\"width: 35px;\"> <img alt=\"A Rose for Emily\" src=\"RE_novel.jpg\" id=\"#rose\" title=\"A Rose for Emily\" style=\"width: 35px;\"> <img alt=\"As I Lay Dying\" src=\"aildcover.jpg\" id=\"#aild\" title=\"As I Lay Dying\" style=\"width: 35px;\"> <img alt=\"Red Leaves\" src=\"RedLeaves_icon.jpg\" id=\"#redleaves\" title=\"Red Leaves\" style=\"width: 35px;\"> <img alt=\"Dry September\" src=\"DS_novel.jpg\" id=\"#dryseptember\" title=\"Dry September\" style=\"width: 35px;\"> <img alt=\"Sanctuary\" src=\"santcover.jpg\" id=\"#sanctuary\" title=\"Sanctuary\" style=\"width: 35px;\"> <img alt=\"That Evening Sun\" src=\"ThatEveningSun_icon.jpg\" id=\"#eveningsun\" title=\"That Evening Sun\" style=\"width: 35px;\"> <img alt=\"Ad Astra\" src=\"AdAstra.jpg\" id=\"#adastra\" title=\"Ad Astra\" style=\"width: 35px;\"> <img alt=\"Hair\" src=\"Hair.jpg\" id=\"#hair\" title=\"Hair\" style=\"width: 35px;\"> <img alt=\"Spotted Horses\" src=\"spottedhorses.jpg\" id=\"#spottedhorses\" title=\"Spotted Horses\" style=\"width: 35px;\"> <img alt=\"The Hound\" src=\"TheHound.jpg\" id=\"#hound\" title=\"The Hound\" style=\"width: 35px;\"> <img alt=\"All The Dead Pilots\" src=\"AllTheDeadPilots.jpg\" id=\"#dead_pilots\" title=\"All The Dead Pilots\" style=\"width: 35px;\"> <img alt=\"A Justice\" src=\"AJustice.jpg\" id=\"#ajustice\" title=\"A Justice\" style=\"width: 35px;\"> <img alt=\"Death Drag\" src=\"DeathDrag.jpg\" id=\"#deathdrag\" title=\"Death Drag\" style=\"width: 35px;\"> <img alt=\"Centaur In Brass\" src=\"CentaurInBrass.jpg\" id=\"#centaur\" title=\"Centaur In Brass\" style=\"width: 35px;\"> <img alt=\"Lizards in Jamshyd\u2019s Courtyard\" src=\"Lizards.jpg\" id=\"#lizards\" title=\"Lizards in Jamshyd\u2019s Courtyard\" style=\"width: 35px;\"> <img alt=\"Smoke\" src=\"Smoke.jpg\" id=\"#smoke\" title=\"Smoke\" style=\"width: 35px;\"> <img alt=\"MissZilphiaGant\" src=\"MissZilphiaGant.jpg\" id=\"#zilphia\" title=\"MissZilphiaGant\" style=\"width: 35px;\"> <img alt=\"Light In August\" src=\"lightcovert.jpg\" id=\"#light\" title=\"Light In August\" style=\"width: 35px;\"> <img alt=\"There Was A Queen\" src=\"ThereWasAQueen.jpg\" id=\"#therewasaqueen\" title=\"There Was A Queen\" style=\"width: 35px;\"> <img alt=\"Beyond\" src=\"Beyond.jpg\" id=\"#beyond\" title=\"Beyond\" style=\"width: 35px;\"> <img alt=\"Wash\" src=\"Wash_icon.jpg\" id=\"#wash\" title=\"Wash\" style=\"width: 35px;\"> <img alt=\"Elly\" src=\"Elly.jpg\" id=\"#elly\" title=\"Elly\" style=\"width: 35px;\"> <img alt=\"A Bear Hunt\" src=\"ABearHunt.jpg\" id=\"#abearhunt\" title=\"A Bear Hunt\" style=\"width: 35px;\"> <img alt=\"Mule In The Yard\" src=\"MuleInYard.jpg\" id=\"#mule\" title=\"Mule In The Yard\" style=\"width: 35px;\"> <img alt=\"Ambuscade\" src=\"Ambuscade_icon.jpg\" id=\"#ambuscade\" title=\"Ambuscade\" style=\"width: 35px;\"> <img alt=\"Retreat\" src=\"Retreat.jpg\" id=\"#retreat\" title=\"Retreat\" style=\"width: 35px;\"> <img alt=\"Raid\" src=\"Raid.jpg\" id=\"#raid\" title=\"Raid\" style=\"width: 35px;\"> <img alt=\"Skirmish At Sartoris\" src=\"SkirmishAtSartoris.jpg\" id=\"#sas\" title=\"Skirmish At Sartoris\" style=\"width: 35px;\"> <img alt=\"That Will Be Fine\" src=\"ThatWillBeFine.jpg\" id=\"#fine\" title=\"That Will Be Fine\" style=\"width: 35px;\"> <img alt=\"Uncle Willy\" src=\"UncleWilly.jpg\" id=\"#willy\" title=\"Uncle Willy\" style=\"width: 35px;\"> <img alt=\"Lion\" src=\"Lion.jpg\" id=\"#lion\" title=\"Lion\" style=\"width: 35px;\"> <img alt=\"Fool About Horse\" src=\"FoolAboutHorse.jpg\" id=\"#fool\" title=\"Fool About Horse\" style=\"width: 35px;\"> <img alt=\"Absalom, Absalom!\" src=\"aacover.jpg\" id=\"#absalomabsalom\" title=\"Absalom, Absalom!\" style=\"width: 35px;\"> <img alt=\"The Unvanquished\" src=\"UnvanquishedSS.jpg\" id=\"#unvanquished\" title=\"The Unvanquished\" style=\"width: 35px;\"> <img alt=\"Vendee\" src=\"Vendee.jpg\" id=\"#vendee\" title=\"Vendee\" style=\"width: 35px;\"> <img alt=\"Monk\" src=\"Monk.jpg\" id=\"#monk\" title=\"Monk\" style=\"width: 35px;\"> <img alt=\"The Unvanquished\" src=\"UnvanqCover.jpg\" id=\"#unvanqnovel\" title=\"The Unvanquished\" style=\"width: 35px;\"> <img alt=\"Barn Burning\" src=\"BB_novel.jpg\" id=\"#barnburning\" title=\"Barn Burning\" style=\"width: 35px;\"> <img alt=\"Hand Upon The Waters\" src=\"HandUponTheWaters.jpg\" id=\"#hand\" title=\"Hand Upon The Waters\" style=\"width: 35px;\"> <img alt=\"Hamlet\" src=\"HamletCover.jpg\" id=\"#hamlet\" title=\"Hamlet\" style=\"width: 35px;\"> <img alt=\"A Point Of Law\" src=\"APointOfLaw.jpg\" id=\"#point\" title=\"A Point Of Law\" style=\"width: 35px;\"> <img alt=\"The Old People\" src=\"TheOldPeople.jpg\" id=\"#old\" title=\"The Old People\" style=\"width: 35px;\"> <img alt=\"Pantaloon in Black\" src=\"Pantaloon_icon.jpg\" id=\"#pantaloon\" title=\"Pantaloon in Black\" style=\"width: 35px;\"> <img alt=\"Gold Is Not Always\" src=\"GoldIsNotAlways.jpg\" id=\"#goldnotalways\" title=\"Gold Is Not Always\" style=\"width: 35px;\"> <img alt=\"Tomorrow\" src=\"Tomorrow_icon.jpg\" id=\"#tomorrow\" title=\"Tomorrow\" style=\"width: 35px;\"> <img alt=\"Go Down, Moses\" src=\"GoDownMoses.jpg\" id=\"#god\" title=\"Go Down, Moses\" style=\"width: 35px;\"> <img alt=\"The Tall Men\" src=\"TheTallMen.jpg\" id=\"#tallmen\" title=\"The Tall Men\" style=\"width: 35px;\"> <img alt=\"Two Soldiers\" src=\"TwoSoldiersIcon.jpg\" id=\"#soldier\" title=\"Two Soldiers\" style=\"width: 35px;\"> <img alt=\"Delta Autumn\" src=\"DeltaAutumn.jpg\" id=\"#delta_autumn\" title=\"Delta Autumn\" style=\"width: 35px;\"> <img alt=\"The Bear\" src=\"TheBear.jpg\" id=\"#bear\" title=\"The Bear\" style=\"width: 35px;\"> <img alt=\"Go Down, Moses\" src=\"GoDownMosesNovelCover.jpg\" id=\"#moses_novel\" title=\"Go Down, Moses\" style=\"width: 35px;\"> <img alt=\"Shingles for the Lord\" src=\"Shingles_icon.jpg\" id=\"#shingles\" title=\"Shingles for the Lord\" style=\"width: 35px;\"> <img alt=\"My Grandmother Millard\" src=\"MyGrandmotherMillard.jpg\" id=\"#grandmother\" title=\"My Grandmother Millard\" style=\"width: 35px;\"> <img alt=\"Shall Not Perish\" src=\"ShallNotPerish.jpg\" id=\"#snp\" title=\"Shall Not Perish\" style=\"width: 35px;\"> <img alt=\"Appendix: Compson\" src=\"AppendixCompson.jpg\" id=\"#AppendixCompson\" title=\"Appendix: Compson\" style=\"width: 35px;\"> <img alt=\"An Error In Chemistry\" src=\"AnErrorInChemistry.jpg\" id=\"#error\" title=\"An Error In Chemistry\" style=\"width: 35px;\"> <img alt=\"Intruder In The Dust\" src=\"IntruderIcon.jpg\" id=\"#intruder\" title=\"Intruder In The Dust\" style=\"width: 35px;\"> <img alt=\"A Courtship\" src=\"ACourtship.jpg\" id=\"#courtship\" title=\"A Courtship\" style=\"width: 35px;\"> <img alt=\"Knight\u2019s Gambit\" src=\"Gambit-cover-icon.jpg\" id=\"#gambit\" title=\"Knight\u2019s Gambit\" style=\"width: 35px;\"> <img alt=\"A Name for the City\" src=\"NameForCity.jpg\" id=\"#name_city\" title=\"A Name for the City\" style=\"width: 35px;\"> <img alt=\"Requiem for a Nun\" src=\"Requiem-cover-icon.jpg\" id=\"#requiem\" title=\"Requiem for a Nun\" style=\"width: 35px;\"> <img alt=\"Race At Morning\" src=\"RaceAtMorning.jpg\" id=\"#race\" title=\"Race At Morning\" style=\"width: 35px;\"> <img alt=\"ByThe People\" src=\"ByThePeople.jpg\" id=\"#bythepeople\" title=\"ByThe People\" style=\"width: 35px;\"> <img alt=\"The Town\" src=\"Town.jpg\" id=\"#town\" title=\"The Town\" style=\"width: 35px;\"> <img alt=\"The Mansion\" src=\"Mansion.jpg\" id=\"#mansion\" title=\"The Mansion\" style=\"width: 35px;\"> <img alt=\"Reivers\" src=\"ReiversCover.jpg\" id=\"#reivers\" title=\"Reivers\" style=\"width: 35px;\"> </div>\n  </div>\n\t\t</div>\n\t\t<div id=\"layer_dialog\">\n\t\t\t<div class=\"control-buttons\"><button id=\"plus\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only\" role=\"button\" aria-disabled=\"false\" title=\"+\"><span class=\"ui-button-icon-primary ui-icon ui-icon-plus\"></span><span class=\"ui-button-text\">+</span></button><button id=\"minus\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only\" role=\"button\" aria-disabled=\"false\" title=\"-\"><span class=\"ui-button-icon-primary ui-icon ui-icon-minus\"></span><span class=\"ui-button-text\">-</span></button><button id=\"reset\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\" role=\"button\" aria-disabled=\"false\"><span class=\"ui-button-text\">Reset</span></button></div>\n\t\t\t<strong>Show Locations:</strong><br>\n\t\t\t<input type=\"checkbox\" id=\"natural\" checked=\"\">Natural<br>\n\t\t\t<input type=\"checkbox\" id=\"manmade\" checked=\"\">Man-made<br>\n\t\t\t<input type=\"radio\" name=\"locations\" id=\"locations\" checked=\"\">All Locations<br>\n\t\t\t<input type=\"radio\" name=\"locations\" id=\"event-locations\">Event Locations<br>\n\t\t\t<div id=\"search-locations-selection\"></div>\n\t\t\t<input type=\"radio\" name=\"locations\" id=\"no-locations\">None<br>\n\t\t\t<input type=\"checkbox\" id=\"show_location_list\">Alphabetic List<br>\n\t\t\t<strong>Show Characters:</strong><br>\n\t\t\t<input type=\"radio\" id=\"characters-all\" name=\"characters\" onclick=\"show_characters();contentLayer.draw();\">All<br>\n\t\t\t<input type=\"radio\" id=\"characters-major\" name=\"characters\" onclick=\"show_characters();contentLayer.draw();\">Major<br>\n\t\t\t<input type=\"radio\" id=\"characters-major-regular\" name=\"characters\" onclick=\"show_characters();contentLayer.draw();\">Major &amp; Secondary<br>\n\t\t\t<input type=\"radio\" id=\"characters-home\" name=\"characters\" onclick=\"show_characters_home();contentLayer.draw();\" checked=\"\">Home<br>\n\t\t\t<div id=\"results-checkbox\"></div>\n\t\t\t<input type=\"radio\" id=\"characters-none\" name=\"characters\" onclick=\"show_characters();contentLayer.draw();\" checked=\"\">None<br>\n\t\t\t<input type=\"checkbox\" id=\"show_character_list\">Alphabetic List<br>\n\t\t\t<strong>Show Events:</strong><br>\n\t\t\t<!-- <input type=\"checkbox\" id=\"play_events\" checked>During Play<br> -->\n\t\t\t<input type=\"checkbox\" id=\"events\">All<br>\n\t\t\t<input type=\"checkbox\" id=\"heatmap_toggle\">Heatmap<br>\n\t\t</div>\n\t\t<div id=\"character_list\">\n\t\t\t<div id=\"character_list_content\"></div>\n\t\t\t<div style=\"text-align:center\"><input type=\"button\" onclick=\"show_specific_characters()\" value=\"Show\"><input type=\"button\" onclick=\"reset_character_selection()\" value=\"Reset\"></div>\n\t\t</div>\n\t\t<div id=\"location_list\">\n\t\t\t<div id=\"location_list_content\"></div>\n\t\t\t<div style=\"text-align:center\"><input type=\"button\" onclick=\"show_specific_locations()\" value=\"Show\"><input type=\"button\" onclick=\"reset_location_selection()\" value=\"Reset\"></div>\n\t\t</div>\n\t\t<div id=\"title\"></div>\n\t\t<div id=\"event_dialog\" title=\"Event Information\"></div>\n\t\t<div id=\"about_text\"><div id=\"about_text_content\"></div></div>\n\t\t<!-- <div style=\"position:absolute;bottom:10px;right:10px\"><a href=\"#\" onclick=\"show_book('ZKR')\">z</a></div> -->\n\t\t<div id=\"heat-info\">\n\t\t\t<table id=\"heat-info-table\"></table>\n\t\t</div>\n\t\t<script type=\"text/javascript\">\n\t\t            function saveImage() {\n\t\t                var ua = window.navigator.userAgent;\n \n\t\t                if (ua.indexOf(\"Chrome\") > 0) {\n\t\t                    // save image without file type\n\t\t                    var canvas = $('.heatmap-canvas')[0];\n\t\t\t\t\t\t\t// canvas.width = 2640;\n\t\t\t\t\t\t\t// canvas.height = 1650;\n\t\t                    document.location.href = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n \n\t\t                    // save image as png\n\t\t                    var link = document.createElement('a');\n\t\t                    link.download = \"heatmap.png\";\n\t\t                    link.href = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");;\n\t\t                    link.click();\n\t\t\t\t\t\t\treturn false;\n\t\t                }\n\t\t                else {\n\t\t                    alert(\"Please use Chrome\");\n\t\t                }\n\t\t            }\n\t\t\t\t\t\n\t\t\t\t\tfunction show_event(nid, location, people_present, people_mentioned) {\n\t\t\t\t\t\tvar str = \"<div id=\\\"etabs\\\"><ul><li><a href=\\\"#etabs-2\\\">Event</a></li><li><a href=\\\"#etabs-1\\\">Location</a></li><li><a href=\\\"#etabs-3\\\">Characters</a></li></ul><div id=\\\"etabs-2\\\" class=\\\"dialog_content\\\"></div><div id=\\\"etabs-1\\\" class=\\\"dialog_content\\\" ></div><div id=\\\"etabs-3\\\" class=\\\"dialog_content\\\"><strong>Present:</strong><div id='event_present'></div><strong>Mentioned:</strong><div id='event_mentioned'></div></div></div>\";\n\t\t\t\t\t\t// alert(value[\"Location\"]);\n\t\t\t\t\t\t$( \"#event_dialog\" ).html( str); //\"<strong>\"+value[\"LocationTitle\"]+\"</strong><br>\"+value[\"Description\"] );\n\t\t\t\t\t\tvar pos=start;\n\t\t\t\t\t\tvar e = new Array();\n\t\t\t\t\t\tvar c = new Array();\n\t\t\t\t\t\tvar mc = new Array();\n\t\t\t\t\t\t$('#etabs-1').html('<strong>'+location+'</strong>');\n\t\t\t\t\t\t// while (pos <= stop) {\n\t\t\t\t\t// \t\t$( \"#tabs-1\" ).html(\"<strong>\"+location_labels[value[\"event_location\"]]+\"</strong><br>\"+location_descriptions[value['event_location']] );\n\t\t\t\t\t// \t\tvar data = page_locations[pos][value[\"event_location\"]][\"events\"];\n\t\t\t\t\t// \t\t$.each(data, function(i,v) {\n\t\t\t\t\t// \t\t\te.push(v);\n\t\t\t\t\t// \t\t})\n\t\t\t\t\t// \t\tdata = page_locations[pos][value[\"event_location\"]][\"characters_present\"];\n\t\t\t\t\t// \t\t$.each(data, function(i,v) {\n\t\t\t\t\t// \t\t\tc.push(v);\n\t\t\t\t\t// \t\t})\n\t\t\t\t\t// \t\tdata = page_locations[pos][value[\"event_location\"]][\"characters_mentioned\"];\n\t\t\t\t\t// \t\t$.each(data, function(i,v) {\n\t\t\t\t\t// \t\t\tmc.push(v);\n\t\t\t\t\t// \t\t})\n\t\t\t\t\t// \t\tpos += 1;\n\t\t\t\t\t// \t}\n\t\t\t\t\t\t// e = array_unique(e);\n\t\t\t\t\t\t// c = array_unique(c);\n\t\t\t\t\t\tmc = array_unique(mc);\n\t\t\t\t\t\tgetEventsByNid([nid], '#etabs-2');\n\t\t\t\t\t\tgetCharactersByNid(people_present, '#event_present');\n\t\t\t\t\t\tgetCharactersByNid(people_mentioned, '#event_mentioned');\n\t\t\t\t\t\t\n\t\t\t\t\t\t// $.each(e.sort(), function(index, value) {\n\t\t\t\t\t\t// \t$('#tabs-2').append(value);\n\t\t\t\t\t\t// })\n\t\t\t\t\t\t// $.each(c.sort(), function(index, value) {\n\t\t\t\t\t\t// \t$('#tabs-3').append(value+\"<br>\");\n\t\t\t\t\t\t// })\n\t\t\t\t\t\t$(\"#etabs\").tabs();\n\t\t\t\t\t\t// if($(this).css('opacity') == \"1\") {\n\t\t\t\t\t\t\t$('#event_dialog').dialog({width:350,});\n\t\t\t\t\t\t\t$('#event_dialog').dialog('open');\n\t\t\t\t\t\t// }\n\t\t\t\t\t}\n\t\t        </script>\n  \n\n</body></html>"