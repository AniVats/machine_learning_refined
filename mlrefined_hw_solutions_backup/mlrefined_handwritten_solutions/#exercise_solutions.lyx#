#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass book
\begin_preamble
%\usepackage{xcolor}
\usepackage{sectsty}
\renewcommand{\floatpagefraction}{.8}%

%\definecolor{magenta}{rgb}{0.9,0,.3}
%\definecolor{fig}{rgb}{0.9,0,.3}
%\definecolor{chap}{rgb}{0,0.3,.5}
%\definecolor{sect}{rgb}{0,0.5,.7}

%\chapterfont{\color{cyan}}  % sets colour of chapters
%\sectionfont{\color{sect}}  % sets colour of sections
%\subsectionfont{\color{cyan}} % 

\usepackage{caption}
\DeclareCaptionFont{myblue}{\color{black}}
\captionsetup{labelfont={myblue,bf},labelsep=period}


\usepackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{  \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
\end_preamble
\use_default_options true
\master ../Full doc.lyx
\begin_modules
theorems-bytype
theorems-chap-bytype
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "palatino" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family rmdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement !tph
\paperfontsize 12
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 0
\boxbgcolor #d8d8d8
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1.5in
\headheight 1in
\headsep 0.5in
\footskip 1in
\columnsep 0.5cm
\secnumdepth 3
\tocdepth 1
\paragraph_separation skip
\defskip smallskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter*
Exercise solutions 
\end_layout

\begin_layout Standard

\series bold
\size larger
\color black
Chapter 2.
 Fundamentals of numerical optimization 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.1 
\end_layout

\begin_layout Standard
a) Using derivative formula and the fact that the derivative of a sum is
 the sum of derivatives we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime}\left(w\right)=qw+r,\label{eq:scalar-quad-grad}
\end{equation}

\end_inset

and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime\prime}\left(w\right)=q.\label{eq:scalar-quad-hess}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Using the chain rule on the 
\begin_inset Formula $\mbox{cos}\left(\cdot\right)$
\end_inset

 part, the fact that the derivative of a sum is the sum of derivatives,
 and derivative formulae we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime}\left(w\right)=\mbox{sin}\left(2\pi w^{2}\right)4\pi w+2w.\label{eq:scalar-sin-first-derivative}
\end{equation}

\end_inset

Likewise taking the second derivative we differentiate the above (additionally
 using the product rules) as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime\prime}\left(w\right)=\mbox{cos}\left(2\pi w^{2}\right)\left(4\pi w\right)^{2}+\mbox{sin}\left(2\pi w^{2}\right)4\pi+2.\label{eq:scalar-sin-second-derivative}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Call the 
\begin_inset Formula $p^{th}$
\end_inset

 summand 
\begin_inset Formula $h_{p}\left(w\right)=\mbox{log}\left(1+e^{-a_{p}w}\right)$
\end_inset

.
 Then using the chain rule since 
\begin_inset Formula $\frac{d}{dt}\mbox{log}\left(t\right)=\frac{1}{t}$
\end_inset

 and 
\begin_inset Formula $\frac{d}{dw}\left(1+e^{-a_{p}w}\right)=-a_{p}e^{-a_{p}w}$
\end_inset

 together we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{d}{dw}h_{p}\left(w\right)=\frac{1}{1+e^{-a_{p}w}}\left(-a_{p}e^{-a_{p}w}\right)=-\frac{a_{p}e^{-a_{p}w}}{1+e^{-a_{p}w}}=-\frac{a_{p}}{e^{a_{p}w}+e^{a_{p}w}e^{-a_{p}w}}=-\frac{a_{p}}{1+e^{a_{p}w}}.\label{eq:scalar-log-first-derivative-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now using this result, and since the derivative of a sum is the sum of the
 derivatives and 
\begin_inset Formula $g\left(w\right)=\underset{p=1}{\overset{P}{\sum}}h_{p}\left(w\right)$
\end_inset

, we have 
\begin_inset Formula $\frac{d}{dw}g\left(w\right)=\underset{p=1}{\overset{P}{\sum}}\frac{d}{dw}h_{p}\left(w\right)$
\end_inset

 and so
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime}\left(w\right)=-\underset{p=1}{\overset{P}{\sum}}\frac{a_{p}}{1+e^{a_{p}w}}.\label{eq:scalar-log-first-derivative}
\end{equation}

\end_inset

To compute the second derivative let us again do so by first differentiating
 the above summand-by-summand.
 Denote the 
\begin_inset Formula $p^{th}$
\end_inset

 summand above as 
\begin_inset Formula $h_{p}\left(w\right)=\frac{a_{p}}{1+e^{a_{p}w}}$
\end_inset

.
 To compute its derivative we must apply the product and chain rules once
 again, we have 
\begin_inset Formula $h_{p}^{\prime}\left(w\right)=-\frac{a_{p}}{\left(1+e^{a_{p}w}\right)^{2}}a_{p}e^{a_{p}w}=-\frac{e^{a_{p}w}}{\left(1+e^{a_{p}w}\right)^{2}}a_{p}^{2}$
\end_inset

.
 We can then compute the full second derivative as 
\begin_inset Formula $g^{\prime\prime}\left(w\right)=-\underset{p=1}{\overset{P}{\sum}}h_{p}^{\prime}\left(w\right)$
\end_inset

 or likewise
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g^{\prime\prime}\left(w\right)=\underset{p=1}{\overset{P}{\sum}}\frac{e^{a_{p}w}}{\left(1+e^{a_{p}w}\right)^{2}}a_{p}^{2}.\label{eq:scalar-log-second-derivative}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.2 
\end_layout

\begin_layout Standard
a) Writing out 
\begin_inset Formula $g$
\end_inset

 in terms of the individual entries of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 we have 
\begin_inset Formula $g\left(\mathbf{w}\right)=\frac{1}{2}\underset{n=1}{\overset{N}{\sum}}\underset{m=1}{\overset{N}{\sum}}w_{n}Q_{nm}w_{m}+\underset{n=1}{\overset{N}{\sum}}r_{n}w_{n}+d$
\end_inset

 then taking the 
\begin_inset Formula $j^{th}$
\end_inset

 partial derivative we have, since the derivative of a sum is the sum of
 derivatives 
\begin_inset Formula $\frac{\partial}{\partial w_{j}}g\left(\mathbf{w}\right)=\frac{1}{2}\underset{n=1}{\overset{N}{\sum}}\underset{m=1}{\overset{N}{\sum}}\frac{\partial}{\partial w_{j}}\left(w_{n}Q_{nm}w_{m}\right)+\underset{n=1}{\overset{N}{\sum}}\frac{\partial}{\partial w_{j}}\left(r_{n}w_{n}\right)$
\end_inset

 where the 
\begin_inset Formula $d$
\end_inset

 vanishes since it is a constant and 
\begin_inset Formula $\frac{\partial}{\partial w_{j}}d=0$
\end_inset

.
 Now evaluating each derivative we apply the product rule to each 
\begin_inset Formula $w_{n}Q_{nm}w_{m}$
\end_inset

 (and remembering that all other terms in 
\begin_inset Formula $w_{k}$
\end_inset

 where 
\begin_inset Formula $k\neq j$
\end_inset

 are constant and thus vanish when taking the 
\begin_inset Formula $w_{j}$
\end_inset

 partial derivative) we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}g\left(\mathbf{w}\right)=\frac{1}{2}\left(\underset{n=1}{\overset{N}{\sum}}w_{n}Q_{nj}+\underset{m=1}{\overset{N}{\sum}}Q_{jm}w_{m}\right)+r_{j}.\label{eq:quadratic-partial-derivative}
\end{equation}

\end_inset

All together the gradient can then be written compactly as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\mathbf{w}\right)=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}^{T}\right)\mathbf{w}+\mathbf{r},
\end{equation}

\end_inset

and because 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is symmetric this is equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\mathbf{w}\right)=\mathbf{Q}\mathbf{w}+\mathbf{r}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To compute the Hessian we compute mixed partial derivatives of the form
 
\begin_inset Formula $\frac{\partial^{2}}{\partial w_{i}\partial w_{j}}g\left(\mathbf{w}\right)$
\end_inset

.
 To do this efficiently we can take the partial 
\begin_inset Formula $\frac{\partial}{\partial w_{i}}$
\end_inset

 of equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic-partial-derivative"

\end_inset

) since 
\begin_inset Formula $\frac{\partial^{2}}{\partial w_{i}\partial w_{j}}g\left(\mathbf{w}\right)=\frac{\partial}{\partial w_{i}}\left(\frac{\partial}{\partial w_{j}}g\left(\mathbf{w}\right)\right)$
\end_inset

which gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}}{\partial w_{i}\partial w_{j}}g\left(\mathbf{w}\right)=\frac{1}{2}\left(Q_{ij}+Q_{ji}\right).
\end{equation}

\end_inset

All together we then have that the full Hessian matrix is
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{w}\right)=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}^{T}\right),
\end{equation}

\end_inset

and because 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is symmetric this is equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{w}\right)=\mathbf{Q}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Writing out 
\begin_inset Formula $g$
\end_inset

 in terms of individual entries of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 we have 
\begin_inset Formula $g\left(\mathbf{w}\right)=-\mbox{cos}\left(2\pi\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}\right)+\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}$
\end_inset

, now taking the 
\begin_inset Formula $j^{th}$
\end_inset

 partial we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}g\left(\mathbf{w}\right)=\mbox{sin}\left(2\pi\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}\right)4\pi w_{j}+2w_{j}.\label{eq:sin-function-first-partial}
\end{equation}

\end_inset

From this we can see that the full gradient then takes the form 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\mathbf{w}\right)=\mbox{sin}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)4\pi\mathbf{w}+2\mathbf{w}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To compute the second derivatives we can take the partial 
\begin_inset Formula $\frac{\partial}{\partial w_{i}}$
\end_inset

 of equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sin-function-first-partial"

\end_inset

) which gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}}{\partial w_{i}\partial w_{j}}g\left(\mathbf{w}\right)=\begin{cases}
\mbox{cos}\left(2\pi\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}\right)\left(4\pi\right)^{2}w_{i}w_{j}+\mbox{sin}\left(2\pi\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}\right)4\pi+2 & \,\,\,\mbox{if \ensuremath{i=j}}\\
\mbox{cos}\left(2\pi\underset{n=1}{\overset{N}{\sum}}w_{n}^{2}\right)\left(4\pi\right)^{2}w_{i}w_{j} & \,\,\mbox{else}.
\end{cases}
\end{equation}

\end_inset

All together then denoting 
\begin_inset Formula $\mathbf{I}_{N\times N}$
\end_inset

 the 
\begin_inset Formula $N\times N$
\end_inset

 identity matrix we may write the Hessian as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{w}\right)=\mbox{cos}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)\left(4\pi\right)^{2}\mathbf{w}\mathbf{w}^{T}+\left(2+\mbox{sin}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)4\pi\right)\mathbf{I}_{N\times N}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Denote by 
\begin_inset Formula $h_{p}\left(\mathbf{w}\right)=\mbox{log}\left(1+e^{-\mathbf{a}_{p}^{T}\mathbf{w}}\right)=\mbox{log}\left(1+e^{-\underset{n=1}{\overset{N}{\sum}}a_{pn}w_{n}}\right)$
\end_inset

 one of the summands of 
\begin_inset Formula $g$
\end_inset

.
 Then using the chain rule twice the 
\begin_inset Formula $j^{th}$
\end_inset

 partial can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}h_{p}\left(\mathbf{w}\right)=\frac{1}{1+e^{-\mathbf{a}_{p}^{T}\mathbf{w}}}e^{-\mathbf{a}_{p}^{T}\mathbf{w}}\left(-a_{pj}\right).
\end{equation}

\end_inset

Since 
\begin_inset Formula $\frac{1}{1+e^{-\mathbf{a}_{p}^{T}\mathbf{w}}}e^{-\mathbf{a}_{p}^{T}\mathbf{w}}=\frac{1}{e^{\mathbf{a}_{p}^{T}\mathbf{w}}+e^{\mathbf{a}_{p}^{T}\mathbf{w}}e^{-\mathbf{a}_{p}^{T}\mathbf{w}}}=\frac{1}{1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}}$
\end_inset

 we can rewrite the above more compactly as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}h_{p}\left(\mathbf{w}\right)=-\frac{a_{pj}}{1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}},
\end{equation}

\end_inset

and summing over 
\begin_inset Formula $p$
\end_inset

 gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}g\left(\mathbf{w}\right)=-\underset{p=1}{\overset{P}{\sum}}\frac{a_{pj}}{1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}}.\label{eq:vector-log-partials}
\end{equation}

\end_inset

The full gradient of 
\begin_inset Formula $g$
\end_inset

 is then given by
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\mathbf{w}\right)=-\underset{p=1}{\overset{P}{\sum}}\frac{\mathbf{a}_{p}}{1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Computing the second partial derivatives from equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:vector-log-partials"

\end_inset

) we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}}{\partial w_{i}\partial w_{j}}g\left(\mathbf{w}\right)=\underset{p=1}{\overset{P}{\sum}}\frac{e^{\mathbf{a}_{p}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}\right)^{2}}a_{pi}a_{pj},
\end{equation}

\end_inset

and so we may write the full Hessian compactly as 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{w}\right)=\underset{p=1}{\overset{P}{\sum}}\frac{e^{\mathbf{a}_{p}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{a}_{p}^{T}\mathbf{w}}\right)^{2}}\mathbf{a}_{p}^{\,}\mathbf{a}_{p}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.3
\end_layout

\begin_layout Standard
We verify 
\begin_inset Formula $\mathbf{X}\mathbf{Y}^{T}=\underset{p=1}{\overset{P}{\sum}}\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}$
\end_inset

 by showing that the 
\begin_inset Formula $\left(i,j\right)$
\end_inset

 th entry of 
\begin_inset Formula $\mathbf{X}\mathbf{Y}^{T}$
\end_inset

 and 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}$
\end_inset

 are indeed identical.
 First note that the 
\begin_inset Formula $\left(i,j\right)$
\end_inset

 th entry of 
\begin_inset Formula $\mathbf{X}\mathbf{Y}^{T}$
\end_inset

 can be written as the inner product of the 
\begin_inset Formula $i$
\end_inset

 th row of 
\begin_inset Formula $\mathbf{X}$
\end_inset

 and the 
\begin_inset Formula $j$
\end_inset

 th column of 
\begin_inset Formula $\mathbf{Y}^{T}$
\end_inset

, or equivalently the 
\begin_inset Formula $j$
\end_inset

 th row of 
\begin_inset Formula $\mathbf{Y}$
\end_inset

.
 Therefore we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{X}\mathbf{Y}^{T}\right)_{i,j}=\underset{p=1}{\overset{P}{\sum}}x_{i,p}^{\,}y_{j,p}.\label{eq:entrywise}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now note that the 
\begin_inset Formula $\left(i,j\right)$
\end_inset

 th entry of 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}$
\end_inset

 is simply the sum of the the 
\begin_inset Formula $\left(i,j\right)$
\end_inset

 th entries of each summand 
\begin_inset Formula $\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\underset{p=1}{\overset{P}{\sum}}\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}\right)_{i,j}=\underset{p=1}{\overset{P}{\sum}}\left(\mathbf{x}_{p}^{\,}\mathbf{y}_{p}^{T}\right)_{i,j}.\label{eq:entrywise-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since the 
\begin_inset Formula $i$
\end_inset

 th row of 
\begin_inset Formula $\mathbf{x}_{p}^{\,}$
\end_inset

 and the 
\begin_inset Formula $j$
\end_inset

 th column of 
\begin_inset Formula $\mathbf{y}_{p}^{T\,}$
\end_inset

 each consists of only one entry (
\begin_inset Formula $x_{i,p}^{\,}$
\end_inset

 and 
\begin_inset Formula $y_{j,p}^{\,}$
\end_inset

 respectively), the right hand side of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:entrywise-1"

\end_inset

) can be written as 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}x_{i,p}^{\,}y_{j,p}$
\end_inset

, which is identical to the expression in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:entrywise"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.4 
\end_layout

\begin_layout Standard
a) The first and second order derivatives of 
\begin_inset Formula $g$
\end_inset

 can be easily calculated as 
\begin_inset Formula $g'(w)=\frac{2we^{w^{2}}}{1+e^{w^{2}}}$
\end_inset

 and 
\begin_inset Formula $g''(w)=\frac{2e^{w^{2}}\left(1+2w^{2}+e^{w^{2}}\right)}{\left(1+e^{w^{2}}\right)^{2}}$
\end_inset

, respectively.
 The first order Taylor series approximation to 
\begin_inset Formula $g$
\end_inset

 (around the point 
\begin_inset Formula $v$
\end_inset

) is then given as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
h\left(w\right)=g\left(v\right)+g'(v)\left(w-v\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\textrm{log}(1+e^{v^{2}})+\frac{2ve^{v^{2}}}{1+e^{v^{2}}}(w-v).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The second order Taylor series approximation to 
\begin_inset Formula $g$
\end_inset

 (around the point 
\begin_inset Formula $v$
\end_inset

) is calculated as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
h\left(w\right)=g\left(v\right)+g'(v)\left(w-v\right)+\frac{1}{2}g''(v)(w-v)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\textrm{log}(1+e^{v^{2}})+\frac{2ve^{v^{2}}}{1+e^{v^{2}}}(w-v)+\frac{e^{v^{2}}\left(1+2v^{2}+e^{v^{2}}\right)}{\left(1+e^{v^{2}}\right)^{2}}(w-v)^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Assuming the matrix 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is symmetric, the gradient and Hessian of 
\begin_inset Formula $g$
\end_inset

 can be found as 
\begin_inset Formula $\nabla g(\mathbf{w})=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}^{T}\right)\mathbf{w}+\mathbf{r}=\mathbf{Q}\mathbf{w}+\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\nabla^{2}g(\mathbf{w})=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}^{T}\right)=\mathbf{Q}$
\end_inset

, respectively.
 The first order Taylor series approximation to 
\begin_inset Formula $g$
\end_inset

 (around the point 
\begin_inset Formula $\mathbf{v}$
\end_inset

) is then given as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
h\left(\mathbf{w}\right)=g\left(\mathbf{v}\right)+\left[\nabla g(\mathbf{v})\right]^{T}\left(\mathbf{w}-\mathbf{v}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\frac{1}{2}\mathbf{v}^{T}\mathbf{Q}\mathbf{v}+\mathbf{r}^{T}\mathbf{v}+d+\left(\mathbf{Q}\mathbf{v}+\mathbf{r}\right)^{T}\left(\mathbf{w}-\mathbf{v}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The second order Taylor series approximation to 
\begin_inset Formula $g$
\end_inset

 (around the point 
\begin_inset Formula $\mathbf{v}$
\end_inset

) is given by
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
h\left(\mathbf{w}\right)=g\left(\mathbf{v}\right)+\left[\nabla g(\mathbf{v})\right]^{T}\left(\mathbf{w}-\mathbf{v}\right)+\frac{1}{2}\left(\mathbf{w}-\mathbf{v}\right)^{T}\nabla^{2}g(\mathbf{v})\left(\mathbf{w}-\mathbf{v}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\frac{1}{2}\mathbf{v}^{T}\mathbf{Q}\mathbf{v}+\mathbf{r}^{T}\mathbf{v}+d+\left(\mathbf{Q}\mathbf{v}+\mathbf{r}\right)^{T}\left(\mathbf{w}-\mathbf{v}\right)+\frac{1}{2}\left(\mathbf{w}-\mathbf{v}\right)^{T}\mathbf{Q}\left(\mathbf{w}-\mathbf{v}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\frac{1}{2}\mathbf{w}^{T}\mathbf{Q}\mathbf{w}+\mathbf{r}^{T}\mathbf{w}+d=g\left(\mathbf{w}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The fact that the second order Taylor series (or quadratic) approximation
 to 
\begin_inset Formula $g$
\end_inset

 is 
\begin_inset Formula $g$
\end_inset

 itself makes sense, considering that 
\begin_inset Formula $g$
\end_inset

 is a 
\shape italic
quadratic
\shape default
 function!
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.5
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{n}^{T}\left[\begin{array}{ccccc}
h & w_{1} & w_{2} & \cdots & w_{N}\end{array}\right]^{T}+\gamma=0$
\end_inset

 be the equation for the tangent hyperplane, with normal vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

 and bias 
\begin_inset Formula $\gamma$
\end_inset

.
 From Equation (2.3) in the book we know that 
\begin_inset Formula $h(\mathbf{w})=g(\mathbf{v})+\nabla g(\mathbf{v})^{T}\left(\mathbf{w}-\mathbf{v}\right)$
\end_inset

.
 A simple rearrangement then gives 
\begin_inset Formula $h(\mathbf{w})-\nabla g(\mathbf{v})^{T}\mathbf{w}+\nabla g(\mathbf{v})^{T}-g(\mathbf{v})=0$
\end_inset

.
 By inspection it is now easy to see that 
\begin_inset Formula $\mathbf{n}=\left[\begin{array}{c}
1\\
-\nabla g(\mathbf{v})
\end{array}\right]$
\end_inset

 and 
\begin_inset Formula $\gamma=\nabla g(\mathbf{v})^{T}-g(\mathbf{v})$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.6 
\end_layout

\begin_layout Standard
a) Setting the derivative of 
\begin_inset Formula $g\left(w\right)$
\end_inset

 to zero gives 
\begin_inset Formula $g'\left(w\right)=\mbox{log}\left(w\right)-\mbox{log}\left(1-w\right)=0$
\end_inset

.
 Using the property of log, that 
\begin_inset Formula $\mbox{log}\left(a\right)-\mbox{log}\left(b\right)=\mbox{log}\left(\frac{a}{b}\right)$
\end_inset

 this can be written equivalently as 
\begin_inset Formula $\mbox{log}\left(\frac{w}{1-w}\right)=0$
\end_inset

, and exponentiating each side this is equivalently 
\begin_inset Formula $\frac{w}{1-w}=e^{0}=1$
\end_inset

.
 Rearranging this is 
\begin_inset Formula $w=1-w$
\end_inset

, or equivalently 
\begin_inset Formula $w=\frac{1}{2}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Setting the gradient of 
\begin_inset Formula $g\left(\mathbf{w}\right)$
\end_inset

 to 
\begin_inset Formula $\mathbf{0}_{2\times1}$
\end_inset

 gives 
\begin_inset Formula $\nabla g\left(\mathbf{w}\right)=\mathbf{Q}\mathbf{w}+\mathbf{r}=\mathbf{0}_{2\times1}$
\end_inset

.
 Solving for 
\begin_inset Formula $\mathbf{w}$
\end_inset

 then gives 
\begin_inset Formula $\mathbf{w}=-\mathbf{Q}^{-1}\mathbf{r}$
\end_inset

 which, with the given values for 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 and 
\begin_inset Formula $\mathbf{r}$
\end_inset

, has a numerical value of 
\begin_inset Formula $\mathbf{w}=\left[\begin{array}{c}
-0.57\\
-0.57
\end{array}\right]$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.7
\end_layout

\begin_layout Standard
a) 
\begin_inset Formula $g\left(w\right)=w^{2}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $g''(w)=2>0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $g\left(w\right)=e^{w^{2}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $g''(w)=\left(\left(2w\right)^{2}+2\right)e^{w^{2}}$
\end_inset

.
 Note that both 
\begin_inset Formula $\left(2w\right)^{2}+2$
\end_inset

 and 
\begin_inset Formula $e^{w^{2}}$
\end_inset

 are always positive, and so too is their product.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) 
\begin_inset Formula $g\left(w\right)=\textrm{log}\left(1+e^{w}\right)$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula $g''(w)=\frac{e^{w}}{\left(1+e^{w}\right)^{2}}$
\end_inset

.
 Note that both the numerator and denominator are positive, and so too is
 the whole fraction.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
d) 
\begin_inset Formula $g\left(w\right)=-\textrm{log}\left(w\right)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $g''(w)=\frac{1}{w^{2}}>0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.8 
\end_layout

\begin_layout Standard
a) 
\begin_inset Formula $g\left(w\right)=w\tanh\left(w\right)=w\frac{1-e^{-w}}{1+e^{-w}}$
\end_inset


\end_layout

\begin_layout Standard
Setting 
\begin_inset Formula $g'\left(w\right)=\frac{1-e^{-w}+2we^{-w}}{1+e^{-w}}$
\end_inset

 to zero gives 
\begin_inset Formula $1-e^{-w}+2we^{-w}=0$
\end_inset

 or equivalently 
\begin_inset Formula $e^{w}=1-2w$
\end_inset

.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:extended-1"

\end_inset

 shows that functions 
\begin_inset Formula $e^{w}$
\end_inset

 (in black) and 
\begin_inset Formula $1-2w$
\end_inset

 (in blue) only intersect at 
\begin_inset Formula $w=0$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename Figures/2.8.1.png
	lyxscale 30
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:extended-1"

\end_inset

 
\begin_inset Formula $w=0$
\end_inset

 is the only solution to 
\begin_inset Formula $g'\left(w\right)=0$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Plotting 
\begin_inset Formula $g(w)$
\end_inset

 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:extended-1-1"

\end_inset

 we see that while being non-convex, its only stationary point is a global
 minimum at 
\begin_inset Formula $w=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename Figures/2.8.2.png
	lyxscale 30
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:extended-1-1"

\end_inset

 
\begin_inset Formula $g\left(w\right)$
\end_inset

 is nonconvex with no stationary points but a global minimum at 
\begin_inset Formula $w=0$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $g''\left(w\right)=\frac{2e^{-w}}{\left(1+e^{-w}\right)^{2}}\left(2+e^{-w}-w\right)$
\end_inset

.
 Note that 
\begin_inset Formula $\frac{2e^{-w}}{\left(1+e^{-w}\right)^{2}}$
\end_inset

 is always positive while 
\begin_inset Formula $2+e^{-w}-w$
\end_inset

 will be negative for large enough values of 
\begin_inset Formula $w$
\end_inset

.
 Therefore the second derivative can take on negative values and 
\begin_inset Formula $g$
\end_inset

 cannot be convex.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.9 
\end_layout

\begin_layout Standard
a) Suppose first that all of the eigenvalues 
\begin_inset Formula $d_{n}\geq0$
\end_inset

.
 Then the curvature function is 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\mathbf{Q}\mathbf{z}=\mathbf{z}^{T}\left(\stackrel[n=1]{N}{\sum}\mathbf{e}_{n}\mathbf{e}_{n}^{T}d_{n}\right)\mathbf{z}=\underset{n=1}{\overset{N}{\sum}}\left(\mathbf{e}_{n}^{T}\mathbf{z}\right)^{2}d_{n}$
\end_inset

.
 Since each 
\begin_inset Formula $\left(\mathbf{e}_{n}^{T}\mathbf{z}\right)^{2}\geq0$
\end_inset

 together with the assumption that 
\begin_inset Formula $d_{n}\geq0$
\end_inset

, we have that 
\begin_inset Formula $\psi\left(\mathbf{z}\right)\geq0$
\end_inset

 and therefore that 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is positive semidfinite.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Now suppose that 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is positive semidefinite.
 Then we know that the corresponding curvature function 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\mathbf{Q}\mathbf{z}\geq0$
\end_inset

, and using the eigenfactorization of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 this is equivalently 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\mathbf{Q}\mathbf{z}=\mathbf{z}^{T}\left(\stackrel[n=1]{N}{\sum}\mathbf{e}_{n}\mathbf{e}_{n}^{T}d_{n}\right)\mathbf{z}=\underset{n=1}{\overset{N}{\sum}}\left(\mathbf{e}_{n}^{T}\mathbf{z}\right)^{2}d_{n}\geq0$
\end_inset

 .
 Since this sum is 
\emph on
always
\emph default
 nonnegative, so too then must be the eigenvalues 
\begin_inset Formula $d_{n}\geq0$
\end_inset

 for all 
\begin_inset Formula $n=1...N$
\end_inset

.
 If this were not the case, say one 
\begin_inset Formula $d_{j}<0$
\end_inset

, then since the eigenvectors are orthogonal by setting 
\begin_inset Formula $\mathbf{z}=\mathbf{e}_{j}$
\end_inset

 the curavture function reduces to 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\underset{n=1}{\overset{N}{\sum}}\left(\mathbf{e}_{n}^{T}\mathbf{e}_{j}\right)^{2}d_{n}=d_{j}<0$
\end_inset

 which would contradict our assumption that 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 was positive semidefinite.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) 
\begin_inset Formula $\mathbf{Q}=\left[\begin{array}{cc}
1 & 1\\
1 & 1
\end{array}\right]$
\end_inset

 has two eigenvalues, 
\begin_inset Formula $d_{1}=0$
\end_inset

 and 
\begin_inset Formula $d_{2}=2$
\end_inset

, both nonnegative.
 Therefore 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is positive semidefinite and 
\begin_inset Formula $g$
\end_inset

 is convex.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
d) Let 
\begin_inset Formula $\psi\left(\mathbf{z}\right)$
\end_inset

 be the curvature function of the sum
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\mathbf{Q}+\lambda\mathbf{I}_{N\times N}=\mathbf{E}\mathbf{D}\mathbf{E}^{T}+\lambda\mathbf{E}\mathbf{E}^{T}=\underset{n=1}{\overset{N}{\sum}}\mathbf{e}_{n}\mathbf{e}_{n}^{T}d_{n}+\underset{n=1}{\overset{N}{\sum}}\mathbf{e}_{n}\mathbf{e}_{n}^{T}\lambda=\underset{n=1}{\overset{N}{\sum}}\mathbf{e}_{n}\mathbf{e}_{n}^{T}\left(d_{n}+\lambda\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Therefore we have 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\left(\underset{n=1}{\overset{N}{\sum}}\mathbf{e}_{n}\mathbf{e}_{n}^{T}\left(d_{n}+\lambda\right)\right)\mathbf{z}=\underset{n=1}{\overset{N}{\sum}}\left(\mathbf{e}_{n}^{T}\mathbf{z}\right)^{2}\left(d_{n}+\lambda\right)$
\end_inset

.
 Now, since each 
\begin_inset Formula $\left(\mathbf{e}_{n}^{T}\mathbf{z}\right)^{2}\geq0$
\end_inset

 if we set 
\begin_inset Formula $\lambda$
\end_inset

 large enough so that 
\begin_inset Formula $d_{n}+\lambda\geq0$
\end_inset

 for all 
\begin_inset Formula $n$
\end_inset

 then so too must the sum be nonnegative.
 Hence by setting 
\begin_inset Formula $\lambda$
\end_inset

 to the absolute value of the smallest eigenvalue of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

, the sum 
\begin_inset Formula $\mathbf{Q}+\lambda\mathbf{I}_{N\times N}$
\end_inset

 can be made semipositive definite.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.10
\end_layout

\begin_layout Standard
a) The curvature function for 
\begin_inset Formula $\mathbf{x}\mathbf{x}^{T}$
\end_inset

 is given by 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\mathbf{xx}^{T}\mathbf{z}=\left(\mathbf{x}^{T}\mathbf{z}\right)^{2}\geq0$
\end_inset

, which is always nonnegative.
 Therefore all eignevalues of 
\begin_inset Formula $\mathbf{x}\mathbf{x}^{T}$
\end_inset

 must be nonnegative.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) The curvature function for 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\delta_{p}\mathbf{x}_{p}\mathbf{x}_{p}^{T}$
\end_inset

 is given by
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\left(\underset{p=1}{\overset{P}{\sum}}\delta_{p}\mathbf{x}_{p}\mathbf{x}_{p}^{T}\right)\mathbf{z}=\underset{p=1}{\overset{P}{\sum}}\delta_{p}\left(\mathbf{x}_{p}^{T}\mathbf{z}\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which is always nonnegative if 
\begin_inset Formula $\delta_{p}\geq0$
\end_inset

 for all 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) In part b), we showed that 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\delta_{p}\mathbf{x}_{p}\mathbf{x}_{p}^{T}$
\end_inset

 has all nonnegative eignevalues.
 Now note that adding 
\begin_inset Formula $\lambda\mathbf{I}_{N\times N}$
\end_inset

 to 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\delta_{p}\mathbf{x}_{p}\mathbf{x}_{p}^{T}$
\end_inset

 shifts each of its eigenvalues to the right by 
\begin_inset Formula $\lambda$
\end_inset

.
 Therefore all eignevalues of the sum 
\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\delta_{p}\mathbf{x}_{p}\mathbf{x}_{p}^{T}+\lambda\mathbf{I}_{N\times N}$
\end_inset

 are greater than or equal to 
\begin_inset Formula $\lambda>0$
\end_inset

, and hence positive.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.11 
\end_layout

\begin_layout Standard
a) This is the straightforward result of Exercise 2.9.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{w}\right)=\frac{1}{2}\left(\mathbf{Q}^{T}+\mathbf{Q}\right)=\mathbf{Q}$
\end_inset

.
 Therefore regardless of the values for 
\begin_inset Formula $\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $d$
\end_inset

, 
\begin_inset Formula $g$
\end_inset

 always defines a convex function as long as the eigenvalues of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 are all nonnegative.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) The Hessian of 
\begin_inset Formula $g\left(\mathbf{w}\right)$
\end_inset

 can be calculated as 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{w}\right)=4\pi^{2}\mbox{cos}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)\mathbf{w}\mathbf{w}^{T}$
\end_inset

, with the curvature function given as 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\left(\nabla^{2}g\left(\mathbf{w}\right)\right)\mathbf{z}=\mathbf{z}^{T}\left(4\pi^{2}\mbox{cos}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)\mathbf{ww}^{T}\right)\mathbf{z}=4\pi^{2}\mbox{cos}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)\left(\mathbf{w}^{T}\mathbf{z}\right)^{2}$
\end_inset

.
 Note that when 
\begin_inset Formula $\mbox{cos}\left(2\pi\mathbf{w}^{T}\mathbf{w}\right)<0$
\end_inset

, e.g., with 
\begin_inset Formula $\mathbf{w}=\left[\begin{array}{cc}
\nicefrac{1}{2} & 0\end{array}\right]^{T}$
\end_inset

 , 
\begin_inset Formula $\psi\left(\mathbf{z}\right)$
\end_inset

 can take on negative values and therefore 
\begin_inset Formula $g$
\end_inset

 cannot be convex.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.12 
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.13
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.14 
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.15 
\end_layout

\begin_layout Standard
Denoting the deisred length as 
\begin_inset Formula $\ell$
\end_inset

, using the Pythagorean Theorem and the given Figure we can say that 
\begin_inset Formula $\ell^{2}=\left\Vert \mathbf{w}^{k-1}-\mathbf{w}^{k}\right\Vert _{2}^{2}+\left(l\left(\mathbf{w}^{k-1}\right)-l\left(\mathbf{w}^{k}\right)\right)^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Next, noting that 
\begin_inset Formula $l\left(\mathbf{w}^{k-1}\right)=g\left(\mathbf{w}^{k-1}\right)$
\end_inset

, that by definition
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
l\left(\mathbf{w}^{k}\right)=g\left(\mathbf{w}^{k-1}\right)+\nabla g\left(\mathbf{w}^{k-1}\right)^{T}\left(\mathbf{w}^{k}-\mathbf{w}^{k-1}\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and that we know 
\begin_inset Formula $\left\Vert \mathbf{w}^{k-1}-\mathbf{w}^{k}\right\Vert _{2}=\alpha\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}$
\end_inset

 all together we may rewrite this equivalently as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\ell^{2}=\alpha^{2}\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}^{2}+\left(\nabla g\left(\mathbf{w}^{k-1}\right)^{T}\left(\mathbf{w}^{k}-\mathbf{w}^{k-1}\right)\right)^{2}.
\end{equation}

\end_inset

Using the definition of 
\begin_inset Formula $\mathbf{w}^{k}=\mathbf{w}^{k-1}-\alpha\nabla g\left(\mathbf{w}^{k-1}\right)$
\end_inset

 this can be simplified as 
\begin_inset Formula $\ell^{2}=\alpha^{2}\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}^{2}+\alpha^{2}\left(\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}^{2}\right)^{2}$
\end_inset

 or equivalently 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\ell^{2}=\alpha^{2}\left(1+\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}^{2}\right)\left\Vert \nabla g\left(\mathbf{w}^{k-1}\right)\right\Vert _{2}^{2},
\end{equation}

\end_inset

and taking the square root of both sides gives the desired solution.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.16 
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 2.17 
\end_layout

\begin_layout Standard
a) Setting the gradient of 
\begin_inset Formula $g\left(\mathbf{w}\right)=\mbox{log}\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)$
\end_inset

 to zero, using the chain rule, gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\mathbf{w}\right)=\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\mathbf{w}=\mathbf{0}_{N\times1}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since the scalar weight 
\begin_inset Formula $\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\geq1$
\end_inset

 the only way the equality can occur is when 
\begin_inset Formula $\mathbf{w}=\mathbf{0}_{N\times1}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) The Hessian of 
\begin_inset Formula $g$
\end_inset

, using the chain rule and product rule, may be calculated as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{w}\right)=\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\mathbf{w}\mathbf{w}^{T}+\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\mathbf{I}_{N\times N}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Fixing 
\begin_inset Formula $\mathbf{w}$
\end_inset

 for the moment, for any 
\begin_inset Formula $N$
\end_inset

 length column vector 
\begin_inset Formula $\mathbf{z}$
\end_inset

 we have that (where 
\begin_inset Formula $\mathbf{I}_{N\times N}$
\end_inset

 is a 
\begin_inset Formula $N\times N$
\end_inset

 identity)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{w}\right)\mathbf{z}=\mathbf{z}^{T}\left(\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\mathbf{w}\mathbf{w}^{T}+\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\mathbf{I}_{N\times N}\right)\mathbf{z}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{w}\right)\mathbf{z}=\mathbf{z}^{T}\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\mathbf{w}\mathbf{w}^{T}\mathbf{z}+\mathbf{z}^{T}\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\mathbf{I}_{N\times N}\mathbf{z}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\mathbf{z}^{T}\mathbf{w}\mathbf{w}^{T}\mathbf{z}+\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\mathbf{z}^{T}\mathbf{z}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\left(\mathbf{z}^{T}\mathbf{w}\right)^{2}+\frac{2e^{\mathbf{w}^{T}\mathbf{w}}}{1+e^{\mathbf{w}^{T}\mathbf{w}}}\left\Vert \mathbf{z}\right\Vert _{2}^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since each component of this expression is nonnegative regardless of the
 
\begin_inset Formula $\mathbf{z}$
\end_inset

 chosen, i.e., 
\begin_inset Formula $\frac{4e^{\mathbf{w}^{T}\mathbf{w}}}{\left(1+e^{\mathbf{w}^{T}\mathbf{w}}\right)^{2}}\geq0$
\end_inset

, 
\begin_inset Formula $\left(\mathbf{z}^{T}\mathbf{w}\right)^{2}\geq0$
\end_inset

, etc., so too is the sum always nonnegative, regardless of the 
\begin_inset Formula $\mathbf{z}$
\end_inset

 chosen.
 However this also holds regardless of which 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is chosen - hence we have that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{w}\right)\mathbf{z}\geq0,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
for all 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{z}$
\end_inset

, and therefore (by the second order definition of convexity) 
\begin_inset Formula $g$
\end_inset

 is indeed convex.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
d) See our code repository.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 3.
 Regression
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.1 
\end_layout

\begin_layout Standard
This is a programming exercise.
 
\end_layout

\begin_layout Standard
Solving the Least Squares problem for the student debt data gives the trend
 line as 
\begin_inset Formula $y=b+wx$
\end_inset

, where 
\begin_inset Formula $x$
\end_inset

 is year, 
\begin_inset Formula $y$
\end_inset

 is the amount of debt in trillions of dollars, and optimal parameters 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

 are found respectively as 
\begin_inset Formula $b=-160.7$
\end_inset

 and 
\begin_inset Formula $w=.08$
\end_inset

 (see our code repository).
 Therefore in year 2050 (
\begin_inset Formula $x_{new}=2050$
\end_inset

), the student debt will reach 
\begin_inset Formula $y_{new}=-160.7+.08(2050)\thickapprox3.9$
\end_inset

 trillion dollars if this trend continues.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.2 
\end_layout

\begin_layout Standard
a) See our code repository.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Running the code in part a) returns the optimal parameter values 
\begin_inset Formula $w_{0}=6.81$
\end_inset

 and 
\begin_inset Formula $w_{1}=0.65$
\end_inset

.
 Exponentiating both sides of Equation (3.30) in the book, we have 
\begin_inset Formula $y\approx e^{w_{0}}x^{w_{1}}$
\end_inset

.
 Plugging the optimal parameter values for 
\begin_inset Formula $w_{0}=6.81$
\end_inset

 and 
\begin_inset Formula $w_{1}=0.65$
\end_inset

 found in part a), the nonlinear relationship between 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 can be approximated as 
\begin_inset Formula $y\approx907\,x^{0.65}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) With 
\begin_inset Formula $x=10$
\end_inset

 kg, we have that 
\begin_inset Formula $y\approx4051$
\end_inset

 kJ/day.
 So an animal weighing 10 kg will require 
\begin_inset Formula $\frac{4051}{4.18}=969$
\end_inset

 kcal per day.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.3
\end_layout

\begin_layout Standard
a) Noting that 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}=\tilde{\mathbf{w}}^{T}\tilde{\mathbf{x}}_{p}$
\end_inset

 we can write
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
g\left(\tilde{\mathbf{w}}\right)=\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-y_{p}\right)^{2}=\overset{P}{\underset{p=1}{\sum}}\left\{ \left(\tilde{\mathbf{w}}^{T}\tilde{\mathbf{x}}_{p}-y_{p}\right)\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-y_{p}\right)\right\} 
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{w}}^{T}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{w}}^{T}\tilde{\mathbf{x}}_{p}y_{p}-\overset{P}{\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}+\overset{P}{\underset{p=1}{\sum}}y_{p}^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\frac{1}{2}\tilde{\mathbf{w}}^{T}\left(2\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\right)\tilde{\mathbf{w}}-\left(\overset{P}{2\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{x}}_{p}\right)^{T}\tilde{\mathbf{w}}+\overset{P}{\underset{p=1}{\sum}}y_{p}^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Hence 
\begin_inset Formula $\mathbf{Q}=2\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}=-2\overset{P}{\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{x}}_{p}$
\end_inset

 and 
\begin_inset Formula $d=\overset{P}{\underset{p=1}{\sum}}y_{p}^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\mathbf{Q}\mathbf{z}=\mathbf{z}^{T}\left(2\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\right)\mathbf{z}=\underset{p=1}{\overset{P}{\sum}}2\left(\tilde{\mathbf{x}}_{p}^{T}\mathbf{z}\right)^{2}\geq0$
\end_inset

.
 So 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is positive semidefinite with all nonnegative eigenvalues.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Hessian of 
\begin_inset Formula $g$
\end_inset

 can be easily calculated as 
\begin_inset Formula $\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}^{T}\right)$
\end_inset

.
 Now since 
\begin_inset Formula $\mathbf{Q}^{T}=\mathbf{Q}$
\end_inset

 (see part a), we can simply write 
\begin_inset Formula $\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\frac{1}{2}\left(\mathbf{Q}+\mathbf{Q}\right)=\mathbf{Q}$
\end_inset

.
 Now because 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 has all nonnegative eigenvalues as shown in part b), the function 
\begin_inset Formula $g$
\end_inset

 is convex according to the second order definition of convexity.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
d) Knowing the form of gradient 
\begin_inset Formula $\nabla g\left(\tilde{\mathbf{w}}\right)=\mathbf{Q}\tilde{\mathbf{w}}+\mathbf{r}$
\end_inset

 and Hessian 
\begin_inset Formula $\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\mathbf{Q}$
\end_inset

, and starting at an arbitrarily chosen point 
\begin_inset Formula $\mathbf{v}$
\end_inset

, the first Newton step is the solution to the following linear system of
 equations
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\nabla^{2}g\left(\mathbf{v}\right)\right]\tilde{\mathbf{w}}=\left[\nabla^{2}g\left(\mathbf{v}\right)\right]\mathbf{v}-\nabla g\left(\mathbf{v}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Plugging 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{v}\right)=\mathbf{Q}=2\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}$
\end_inset

 and 
\begin_inset Formula $\nabla g\left(\mathbf{v}\right)=\mathbf{Q}\mathbf{v}+\mathbf{r}=$
\end_inset

 into the equation above, we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{Q}\tilde{\mathbf{w}}=\mathbf{Q}\mathbf{v}-\left(\mathbf{Q}\mathbf{v}+\mathbf{r}\right)=-\mathbf{r}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Plugging again 
\begin_inset Formula $\mathbf{Q}=2\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{r}=-2\overset{P}{\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{x}}_{p}$
\end_inset

 from part a) into this equation gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\right)\tilde{\mathbf{w}}=\overset{P}{\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.4
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.5
\end_layout

\begin_layout Standard
a) Using the compact notation introduced in (3.16) we can write the cost
 function 
\begin_inset Formula $g$
\end_inset

 as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
g\left(\tilde{\mathbf{w}}\right)=\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}-y_{p}\right)^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Calculating the gradient of 
\begin_inset Formula $g$
\end_inset

 as 
\begin_inset Formula $\nabla g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}-y_{p}\right)\tilde{\mathbf{f}}_{p}$
\end_inset

, the first order system 
\begin_inset Formula $\nabla g\left(\tilde{\mathbf{w}}\right)=\mathbf{0}_{2\times1}$
\end_inset

 then can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}-y_{p}\right)\tilde{\mathbf{f}}_{p}=\mathbf{0}_{2\times1},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{f}}_{p}\tilde{\mathbf{f}}_{p}^{T}\right)\tilde{\mathbf{w}}=\overset{P}{\underset{p=1}{\sum}}y_{p}\tilde{\mathbf{f}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) This is a programming exercise.
 See the code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.6
\end_layout

\begin_layout Standard
a) From elementary physics or just by inspecting the data, one can propose
 the follwing relationship between the input 
\begin_inset Formula $x$
\end_inset

 and output 
\begin_inset Formula $y$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
y=w\textrm{sin}\left(\frac{\pi x}{180}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.7
\end_layout

\begin_layout Standard
a) 
\begin_inset Formula $y=e^{b+wx}$
\end_inset

.
 Note that taking log of both sides gives 
\begin_inset Formula $\textrm{log }y=b+wx$
\end_inset

, which is linear in both weights 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.8
\end_layout

\begin_layout Standard
a) Denoting by 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

 the current passing through the circuit and the length of the added wire,
 respectively, a 
\shape italic
potential
\shape default
 model could take the form 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
y=\frac{1}{b+xw},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

 are the model parameters to learn.
 Note that if we did not include 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $b$
\end_inset

 as a parameter, the current would go to infinity at 
\begin_inset Formula $x=0$
\end_inset

!
\end_layout

\begin_layout Standard
If we tranform the output 
\begin_inset Formula $y$
\end_inset

 by taking its inverse 
\begin_inset Formula $\frac{1}{y}$
\end_inset

, we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1}{y}=b+xw.\label{eq:ohm}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) The Least Squares cost function for the Ohm's dataset associated with
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ohm"

\end_inset

) then takes the form 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(b,w\right)=\overset{5}{\underset{p=1}{\sum}}\left(b+x_{p}w-\frac{1}{y_{p}}\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which can be written more compactly as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(\tilde{\mathbf{w}}\right)=\overset{5}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-\frac{1}{y_{p}}\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
introducing the familiar notation
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{x}}_{p}=\left[\begin{array}{c}
1\\
x_{p}
\end{array}\right]\quad\textrm{and}\quad\mathbf{\tilde{\mathbf{w}}}=\left[\begin{array}{c}
b\\
w
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now setting the gradient of 
\begin_inset Formula $g$
\end_inset

 to zero, we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\tilde{\mathbf{w}}\right)=2\overset{5}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-\frac{1}{y_{p}}\right)\tilde{\mathbf{x}}_{p}=\mathbf{0}_{2\times1}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This system can be solved for optimal parameters using a linear solver or
 algebraically as 
\begin_inset Formula $\tilde{\mathbf{w}}=\left(\overset{5}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\right)^{-1}\left(\overset{5}{\underset{p=1}{\sum}}\frac{1}{y_{p}}\tilde{\mathbf{x}}_{p}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.9
\end_layout

\begin_layout Standard
a) By simple inspection we find that 
\begin_inset Formula $\mathbf{f}_{p}=\left[\begin{array}{c}
x_{1,p}\\
x_{2,p}
\end{array}\right]$
\end_inset

 and 
\begin_inset Formula $y_{p}=1$
\end_inset

 for all 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.10
\end_layout

\begin_layout Standard
a) 
\begin_inset Formula $\sigma^{-1}\left(\sigma\left(t\right)\right)=\textrm{log}\left(\frac{\sigma\left(t\right)}{1-\sigma\left(t\right)}\right)=\textrm{log}\left(\frac{\frac{1}{1+e^{-t}}}{1-\frac{1}{1+e^{-t}}}\right)=\textrm{log}\left(\frac{\frac{1}{1+e^{-t}}}{\frac{e^{-t}}{1+e^{-t}}}\right)=\textrm{log}\left(\frac{1}{e^{-t}}\right)=t$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) From (3.23) we have 
\begin_inset Formula $\sigma\left(b+x_{p}w\right)\approx y_{p}$
\end_inset

 for all 
\begin_inset Formula $p$
\end_inset

.
 Taking the 
\shape italic
sigmoid-inverse
\shape default
 from both sides then gives 
\begin_inset Formula $\sigma^{-1}\left(\sigma\left(b+x_{p}w\right)\right)\approx\sigma^{-1}\left(y_{p}\right)$
\end_inset

, which simplifies to 
\begin_inset Formula $b+x_{p}w\approx\textrm{log}\left(\frac{y_{p}}{1-y_{p}}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Similar to part b) of Exercise 3.8 we can form the Least Squares cost
 function 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(b,w\right)=\overset{P}{\underset{p=1}{\sum}}\left(b+x_{p}w-\textrm{log}\left(\frac{y_{p}}{1-y_{p}}\right)\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which can be written more compactly as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g\left(\tilde{\mathbf{w}}\right)=\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-\textrm{log}\left(\frac{y_{p}}{1-y_{p}}\right)\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
introducing the familiar notation 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{x}}_{p}=\left[\begin{array}{c}
1\\
x_{p}
\end{array}\right]\quad\textrm{and}\quad\mathbf{\tilde{\mathbf{w}}}=\left[\begin{array}{c}
b\\
w
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Setting the gradient of 
\begin_inset Formula $g$
\end_inset

 to zero, we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}-\textrm{log}\left(\frac{y_{p}}{1-y_{p}}\right)\right)\tilde{\mathbf{x}}_{p}=\mathbf{0}_{2\times1}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This system can be solved for 
\emph on
optimal
\emph default
 parameters using a linear solver or algebraically as 
\begin_inset Formula $\tilde{\mathbf{w}}=\left(\overset{P}{\underset{p=1}{\sum}}\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}\right)^{-1}\left(\overset{P}{\underset{p=1}{\sum}}\textrm{log}\left(\frac{y_{p}}{1-y_{p}}\right)\tilde{\mathbf{x}}_{p}\right)$
\end_inset

.
 See our repository for the code.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.11
\end_layout

\begin_layout Standard
a) Using the compact notation the cost function can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(\tilde{\mathbf{w}}\right)=\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now, the partial derivative with respect to the 
\begin_inset Formula $i$
\end_inset

 th entry in 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can be computed as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)
\]

\end_inset


\begin_inset Formula 
\[
=2\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)\sigma'\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)
\]

\end_inset


\begin_inset Formula 
\begin{equation}
=2\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{x}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The full gradient of 
\begin_inset Formula $g$
\end_inset

 is then given by 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.12
\end_layout

\begin_layout Standard
a) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) To find the stationary points of 
\begin_inset Formula $g$
\end_inset

 we must take its gradient and set it equal to zero.
 The resulting system of equations however 
\series bold
cannot be solved analytically
\series default
 and hence an iterative method (e.g., gradient descent) must be employed.
 The cost function in this case is 
\series bold
nonconvex
\series default
 (see Figure ) which requires us to run gradient descent multiple times
 with different starting points, and take the weight vector resulting in
 the smallest objective value as the optimal weight vector.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename Figures/3.12.png
	lyxscale 30
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:extended-1-2-1"

\end_inset

 Exercise 3.12 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.13
\end_layout

\begin_layout Standard
a) Using the compact notation
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{x}}_{p}=\left[\begin{array}{c}
1\\
x_{p}
\end{array}\right]\quad\textrm{and}\quad\mathbf{\tilde{\mathbf{w}}}=\left[\begin{array}{c}
b\\
\mathbf{w}
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
the regularized cost function can be written as 
\begin_inset Formula $g\left(\tilde{\mathbf{w}}\right)=\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)^{2}+\lambda\mathbf{w}^{T}\mathbf{w}$
\end_inset

.
 The gradient of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can then be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\tilde{\mathbf{w}}\right)=\nabla_{\tilde{\mathbf{w}}}\left(\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)^{2}\right)+\nabla_{\tilde{\mathbf{w}}}\left(\lambda\mathbf{w}^{T}\mathbf{w}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The first part, as shown in Exercise 3.11, can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\nabla_{\tilde{\mathbf{w}}}\left(\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)^{2}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=2\overset{P}{\underset{p=1}{\sum}}\left(\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)-y_{p}\right)\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{\mathbf{x}}_{p},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and the second part as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\nabla_{\tilde{\mathbf{w}}}\left(\lambda\mathbf{w}^{T}\mathbf{w}\right)=\left[\begin{array}{c}
\frac{\partial}{\partial b}\left(\lambda\mathbf{w}^{T}\mathbf{w}\right)\\
\nabla_{\mathbf{w}}\left(\lambda\mathbf{w}^{T}\mathbf{w}\right)
\end{array}\right]=\left[\begin{array}{c}
0\\
\nabla_{\mathbf{w}}\left(\lambda\mathbf{w}^{T}\mathbf{w}\right)
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\left[\begin{array}{c}
0\\
2\lambda\mathbf{w}
\end{array}\right]=2\lambda\left[\begin{array}{c}
0\\
\mathbf{w}
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 3.14
\end_layout

\begin_layout Standard
a) Writing 
\begin_inset Formula $\frac{\lambda}{2}\left\Vert \mathbf{w}-\mathbf{w}^{k-1}\right\Vert _{2}^{2}$
\end_inset

 equivalently as 
\begin_inset Formula $\frac{1}{2}\left(\mathbf{w}-\mathbf{w}^{k-1}\right)^{T}\left(\lambda\mathbf{I}_{N\times N}\right)\left(\mathbf{w}-\mathbf{w}^{k-1}\right)$
\end_inset

, 
\begin_inset Formula $h$
\end_inset

 can be written as 
\end_layout

\begin_layout Standard
how that the first order condition for optimality leads to the following
 adjusted Newton's system for a stationary point of the above quadratic
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right]\mathbf{w}=\left[\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right]\mathbf{w}^{k-1}-\nabla g\left(\mathbf{w}^{k-1}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It is easy to verify that 
\begin_inset Formula $h$
\end_inset

 takes the quadratic form 
\begin_inset Formula $h\left(\mathbf{w}\right)=\frac{1}{2}\mathbf{w}^{T}\mathbf{Q}\mathbf{w}+\mathbf{r}^{T}\mathbf{w}+d$
\end_inset

 where
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{Q}=\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{r}=\nabla g\left(\mathbf{w}^{k-1}\right)-\left(\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right)\mathbf{w}^{k-1},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
d=g\left(\mathbf{w}^{k-1}\right)-\nabla g\left(\mathbf{w}^{k-1}\right)^{T}\mathbf{w}^{k-1}+\frac{1}{2}\left(\mathbf{w}^{k-1}\right)^{T}\left[\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right]\mathbf{w}^{k-1}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Setting the gradient of 
\begin_inset Formula $h$
\end_inset

 to zero, 
\begin_inset Formula $\nabla h\left(\mathbf{w}\right)=\mathbf{Q}\mathbf{w}+\mathbf{r}=\mathbf{0}$
\end_inset

, we have 
\begin_inset Formula $\mathbf{Q}\mathbf{w}=-\mathbf{r}$
\end_inset

.
 Substittuting corresponding values for 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 and 
\begin_inset Formula $\mathbf{r}$
\end_inset

 from above gives the desired system 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right]\mathbf{w}=\left[\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}\right]\mathbf{w}^{k-1}-\nabla g\left(\mathbf{w}^{k-1}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Denoting the set of eigenvalues of 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{w}^{k-1}\right)$
\end_inset

 by 
\begin_inset Formula $\left\{ \delta_{n}\right\} _{n=1}^{N}$
\end_inset

, we showed in Exercise 2.9 that the set of eigenvalues for 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}$
\end_inset

 is given as 
\begin_inset Formula $\left\{ \delta_{n}+\lambda\right\} _{n=1}^{N}$
\end_inset

.
 Therefore by setting 
\begin_inset Formula $\lambda$
\end_inset

 to any value larger than 
\begin_inset Formula $\underset{}{\textrm{min}}$
\end_inset

 
\begin_inset Formula $\left\{ 0,\,\delta_{1},\,\delta_{2},\,\ldots,\,\delta_{N}\right\} $
\end_inset

, we can gurantee all eigenvalues of 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}$
\end_inset

 are positive.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Following the notation defined in part a), the Hessian of 
\begin_inset Formula $h$
\end_inset

 can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}h\left(\mathbf{w}\right)=\frac{1}{2}\left(\mathbf{Q}^{T}+\mathbf{Q}\right)=\mathbf{Q}=\nabla^{2}g\left(\mathbf{w}^{k-1}\right)+\lambda\mathbf{I}_{N\times N}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now, according to part b) setting 
\begin_inset Formula $\lambda$
\end_inset

 to any value larger than 
\begin_inset Formula $\underset{}{\textrm{min}}$
\end_inset

 
\begin_inset Formula $\left\{ 0,\,\delta_{1},\,\delta_{2},\,\ldots,\,\delta_{N}\right\} $
\end_inset

 makes 
\begin_inset Formula $\nabla^{2}h\left(\mathbf{w}\right)$
\end_inset

 positive definite, implying (based on the second order definition of convexity)
 that 
\begin_inset Formula $h$
\end_inset

 is indeed convex.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 4.
 Classification
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.1
\end_layout

\begin_layout Standard
a) First note that using the compact notation
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{x}}_{p}=\left[\begin{array}{c}
1\\
x_{p}
\end{array}\right]\quad\textrm{and}\quad\mathbf{\tilde{\mathbf{w}}}=\left[\begin{array}{c}
b\\
\mathbf{w}
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and defining the constant vector 
\begin_inset Formula $\mathbf{c}=-y_{p}\tilde{\mathbf{x}}_{p}$
\end_inset

, we can write each summand as 
\begin_inset Formula $h\left(\mathbf{\tilde{\mathbf{w}}}\right)=\mbox{max}\left(0,\,\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

.
 According to the zeroth order definition of convexity, 
\begin_inset Formula $h$
\end_inset

 is convex if
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h\left(\lambda\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\lambda h\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)h\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
for all 
\begin_inset Formula $0\leq\lambda\leq1$
\end_inset

.
 Using the definition of 
\begin_inset Formula $h$
\end_inset

 we need to show that
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{max}\left(0,\,\mathbf{c}^{T}\left(\lambda\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{\tilde{\mathbf{w}}}_{2}\right)\right)\leq\lambda\mbox{max}\left(0,\,\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\right)+\left(1-\lambda\right)\mbox{max}\left(0,\,\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\right)+\mbox{max}\left(0,\,\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\right),\label{eq:ineq}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
using the fact that 
\begin_inset Formula $\lambda\mbox{max}\left(0,\,\zeta\right)=\mbox{max}\left(0,\,\lambda\zeta\right)$
\end_inset

 when 
\begin_inset Formula $\lambda$
\end_inset

 is nonnegative.
 Now to see that (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ineq"

\end_inset

) indeed holds, we break it down into four cases:
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
Case 1.
 
\begin_inset Formula $\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\geq0$
\end_inset

 and 
\begin_inset Formula $\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\geq0$
\end_inset


\end_layout

\begin_layout Standard
In this case both sides of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ineq"

\end_inset

) simplify to 
\begin_inset Formula $\lambda\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{2}$
\end_inset

 and we have equality.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
Case 2.
 
\begin_inset Formula $\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}<0$
\end_inset

 and 
\begin_inset Formula $\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}<0$
\end_inset


\end_layout

\begin_layout Standard
In this case both sides of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ineq"

\end_inset

) simplify to 0 and we have equality again.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
Case 3.
 
\begin_inset Formula $\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\geq0$
\end_inset

 and 
\begin_inset Formula $\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}<0$
\end_inset


\end_layout

\begin_layout Standard
In this case we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{1}\right)\leq\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\right)+\mbox{max}\left(0,\,\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\right).\label{eq:ineq-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
Case 4.
 
\begin_inset Formula $\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}<0$
\end_inset

 and 
\begin_inset Formula $\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\geq0$
\end_inset


\end_layout

\begin_layout Standard
In this case we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{c}^{T}\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\mbox{max}\left(0,\,\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\right)\leq\mbox{max}\left(0,\,\lambda\mathbf{c}^{T}\tilde{\mathbf{w}_{1}}\right)+\mbox{max}\left(0,\,\left(1-\lambda\right)\mathbf{c}^{T}\tilde{\mathbf{w}}_{2}\right).\label{eq:ineq-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) We show that
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
f\left(\lambda t+\left(1-\lambda\right)t\right)\leq\lambda f\left(t\right)+\left(1-\lambda\right)f\left(t\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $f(t)=g(t)+h(t)$
\end_inset

 , and 
\begin_inset Formula $g$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 are both convex.
 Using the definition of 
\begin_inset Formula $f$
\end_inset

 as 
\begin_inset Formula $f(t)=g(t)+h(t)$
\end_inset

, the left hand side of above can be written as 
\begin_inset Formula $g\left(\lambda t+\left(1-\lambda\right)t\right)+h\left(\lambda t+\left(1-\lambda\right)t\right)$
\end_inset

 which is bounded from above by 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\lambda g\left(t\right)+\left(1-\lambda\right)g\left(t\right)\right]+\left[\lambda h\left(t\right)+\left(1-\lambda\right)h\left(t\right)\right],\label{eq:rearr}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
using zeroth order definition of convexity for 
\begin_inset Formula $g$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

.
 Rearranging the terms, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rearr"

\end_inset

) can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\lambda g\left(t\right)+\lambda h\left(t\right)\right]+\left[\left(1-\lambda\right)g\left(t\right)+\left(1-\lambda\right)h\left(t\right)\right]=\lambda f\left(t\right)+\left(1-\lambda\right)f\left(t\right).\label{eq:rearr-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Putting the results of part a) and part b) together, the perceptron cost
 is convex as it is the sum of 
\begin_inset Formula $P$
\end_inset

 convex summands, one for each data point.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.2
\end_layout

\begin_layout Standard
The Hessian for the logistic regression cost 
\begin_inset Formula $g$
\end_inset

 is given by
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\mathbf{\tilde{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\left(1-\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\right)\mathbf{\mathbf{\tilde{x}}}_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}.\label{eq:softmax-Hessian}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To prove 
\begin_inset Formula $g$
\end_inset

 is convex, we use the second order definition of convexity and show 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{\tilde{w}}\right)$
\end_inset

 is positive semidefinite by forming
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{\tilde{w}}\right)\mathbf{z}=\mathbf{z}^{T}\left[\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\left(1-\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\right)\mathbf{\mathbf{\tilde{x}}}_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\right]\mathbf{z}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\delta_{p}\left(\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{z}\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\delta_{p}=\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\left(1-\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\right)$
\end_inset

.
 Now note that since 
\begin_inset Formula $0\leq\sigma\left(\zeta\right)\leq1$
\end_inset

 we have that 
\begin_inset Formula $\delta_{p}\geq0$
\end_inset

, and therefore 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{\tilde{w}}\right)\mathbf{z}=\underset{p=1}{\overset{P}{\sum}}\delta_{p}\left(\mathbf{\mathbf{\tilde{x}}}_{p}^{T}\mathbf{z}\right)^{2}\geq0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.3
\end_layout

\begin_layout Standard
a) The softmax cost is given by 
\begin_inset Formula $g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}\right)$
\end_inset

.
 The partial derivative of the cost with respect to the 
\begin_inset Formula $i$
\end_inset

 th entry in 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can be computed as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial\tilde{w_{i}}}\left(1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}\right)}{1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\frac{\left(e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)}{1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}=-\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}{1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{x}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The full gradient therefore can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g=-\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}{1+e^{-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Multiplying both the numerator and denominator of each summand by 
\begin_inset Formula $e^{y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}$
\end_inset

 gives 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g=-\underset{p=1}{\overset{P}{\sum}}\frac{1}{1+e^{y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{\mathbf{x}}_{p}=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $\nabla g=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{\mathbf{x}}_{p}$
\end_inset

 can be written as 
\begin_inset Formula $\tilde{\mathbf{X}}\mathbf{r}$
\end_inset

, where 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{X}}=\left[\begin{array}{cccc}
\tilde{\mathbf{x}}_{1} & \tilde{\mathbf{x}}_{2} & \cdots & \tilde{\mathbf{x}}_{P}\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{r}=-\overrightarrow{\sigma}\left(-\left(\tilde{\mathbf{X}}^{T}\tilde{\mathbf{w}}\right)\varodot\mathbf{y}\right)\varodot\mathbf{y}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In the equation above, 
\begin_inset Formula $\varodot$
\end_inset

 denotes the Hadamard (entry-wise) product,
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\overrightarrow{\sigma}\left(\left[\begin{array}{c}
\zeta_{1}\\
\zeta_{2}\\
\vdots\\
\zeta_{P}
\end{array}\right]\right)=\left[\begin{array}{c}
\sigma\left(\zeta_{1}\right)\\
\sigma\left(\zeta_{2}\right)\\
\vdots\\
\sigma\left(\zeta_{P}\right)
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{y}=\left[\begin{array}{c}
y_{1}\\
y_{2}\\
\vdots\\
y_{P}
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.4
\end_layout

\begin_layout Standard
a) We show in Exercise 4.3 that
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{x}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of the above with respect to 
\begin_inset Formula $\tilde{w_{i}}$
\end_inset

 then gives the 
\begin_inset Formula $\left(i,j\right)$
\end_inset

 th entry in 
\begin_inset Formula $\nabla^{2}g$
\end_inset

, as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial^{2}}{\partial\tilde{w_{j}}\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=-\frac{\partial}{\partial\tilde{w_{j}}}\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{x}_{p,i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=-\underset{p=1}{\overset{P}{\sum}}\frac{\partial}{\partial\tilde{w_{j}}}\left(\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{x}_{p,i}\right)=-\underset{p=1}{\overset{P}{\sum}}\sigma'\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{x}_{p,i}\frac{\partial}{\partial\tilde{w_{j}}}\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{x}_{p,i}\left(-y_{p}\tilde{x}_{p,j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{x}_{p,i}\tilde{x}_{p,j}y_{p}^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now note that 
\begin_inset Formula $y_{p}^{2}=1$
\end_inset

 (since 
\begin_inset Formula $y_{p}\in\left\{ -1,+1\right\} $
\end_inset

), and we can write the full Hessian as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) 
\begin_inset Formula $\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{\mathbf{x}}_{p}\tilde{\mathbf{x}}_{p}^{T}$
\end_inset

 can be written as 
\begin_inset Formula $\tilde{\mathbf{X}}\textrm{diag}\left(\mathbf{r}\right)\tilde{\mathbf{X}}^{T}$
\end_inset

, where 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{X}}=\left[\begin{array}{cccc}
\tilde{\mathbf{x}}_{1} & \tilde{\mathbf{x}}_{2} & \cdots & \tilde{\mathbf{x}}_{P}\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{r}=\mathbf{s}\varodot\left(\mathbf{1}_{P\times1}-\mathbf{s}\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
wherein 
\begin_inset Formula $\varodot$
\end_inset

 denotes the Hadamard (entry-wise) product,
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
s=\overrightarrow{\sigma}\left(-\left(\tilde{\mathbf{X}}^{T}\tilde{\mathbf{w}}\right)\varodot\mathbf{y}\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\overrightarrow{\sigma}\left(\left[\begin{array}{c}
\zeta_{1}\\
\zeta_{2}\\
\vdots\\
\zeta_{P}
\end{array}\right]\right)=\left[\begin{array}{c}
\sigma\left(\zeta_{1}\right)\\
\sigma\left(\zeta_{2}\right)\\
\vdots\\
\sigma\left(\zeta_{P}\right)
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{y}=\left[\begin{array}{c}
y_{1}\\
y_{2}\\
\vdots\\
y_{P}
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.5
\end_layout

\begin_layout Standard
a) Suppose that the hyperplane 
\begin_inset Formula $b+\mathbf{x}^{T}\mathbf{w}=0$
\end_inset

 perfectly separates the two classes of data.
 Thus for every 
\begin_inset Formula $\mathbf{x}_{p}$
\end_inset

 we have that 
\begin_inset Formula $-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)<0$
\end_inset

.
 Multiplying 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 by a constant 
\begin_inset Formula $C>1$
\end_inset

 then gives 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
-y_{p}\left(bC+\mathbf{x}_{p}^{T}\mathbf{w}C\right)=C\left(-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)<-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)<0.
\end{equation}

\end_inset

Denoting 
\begin_inset Formula $-y_{p}\left(bC+\mathbf{x}_{p}^{T}\mathbf{w}C\right)$
\end_inset

 by 
\begin_inset Formula $\alpha_{p}$
\end_inset

, and 
\begin_inset Formula $-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)$
\end_inset

 by 
\begin_inset Formula $\beta_{p}$
\end_inset

, we want to show that 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{\alpha_{p}}\right)<\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{\beta_{p}}\right)$
\end_inset

.
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Since 
\begin_inset Formula $\alpha_{p}<\beta_{p}$
\end_inset

, we have that 
\begin_inset Formula $e^{\alpha_{p}}<e^{\beta_{p}}$
\end_inset

.
 Further, we can write
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mbox{log}\left(1+e^{\alpha_{p}}\right)<\mbox{log}\left(1+e^{\beta_{p}}\right)$
\end_inset

.
 Summing this inequality over all 
\begin_inset Formula $p$
\end_inset

 then gives the desired inequality.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) According to part a)
\series bold
 
\series default
if we keep multiplying the hyperplane parameters by 
\begin_inset Formula $C>1$
\end_inset

, the evaluation of the softmax cost will get smaller and smaller.
 Theoretically speaking, this means that the minimum of the softmax cost
 (when the data is separable) is at infinity! Practically speaking, this
 creates a numerical issue since every computer has a limit on the largest
 number that can be stored in memory.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.6
\end_layout

\begin_layout Standard
a) First note that using the compact notation
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{x}}_{p}=\left[\begin{array}{c}
1\\
x_{p}
\end{array}\right]\quad\textrm{and}\quad\mathbf{\tilde{\mathbf{w}}}=\left[\begin{array}{c}
b\\
\mathbf{w}
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and defining the constant vector 
\begin_inset Formula $\mathbf{c}=-y_{p}\tilde{\mathbf{x}}_{p}$
\end_inset

, we can write each summand of the margin and squared margin costs as, 
\begin_inset Formula $\mbox{max}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

 and 
\begin_inset Formula $\mbox{max}^{2}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

, respectively.
 In Exercise 4.1 we use the zeroth order definition of convexity to show
 that the perceptron cost 
\begin_inset Formula $h\left(\mathbf{\tilde{\mathbf{w}}}\right)=\mbox{max}\left(0,\,\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

 is indeed convex.
 Now note that 
\begin_inset Formula $\mbox{max}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

 is just a shifted version of the perceptron, specifically 
\begin_inset Formula $\mbox{max}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)=h\left(\mathbf{\tilde{\mathbf{w}}}+\frac{\mathbf{c}}{\mathbf{c}^{T}\mathbf{c}}\right)$
\end_inset

, and is therefore convex.
 What remains to show is that a convex function (here 
\begin_inset Formula $\mbox{max}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

) maintains its convexity when squared.
 So given that 
\begin_inset Formula $g\left(\mathbf{\tilde{\mathbf{w}}}\right)=\mbox{max}\left(0,\,1+\mathbf{c}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

 is convex we want to prove that 
\begin_inset Formula $g^{2}\left(\mathbf{\tilde{\mathbf{w}}}\right)$
\end_inset

 is convex as well.
 From the zeroth order definition of convexity for 
\begin_inset Formula $g$
\end_inset

 we know that
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(\lambda\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\lambda g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Squaring both sides gives 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
g^{2}\left(\lambda\mathbf{\tilde{\mathbf{w}}}_{1}+\left(1-\lambda\right)\mathbf{\tilde{\mathbf{w}}}_{2}\right)\leq\left(\lambda g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\lambda^{2}g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)^{2}g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)+2\lambda\left(1-\lambda\right)g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\lambda g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)-\lambda\left(1-\lambda\right)\left(g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)-g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\leq\lambda g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)+\left(1-\lambda\right)g^{2}\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)-\lambda\left(1-\lambda\right)\left(g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)-g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where the last inequality holds since 
\begin_inset Formula $\lambda\left(1-\lambda\right)\left(g\left(\mathbf{\tilde{\mathbf{w}}}_{1}\right)-g\left(\mathbf{\tilde{\mathbf{w}}}_{2}\right)\right)^{2}\geq0$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See part b) of Exercise 4.1.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.7
\end_layout

\begin_layout Standard
a) Adopting the familiar compact notation, the squared margin cost is given
 by 
\begin_inset Formula $g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\mbox{max}^{2}\left(0,\,1-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

.
 The partial derivative of the cost with respect to the 
\begin_inset Formula $i$
\end_inset

 th entry in 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can then be computed as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(1-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{x}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The full gradient therefore can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g=-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{x}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.8
\end_layout

\begin_layout Standard
See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.9
\end_layout

\begin_layout Standard
See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.10
\end_layout

\begin_layout Standard
See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.11
\end_layout

\begin_layout Standard
a) For the 
\begin_inset Formula $p$
\end_inset

 th data point we want the following approximation to hold
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\textrm{tanh}\left(y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)\approx1.\label{eq:tanh-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Using the definition of 
\begin_inset Formula $\textrm{tanh}\left(\cdot\right)$
\end_inset

, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:tanh-2"

\end_inset

) can be written as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mbox{tanh}\left(y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)=2\sigma\left(y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)-1\approx1,\label{eq:tanh}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1}{1+e^{-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}}\approx1.\label{eq:tanh-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:tanh-1"

\end_inset

) to hold, we must have the following for all 
\begin_inset Formula $p=1\ldots P$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
e^{-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}\approx0.\label{eq:tanh-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the sum over all data points, we get the desired cost function as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
h_{2}\left(b,\mathbf{w}\right)=\underset{p=1}{\overset{P}{\sum}}e^{-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}.\label{eq:tanh-1-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Denote by 
\begin_inset Formula $\alpha$
\end_inset

 the value of 
\begin_inset Formula $-y\left(b^{\star}+\mathbf{x}^{T}\mathbf{w}^{\star}\right)$
\end_inset

 evaluated at the outlier.
 With 
\begin_inset Formula $h_{2}$
\end_inset

 the outlier penalizes 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
the cost function by 
\begin_inset Formula $e^{\alpha}$
\end_inset

, which is very large considering 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
that 
\begin_inset Formula $\alpha$
\end_inset

 is a rather large positive value itself.
 In fact 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $e^{\alpha}$
\end_inset

 will greatly dominate every other error term introduced by other data points.
 In order to ameliorate the 
\family default
\series default
\shape italic
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
exponentially
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 large contribution of the outlier to the cost function, the classifier
 then has to move closer to the outlier at the expense of misclassifying
 two other data points.
 This however does not happen when using 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $h_{1}$
\end_inset

 since the log function suppresses this undesired effect of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $e^{\left(\cdot\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.12
\end_layout

\begin_layout Standard
We show that the 
\begin_inset Formula $p$
\end_inset

 th summands in 
\begin_inset Formula $g\left(b,\mathbf{w}\right)$
\end_inset

 and 
\begin_inset Formula $h\left(b,\mathbf{w}\right)$
\end_inset

 are identical.
 Consider the following cases:
\end_layout

\begin_layout Standard
Case 1.
 
\begin_inset Formula $y_{p}=+1$
\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Formula $p$
\end_inset

 th summand in 
\begin_inset Formula $g\left(b,\mathbf{w}\right)$
\end_inset

 is given by 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mbox{log}\left(1+e^{-\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}\right).\label{eq:1_1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
With 
\begin_inset Formula $y_{p}=+1$
\end_inset

, we have 
\begin_inset Formula $\bar{y}_{p}=+1$
\end_inset

 and the 
\begin_inset Formula $p$
\end_inset

 th summand of 
\begin_inset Formula $h\left(b,\mathbf{w}\right)$
\end_inset

 can be written as 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $-\bar{y}_{p}^{\,}\mbox{log}\,\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)-(1-\bar{y}_{p}^{\,})\mbox{log}\left(1-\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)$
\end_inset

,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 or equivalently 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
-\mbox{log}\,\,\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right).\label{eq:1_2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Writing 
\begin_inset Formula $\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)$
\end_inset

 as 
\begin_inset Formula $\frac{1}{1+e^{-\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}}$
\end_inset

 , it is clear that the expressions in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1_1"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1_2"

\end_inset

) are identical.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
Case 2.
 
\begin_inset Formula $y_{p}=-1$
\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Formula $p$
\end_inset

 th summand in 
\begin_inset Formula $g\left(b,\mathbf{w}\right)$
\end_inset

 is given by
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mbox{log}\left(1+e^{\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}\right).\label{eq:1_1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
With 
\begin_inset Formula $y_{p}=-1$
\end_inset

, we have 
\begin_inset Formula $\bar{y}_{p}=0$
\end_inset

 and the 
\begin_inset Formula $p$
\end_inset

 th summand of 
\begin_inset Formula $h\left(b,\mathbf{w}\right)$
\end_inset

 can be written as 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $-\bar{y}_{p}^{\,}\mbox{log}\,\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)-(1-\bar{y}_{p}^{\,})\mbox{log}\left(1-\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right)$
\end_inset

,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 or equivalently 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
-\mbox{log}\,\,\left(1-\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)\right).\label{eq:1_2-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now note that 
\begin_inset Formula $1-\sigma\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)=\frac{e^{-\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}}{1+e^{-\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}}=\frac{1}{1+e^{\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}}$
\end_inset

.
 Hence, the expressions in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1_1-1"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1_2-1"

\end_inset

) are indeed identical.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.13
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.14
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.15
\end_layout

\begin_layout Standard
a) Here we compute the gradient of the 
\begin_inset Formula $k$
\end_inset

 th classifier 
\begin_inset Formula $\tilde{\mathbf{w}}_{k}$
\end_inset

 from the softmax multiclass cost function
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g=\underset{c=1}{\overset{C}{\sum}}\underset{p\in\Omega_{c}}{\sum}\text{log}\left(\underset{j=1}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{c}\right)}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since this is a sum over all of the 
\begin_inset Formula $P$
\end_inset

 points we can compute its gradient by computing the gradient per point
 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}$
\end_inset

 and then summing the results.
 So we compute the gradient for an individual summand corresponding to an
 arbitrray point 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}$
\end_inset

.
 We can do this in two cases, combining the results afterwards.
 
\end_layout

\begin_layout Standard
Suppose first that this point first is in class 
\begin_inset Formula $k$
\end_inset

.
 All that remains from the original cost function above is then just 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\text{log}\left(1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Using the chain rule and elementary calculus rules for taking the derivative
 of 
\begin_inset Formula $\text{log}\left(\cdot\right)$
\end_inset

 and 
\begin_inset Formula $e^{\left(\cdot\right)}$
\end_inset

 the gradient of this is then given as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\frac{-\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}\tilde{\mathbf{x}}_{p}}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Adding and subtracing 1 in the numerator of this fraction allows us to rewrite
 the above as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1-\left(1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}\right)}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}\tilde{\mathbf{x}}_{p}=\left(\frac{1}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}-1\right)\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now suppose 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}$
\end_inset

 is not in class 
\begin_inset Formula $k$
\end_inset

 but some class 
\begin_inset Formula $c\neq k$
\end_inset

.
 Then we have that what falls out from the original cost function - with
 respect to 
\begin_inset Formula $\tilde{\mathbf{w}}_{k}$
\end_inset

 - is just 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\text{log}\left(\underset{j=1}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{c}\right)}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The gradient of this summation with respect to 
\begin_inset Formula $\tilde{\mathbf{w}}_{k}$
\end_inset

 can then be computed once again using the chain rule and elementary calculus
 rules for taking the derivative of 
\begin_inset Formula $\text{log}\left(\cdot\right)$
\end_inset

 and 
\begin_inset Formula $e^{\left(\cdot\right)}$
\end_inset

 as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\text{log}\left(1+\underset{\underset{j\neq c}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{c}\right)}\right),
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and the resulting gradient is then 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{e^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{k}-\tilde{\mathbf{w}}_{c}\right)}\tilde{\mathbf{x}}_{p}}{1+\underset{\underset{j\neq c}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{c}\right)}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Multiplying the top and bottom of this fraction by 
\begin_inset Formula $e^{-\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{k}-\tilde{\mathbf{w}}_{c}\right)}$
\end_inset

 then gives 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1}{e^{-\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{k}-\tilde{\mathbf{w}}_{c}\right)}\left(1+\underset{\underset{j\neq c}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{c}\right)}\right)}\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now using the exponential rule 
\begin_inset Formula $e^{a}e^{b}=e^{a+b}$
\end_inset

 we can simplify the denominator of the fraction above to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
e^{-\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{k}-\tilde{\mathbf{w}}_{c}\right)}+\underset{\underset{j\neq c}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}=1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This means that the fraction itself can then be written equivalently as
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\frac{1}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}\right)\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Together then, we can write the gradient of the multiclass softmax cost
 over one point 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}$
\end_inset

 as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\frac{1}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}-1_{p\in\Omega_{k}}\right)\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This means that over all points the full gradient with respect to 
\begin_inset Formula $\tilde{\mathbf{w}}_{k}$
\end_inset

 then becomes 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g\left(\tilde{\mathbf{w}}_{k}\right)=\underset{p=1}{\overset{P}{\sum}}\left(\frac{1}{1+\underset{\underset{j\neq k}{j=1}}{\overset{C}{\sum}}e{}^{\tilde{\mathbf{x}}_{p}^{T}\left(\tilde{\mathbf{w}}_{j}-\tilde{\mathbf{w}}_{k}\right)}}-1_{p\in\Omega_{k}}\right)\tilde{\mathbf{x}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.16
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.17
\end_layout

\begin_layout Standard
With 
\begin_inset Formula $C=2$
\end_inset

 the multiclass softmax cost 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\underset{c=1}{\overset{C}{\sum}}\underset{p\in\Omega_{c}}{\sum}\mbox{log}\left(1+\underset{\underset{j\neq c}{j=1}}{\overset{C}{\sum}}e^{\left(b_{j}^{\,}-b_{c}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{j}^{\,}-\mathbf{w}_{c}^{\,}\right)}\right),\label{eq:multiclass-softmax-common}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
reduces to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\underset{p\in\Omega_{1}}{\sum}\mbox{log}\left(1+e^{\left(b_{2}^{\,}-b_{1}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{2}^{\,}-\mathbf{w}_{1}^{\,}\right)}\right)+\underset{p\in\Omega_{2}}{\sum}\mbox{log}\left(1+e^{\left(b_{1}^{\,}-b_{2}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{1}^{\,}-\mathbf{w}_{2}^{\,}\right)}\right).\label{eq:multiclass-softmax-common-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now note that because we have that 
\begin_inset Formula $y_{p}=\left\{ \begin{array}{cc}
-1 & p\in\Omega_{1}\\
+1 & p\in\Omega_{2}
\end{array}\right.$
\end_inset

, the cost in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:multiclass-softmax-common-1"

\end_inset

) can be written equivalently as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\underset{p\in\Omega_{1}}{\sum}\mbox{log}\left(1+e^{-y_{p}\left(\left(b_{2}^{\,}-b_{1}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{2}^{\,}-\mathbf{w}_{1}^{\,}\right)\right)}\right)+\underset{p\in\Omega_{2}}{\sum}\mbox{log}\left(1+e^{-y_{p}\left(\left(b_{2}^{\,}-b_{1}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{2}^{\,}-\mathbf{w}_{1}^{\,}\right)\right)}\right),\label{eq:multiclass-softmax-common-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which can then be written in a more compact form as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{-y_{p}\left(\left(b_{2}^{\,}-b_{1}^{\,}\right)+\mathbf{x}_{p}^{T}\left(\mathbf{w}_{2}^{\,}-\mathbf{w}_{1}^{\,}\right)\right)}\right).\label{eq:multiclass-softmax-common-1-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally letting 
\begin_inset Formula $b=b_{2}-b_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}=\mathbf{w}_{2}^{\,}-\mathbf{w}_{1}^{\,}$
\end_inset

, we arrive at the familiar two-class softmax cost function 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{-y_{p}\left(b+\mathbf{x}_{p}^{T}\mathbf{w}\right)}\right).\label{eq:multiclass-softmax-common-1-1-1-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.18
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.19
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.20
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 4.21
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 5.
 Automatic feature design for regression
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.1
\end_layout

\begin_layout Standard
Note that by concatenating 
\begin_inset Formula $w_{m}$
\end_inset

's into the column vector 
\begin_inset Formula $\mathbf{w}$
\end_inset

, and 
\begin_inset Formula $\mathbf{x}_{m}$
\end_inset

's into the columns of matrix 
\begin_inset Formula $\mathbf{X}$
\end_inset

, the objective function can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(\mathbf{w}\right)=\left\Vert \mathbf{X}\mathbf{w}-\mathbf{y}\right\Vert _{2}^{2}=\left(\mathbf{X}\mathbf{w}-\mathbf{y}\right)^{T}\left(\mathbf{X}\mathbf{w}-\mathbf{y}\right)=\mathbf{w}^{T}\mathbf{X}^{T}\mathbf{X}\mathbf{w}-2\mathbf{y}^{T}\mathbf{X}\mathbf{w}+\mathbf{y}^{T}\mathbf{y}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Setting the gradient to zero, we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g=2\mathbf{X}^{T}\mathbf{X}\mathbf{w}-2\mathbf{X}^{T}\mathbf{y}=\mathbf{0},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which gives the linear system 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{X}^{T}\mathbf{X}\mathbf{w}=\mathbf{X}^{T}\mathbf{y},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
to be solved for 
\begin_inset Formula $\mathbf{w}$
\end_inset

.
 Now because 
\begin_inset Formula $\mathbf{X}^{T}\mathbf{X}=S\mathbf{I}_{M\times M}$
\end_inset

, this system reduces to
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{w}=\frac{1}{S}\mathbf{X}^{T}\mathbf{y},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In other words, we have 
\begin_inset Formula $w_{j}=\frac{1}{S}\mathbf{x}_{j}^{T}\mathbf{y}$
\end_inset

 for all 
\begin_inset Formula $j$
\end_inset

.
 Note that orthogonality in this case removes the need for solving a general
 linear system of equations through elimination, matrix inversion or other
 methods.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.2
\end_layout

\begin_layout Standard
Taking the derivative of the objective in 
\begin_inset Formula $w_{j}$
\end_inset

 we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial w_{j}}\int_{0}^{1}\left(\underset{m=0}{\overset{\infty}{\sum}}f_{m}\left(x\right)w_{m}-y\left(x\right)\right)^{2}dx=2\int_{0}^{1}f_{j}\left(x\right)\left(\underset{m=0}{\overset{\infty}{\sum}}f_{m}\left(x\right)w_{m}-y\left(x\right)\right)dx=0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This is equivalently written as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\underset{m=0}{\overset{\infty}{\sum}}\left(\int_{0}^{1}f_{j}\left(x\right)f_{m}\left(x\right)dx\right)w_{m}=\int_{0}^{1}f_{j}\left(x\right)y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By orthogonality of the basis functions, this reduces to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\left(\int_{0}^{1}f_{j}\left(x\right)f_{j}\left(x\right)dx\right)w_{j}=\int_{0}^{1}f_{j}\left(x\right)y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
giving
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
w_{j}=\frac{1}{S}\int_{0}^{1}f_{j}\left(x\right)y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.3
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Setting the derivative of the objective in 
\begin_inset Formula $w_{0}$
\end_inset

 gives 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
2\int_{0}^{1}\left(w_{0}+\underset{k=1}{\overset{K}{\sum}}\left(w_{2k-1}\mbox{sin}\left(2\pi kx\right)+w_{2k}\mbox{cos}\left(2\pi kx\right)\right)-y\left(x\right)\right)dx=0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $\int_{0}^{1}\mbox{sin}\left(2\pi kx\right)dx=0$
\end_inset

 and 
\begin_inset Formula $\int_{0}^{1}\mbox{cos}\left(2\pi kx\right)dx=0$
\end_inset

 for all 
\begin_inset Formula $k\geq1$
\end_inset

 solving for 
\begin_inset Formula $w_{0}$
\end_inset

 in the above gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
w_{0}=\int_{0}^{1}y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Next, setting the derivative of the objective in 
\begin_inset Formula $w_{2j-1}$
\end_inset

 to zero gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
2\int_{0}^{1}\mbox{sin}\left(2\pi jx\right)\left(w_{0}+\underset{k=1}{\overset{K}{\sum}}\left(w_{2k-1}\mbox{sin}\left(2\pi kx\right)+w_{2k}\mbox{cos}\left(2\pi kx\right)\right)-y\left(x\right)\right)dx=0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
With the orthogonality conditions stated in the problem this reduces to
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
w_{2j-1}\int_{0}^{1}\mbox{sin}^{2}\left(2\pi jx\right)dx-\int_{0}^{1}\mbox{sin}\left(2\pi jx\right)y\left(x\right)dx=0,
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which is equivalently
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
w_{2j-1}=2\int_{0}^{1}\mbox{sin}\left(2\pi jx\right)y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, setting the derivative in 
\begin_inset Formula $w_{2j}$
\end_inset

 to zero, and following the same reasoning, it easily follows that 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
w_{2j}=2\int_{0}^{1}\mbox{cos}\left(2\pi jx\right)y\left(x\right)dx.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.4
\end_layout

\begin_layout Standard
Taking the partial derivative of the Least Squares cost 
\begin_inset Formula $\int_{0}^{1}\left(\underset{m=0}{\overset{D}{\sum}}x^{m}w_{m}-y\left(x\right)\right)^{2}dx$
\end_inset

 with respect to 
\begin_inset Formula $w_{j}$
\end_inset

, we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\frac{\partial}{\partial w_{j}}\int_{0}^{1}\left(\underset{m=0}{\overset{D}{\sum}}x^{m}w_{m}-y\left(x\right)\right)^{2}dx=\int_{0}^{1}\frac{\partial}{\partial w_{j}}\left(\underset{m=0}{\overset{D}{\sum}}x^{m}w_{m}-y\left(x\right)\right)^{2}dx\\
=\int_{0}^{1}2\left(\underset{m=0}{\overset{D}{\sum}}x^{m}w_{m}-y\left(x\right)\right)x^{j}dx=2\int_{0}^{1}\left(\underset{m=0}{\overset{D}{\sum}}x^{m+j}w_{m}-y\left(x\right)x^{j}\right)dx\\
=2\int_{0}^{1}\left(\underset{m=0}{\overset{D}{\sum}}x^{m+j}w_{m}\right)dx-2\int_{0}^{1}y\left(x\right)x^{j}dx\\
=2\underset{m=0}{\overset{D}{\sum}}\left(\int_{0}^{1}x^{m+j}dx\right)w_{m}-2\int_{0}^{1}y\left(x\right)x^{j}dx.
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Setting the above to zero for 
\begin_inset Formula $j=0,\ldots,D$
\end_inset

 we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\underset{m=0}{\overset{D}{\sum}}\left(\int_{0}^{1}x^{m+j}dx\right)w_{m}=\int_{0}^{1}y\left(x\right)x^{j}dx\qquad\textrm{for all }j.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Noting that 
\begin_inset Formula $\int_{0}^{1}x^{m+j}dx=\frac{1}{m+j+1}$
\end_inset

, we can write the linear system of 
\begin_inset Formula $D+1$
\end_inset

 equations above as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\mathbf{P}\mathbf{w}=\mathbf{d},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\mathbf{w}=\left[\begin{array}{cccc}
w_{0} & w_{1} & \ldots & w_{D}\end{array}\right]^{T}$
\end_inset

, 
\begin_inset Formula $P_{m,j}=\frac{1}{m+j+1}$
\end_inset

 (
\begin_inset Formula $0\leq m,j\leq D$
\end_inset

), and 
\begin_inset Formula $h_{j}=\int_{0}^{1}y\left(x\right)x^{j}dx$
\end_inset

 (
\begin_inset Formula $0\leq j\leq D$
\end_inset

).
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\mathbf{P}=\left[\begin{array}{ccccc}
1 & \nicefrac{1}{2} & \nicefrac{1}{3} & \cdots & \nicefrac{1}{D+1}\\
\nicefrac{1}{2} & \nicefrac{1}{3} & \nicefrac{1}{4} & \cdots & \nicefrac{1}{D+2}\\
\nicefrac{1}{3} & \nicefrac{1}{4} & \nicefrac{1}{5} & \cdots & \nicefrac{1}{D+3}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
\nicefrac{1}{D+1} & \nicefrac{1}{D+2} & \nicefrac{1}{D+3} & \cdots & \nicefrac{1}{2D+1}
\end{array}\right],
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left[\begin{array}{c}
\int_{0}^{1}y\left(x\right)dx\\
\int_{0}^{1}y\left(x\right)xdx\\
\int_{0}^{1}y\left(x\right)x^{2}dx\\
\vdots\\
\int_{0}^{1}y\left(x\right)x^{D}dx
\end{array}\right].
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.5
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
w_{0}+\underset{m=1}{\overset{M}{\sum}}\mbox{cos}\left(2\pi mx\right)w_{2m-1}+\mbox{sin}\left(2\pi mx\right)w_{2m}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=w_{0}+\underset{m=1}{\overset{M}{\sum}}\frac{1}{2}\left(e^{2\pi imx}+e^{-2\pi imx}\right)w_{2m-1}+\frac{1}{2i}\left(e^{2\pi imx}-e^{-2\pi imx}\right)w_{2m}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=w_{0}+\underset{m=1}{\overset{M}{\sum}}\frac{1}{2}\left(w_{2m-1}-iw_{2m}\right)e^{2\pi imx}+\frac{1}{2}\left(w_{2m-1}+iw_{2m}\right)e^{-2\pi imx}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=w_{0}+\underset{m=1}{\overset{M}{\sum}}\frac{1}{2}\left(w_{2m-1}-iw_{2m}\right)e^{2\pi imx}+\underset{m=1}{\overset{M}{\sum}}\frac{1}{2}\left(w_{2m-1}+iw_{2m}\right)e^{-2\pi imx}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=w_{0}+\underset{m=1}{\overset{M}{\sum}}\frac{1}{2}\left(w_{2m-1}-iw_{2m}\right)e^{2\pi imx}+\underset{m=-1}{\overset{-M}{\sum}}\frac{1}{2}\left(w_{1-2m}+iw_{-2m}\right)e^{2\pi imx}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=w'_{0}e^{2\pi i0}+\underset{m=1}{\overset{M}{\sum}}w'_{m}e^{2\pi imx}+\underset{m=-1}{\overset{-M}{\sum}}w'_{m}e^{2\pi imx}=\underset{m=-M}{\overset{M}{\sum}}w'_{m}e^{2\pi imx}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.6
\end_layout

\begin_layout Standard
a) As shown pictorially in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:extended-1-2"

\end_inset

, with a 
\begin_inset Formula $3$
\end_inset

-hidden layer neural network basis approximation we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
Q=\left(N+1\right)M_{3}+\left(M_{3}+1\right)M_{2}+\left(M_{2}+1\right)M+M+1.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename Figures/5.6.tif
	lyxscale 30
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:extended-1-2"

\end_inset

 Calculating the total number of weights in a three hidden-layer feedforward
 neural network.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In general, defining 
\begin_inset Formula $M_{0}=1$
\end_inset

, 
\begin_inset Formula $M_{1}=M$
\end_inset

, and 
\begin_inset Formula $M_{L+1}=N$
\end_inset

, the total number of parameters in a fully-connected feedforward neural
 network with 
\begin_inset Formula $L$
\end_inset

 hidden layers can be written as 
\begin_inset Formula $Q=\underset{k=1}{\overset{L+1}{\sum}}\left(M_{k}+1\right)M_{k-1}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) According to part a), 
\begin_inset Formula $Q$
\end_inset

 can be written as 
\begin_inset Formula $Q=N\cdot M_{L}+\left(M_{L}+\underset{k=1}{\overset{L}{\sum}}\left(M_{k}+1\right)M_{k-1}\right)$
\end_inset

, where the expression inside the parantheses is constant with respect to
 
\begin_inset Formula $N$
\end_inset

.
 Note that 
\begin_inset Formula $Q$
\end_inset

 is independent of the number of data points 
\begin_inset Formula $P$
\end_inset

.
 As we will see in Chapter 7, this is not the case with kernel methods (used
 for fixed basis regression) in which case 
\begin_inset Formula $Q$
\end_inset

 depends on 
\begin_inset Formula $P$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.7
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.8
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.9
\end_layout

\begin_layout Standard
a) 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
The Least Squares cost function is given by
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g=\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $b$
\end_inset

 gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial b}g=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial b}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $w_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial w_{n}}g=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial w_{n}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)a\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $c_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial c_{n}}g=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial c_{n}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial c_{n}}\left(a\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)a^{\prime}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to the 
\begin_inset Formula $j$
\end_inset

 th entry in 
\begin_inset Formula $\mathbf{v}_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial v_{n,j}}g=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial v_{n,j}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\right)
\]

\end_inset


\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\left(2\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)\frac{\partial}{\partial v_{n,j}}\left(a\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}\right)\right)
\]

\end_inset


\begin_inset Formula 
\[
=2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)a^{\prime}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}\frac{\partial}{\partial v_{n,j}}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)
\]

\end_inset


\begin_inset Formula 
\begin{equation}
=2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)a^{\prime}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}x_{p,j}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Therefore the full gradient with respect to 
\begin_inset Formula $\mathbf{v}_{n}$
\end_inset

 can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
2\underset{p=1}{\overset{P}{\sum}}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}-y_{p}\right)a^{\prime}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}\mathbf{x}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.10
\end_layout

\begin_layout Standard
Eric should choose 
\begin_inset Formula $D=5$
\end_inset

 as it produces minimal testing error.
\end_layout

\begin_layout Standard
Stanley could choose either 
\begin_inset Formula $D=3$
\end_inset

 or 
\begin_inset Formula $D=8$
\end_inset

 but 
\begin_inset Formula $D=3$
\end_inset

 produces a simpler model (Occam's razor).
\end_layout

\begin_layout Standard
Even though Kyle could choose 
\begin_inset Formula $D=10$
\end_inset

, the decreasing trend in both the training and testing error curves suggests
 that we are still in the underfitting zone! So Kyle should try even larger
 values for 
\begin_inset Formula $D$
\end_inset

 until the testing error ceases to decrease or goes back up.
 
\end_layout

\begin_layout Standard
In Kenny's plot, the training error does not consistently go down which
 is indicative of a problem in his implementation.
 Therefore he should look into his implementation for debugging! 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.11
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.12
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 5.13
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 6.
 Automatic feature design for classification
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.1
\end_layout

\begin_layout Standard
a) Using the compact notation the softmax cost can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\mbox{log}\left(1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The partial derivative of the cost with respect to the 
\begin_inset Formula $i$
\end_inset

 th entry in 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can be computed as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial\tilde{w_{i}}}\left(1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}\right)}{1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\frac{\left(e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)}{1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}=-\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}{1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{f}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The full gradient therefore can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\nabla g=-\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}{1+e^{-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{\mathbf{f}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Multiplying both the numerator and denominator of each summand by 
\begin_inset Formula $e^{y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}$
\end_inset

 gives 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\nabla g=-\underset{p=1}{\overset{P}{\sum}}\frac{1}{1+e^{y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}}}y_{p}\tilde{\mathbf{f}}_{p}=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{\mathbf{f}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To find the Hessian, we can write 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial^{2}}{\partial\tilde{w_{j}}\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=-\frac{\partial}{\partial\tilde{w_{j}}}\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{f}_{p,i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=-\underset{p=1}{\overset{P}{\sum}}\frac{\partial}{\partial\tilde{w_{j}}}\left(\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{f}_{p,i}\right)=-\underset{p=1}{\overset{P}{\sum}}\sigma'\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)y_{p}\tilde{f}_{p,i}\frac{\partial}{\partial\tilde{w_{j}}}\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{f}_{p,i}\left(-y_{p}\tilde{f}_{p,j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{f}_{p,i}\tilde{f}_{p,j}y_{p}^{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now note that 
\begin_inset Formula $y_{p}^{2}=1$
\end_inset

 (since 
\begin_inset Formula $y_{p}\in\left\{ -1,+1\right\} $
\end_inset

), and we can write the full Hessian as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\left(1-\sigma\left(-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\tilde{\mathbf{f}}_{p}\tilde{\mathbf{f}}_{p}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) To prove 
\begin_inset Formula $g$
\end_inset

 is convex, we use the second order definition of convexity and show 
\begin_inset Formula $\nabla^{2}g\left(\mathbf{\tilde{w}}\right)$
\end_inset

 is positive semidefinite by forming 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\psi\left(\mathbf{z}\right)=\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{\tilde{w}}\right)\mathbf{z}=\mathbf{z}^{T}\left[\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\left(1-\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\right)\mathbf{\mathbf{\tilde{f}}}_{p}^{\,}\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\right]\mathbf{z}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\delta_{p}\left(\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{z}\right)^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\delta_{p}=\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\left(1-\sigma\left(-y_{p}^{\,}\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{\mathbf{\tilde{w}}}\right)\right)$
\end_inset

.
 Now note that since 
\begin_inset Formula $0\leq\sigma\left(\zeta\right)\leq1$
\end_inset

 we have that 
\begin_inset Formula $\delta_{p}\geq0$
\end_inset

, and therefore 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\mathbf{z}^{T}\nabla^{2}g\left(\mathbf{\tilde{w}}\right)\mathbf{z}=\underset{p=1}{\overset{P}{\sum}}\delta_{p}\left(\mathbf{\mathbf{\tilde{f}}}_{p}^{T}\mathbf{z}\right)^{2}\geq0.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.2
\end_layout

\begin_layout Standard
a) The squared margin cost in this case is given by 
\begin_inset Formula $g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}\mbox{max}^{2}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)$
\end_inset

.
 The partial derivative of the cost with respect to the 
\begin_inset Formula $i$
\end_inset

 th entry in 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 can then be computed as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)\frac{\partial}{\partial\tilde{w_{i}}}\left(1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{f}_{p,i}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The full gradient therefore can be written as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\nabla g=-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{\mathbf{f}}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To find the Hessian, we can write 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial^{2}}{\partial\tilde{w_{j}}\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=\frac{\partial}{\partial\tilde{w_{j}}}\left(-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{f}_{p,i}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\frac{\partial}{\partial\tilde{w_{j}}}\left(-2\overset{P}{\underset{p=1}{\sum}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{f}_{p,i}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=-2\left(\overset{P}{\underset{p=1}{\sum}}\frac{\partial}{\partial\tilde{w_{j}}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)y_{p}\tilde{f}_{p,i}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Note that although the 
\begin_inset Quotes eld
\end_inset

max
\begin_inset Quotes erd
\end_inset

 function is not differentiable, since 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)=\begin{cases}
\begin{array}{c}
1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\\
0
\end{array} & \begin{array}{c}
\textrm{if }1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}>0\\
\textrm{else},
\end{array}\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
we may generalize the gradient definition and write 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{w_{j}}}\left(\mbox{max}\left(0,\,1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\right)=\begin{cases}
\begin{array}{c}
\frac{\partial}{\partial\tilde{w_{j}}}\left(1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)\\
0
\end{array} & \begin{array}{c}
\textrm{if }1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}>0\\
\textrm{else}.
\end{array}\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
Denoting 
\begin_inset Formula $\Omega_{\tilde{\mathbf{w}}}=\left\{ p|1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right\} $
\end_inset

 and noting that 
\begin_inset Formula $\frac{\partial}{\partial\tilde{w_{j}}}\left(1-y_{p}\tilde{\mathbf{f}}_{p}^{T}\tilde{\mathbf{w}}\right)=-y_{p}\tilde{f}_{p,j}$
\end_inset

, the generalized Hessian can be written entry-wise as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\frac{\partial^{2}}{\partial\tilde{w_{j}}\partial\tilde{w_{i}}}g\left(\tilde{\mathbf{w}}\right)=-2\left(\overset{}{\underset{p\in\Omega_{\tilde{\mathbf{w}}}}{\sum}}-y_{p}^{2}\tilde{f}_{p,i}\tilde{f}_{p,j}\right),
\]

\end_inset


\end_layout

\begin_layout Standard
and the Hessian matrix as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\[
\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=2\overset{}{\underset{p\in\Omega_{\tilde{\mathbf{w}}}}{\sum}}\tilde{\mathbf{f}}_{p}\tilde{\mathbf{f}}_{p}^{T},
\]

\end_inset


\end_layout

\begin_layout Standard
since 
\begin_inset Formula $y_{p}^{2}=1$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) See Exercises 4.1 and 4.6.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.3
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.4
\end_layout

\begin_layout Standard
a) 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
The softmax cost in this case is given by
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
g=\underset{p=1}{\overset{P}{\sum}}\textrm{log}\left(1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $b$
\end_inset

 gives
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial}{\partial b}g=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial b}\left(1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\frac{\partial}{\partial b}\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=\underset{p=1}{\overset{P}{\sum}}\frac{-e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}y_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Noting that 
\begin_inset Formula $\sigma\left(\zeta\right)=\frac{e^{\zeta}}{1+e^{\zeta}}$
\end_inset

, we can write
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial b}g=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)y_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $w_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial}{\partial w_{n}}g=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial w_{n}}\left(1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\frac{\partial}{\partial w_{n}}\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}\left(-y_{p}a\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)a\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)y_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $c_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial}{\partial c_{n}}g=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial c_{n}}\left(1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\frac{\partial}{\partial c_{n}}\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}\left(-y_{p}w_{n}a'\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)\frac{\partial}{\partial c_{n}}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)a'\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}y_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Taking the partial derivative of 
\begin_inset Formula $g$
\end_inset

 with respect to the 
\begin_inset Formula $j$
\end_inset

 th entry in 
\begin_inset Formula $\mathbf{v}_{n}$
\end_inset

 gives (
\begin_inset Formula $1\leq n\leq M$
\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\[
\frac{\partial}{\partial v_{n,j}}g=\underset{p=1}{\overset{P}{\sum}}\frac{\frac{\partial}{\partial v_{n,j}}\left(1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}\frac{\partial}{\partial v_{n,j}}\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\underset{p=1}{\overset{P}{\sum}}\frac{e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}{1+e^{-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)}}\left(-y_{p}w_{n}a'\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)\frac{\partial}{\partial v_{n,j}}\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)a'\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}y_{p}x_{p,j}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Therefore the full gradient with respect to 
\begin_inset Formula $\mathbf{v}_{n}$
\end_inset

 can be written as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
-\underset{p=1}{\overset{P}{\sum}}\sigma\left(-y_{p}\left(b+\underset{m=1}{\overset{M}{\sum}}a\left(c_{m}+\mathbf{x}_{p}^{T}\mathbf{v}_{m}\right)w_{m}\right)\right)a'\left(c_{n}+\mathbf{x}_{p}^{T}\mathbf{v}_{n}\right)w_{n}y_{p}\mathbf{x}_{p}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.5
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.6
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.7
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.8
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 6.9
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 8.
 Advanced gradient schemes
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 8.1
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 8.2
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 8.3
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 8.4
\end_layout

\begin_layout Standard
\begin_inset Formula $f$
\end_inset

 has Lipschitz continuous gradient with constant 
\begin_inset Formula $J$
\end_inset

, and 
\begin_inset Formula $g$
\end_inset

 is Lipschitz continuous with constant 
\begin_inset Formula $K$
\end_inset

, so we can write for all 
\begin_inset Formula $\mathbf{x}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}$
\end_inset

 in the domain of 
\begin_inset Formula $g$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\left\Vert \nabla f\left(g\left(\mathbf{x}\right)\right)-\nabla f\left(g\left(\mathbf{y}\right)\right)\right\Vert _{2}\leq J\left\Vert g\left(\mathbf{x}\right)-g\left(\mathbf{y}\right)\right\Vert _{2}\leq JK\left\Vert \mathbf{x}-\mathbf{y}\right\Vert _{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Therefore, 
\begin_inset Formula $f\left(g\right)$
\end_inset

 has Lipschitz continuous gradient with constant 
\begin_inset Formula $JK$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 8.5
\end_layout

\begin_layout Standard
a) The maximum eigenvalue of a matrix 
\begin_inset Formula $\mathbf{A}$
\end_inset

 can be found, using the Rayleigh quotient, as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\underset{\mathbf{x}}{\textrm{max}}\;\frac{\mathbf{x}^{T}\mathbf{A}\mathbf{x}}{\mathbf{x}^{T}\mathbf{x}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Plugging in 
\begin_inset Formula $\mathbf{A}=\mathbf{a}\mathbf{a}^{T}$
\end_inset

, we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\frac{\mathbf{x}^{T}\mathbf{a}\mathbf{a}^{T}\mathbf{x}}{\mathbf{x}^{T}\mathbf{x}}=\frac{\left(\mathbf{x}^{T}\mathbf{a}\right)\left(\mathbf{a}^{T}\mathbf{x}\right)}{\mathbf{x}^{T}\mathbf{x}}=\frac{\left(\mathbf{x}^{T}\mathbf{a}\right)^{2}}{\left\Vert \mathbf{x}\right\Vert _{2}^{2}}=\frac{\left(\left\Vert \mathbf{x}\right\Vert _{2}\left\Vert \mathbf{a}\right\Vert _{2}\textrm{cos}\left(\theta_{\mathbf{a}}\right)\right)^{2}}{\left\Vert \mathbf{x}\right\Vert _{2}^{2}}=\left\Vert \mathbf{a}\right\Vert _{2}^{2}\textrm{cos}^{2}\left(\theta_{\mathbf{a}}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\theta_{\mathbf{a}}$
\end_inset

 is the angle between 
\begin_inset Formula $\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}$
\end_inset

.
 Using a similar argument for 
\begin_inset Formula $\mathbf{a}\mathbf{a}^{T}+\mathbf{b}\mathbf{b}^{T}$
\end_inset

 we have
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\frac{\mathbf{x}^{T}\left(\mathbf{a}\mathbf{a}^{T}+\mathbf{b}\mathbf{b}^{T}\right)\mathbf{x}}{\mathbf{x}^{T}\mathbf{x}}=\frac{\left(\mathbf{x}^{T}\mathbf{a}\mathbf{a}^{T}\mathbf{x}\right)+\left(\mathbf{x}^{T}\mathbf{b}\mathbf{b}^{T}\mathbf{x}\right)}{\mathbf{x}^{T}\mathbf{x}}=\left\Vert \mathbf{a}\right\Vert _{2}^{2}\textrm{cos}^{2}\left(\theta_{\mathbf{a}}\right)+\left\Vert \mathbf{b}\right\Vert _{2}^{2}\textrm{cos}^{2}\left(\theta_{\mathbf{b}}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and hence the maximum eigenvalue of 
\begin_inset Formula $\mathbf{a}\mathbf{a}^{T}$
\end_inset

 (i.e., 
\begin_inset Formula $\left\Vert \mathbf{a}\right\Vert _{2}^{2}$
\end_inset

) is always smaller than or equal to that of 
\begin_inset Formula $\mathbf{a}\mathbf{a}^{T}+\mathbf{b}\mathbf{b}^{T}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) Writing the Hessian of the soft margin SVM cost function as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=2\underset{p\in\Omega_{\tilde{\mathbf{w}}}}{\sum}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
we have using part a) then since each outer product matrix 
\begin_inset Formula $\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}$
\end_inset

 has nonnegative eigenvalues that the maximum eigenvalue of the Hessian
 is bounded above by the maximum eigenvalue of the sum of all 
\begin_inset Formula $p$
\end_inset

 points / outer product matrices.
 In other words that
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\underset{p\in\Omega_{\tilde{\mathbf{w}}}}{\sum}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}\preceq\underset{p=1}{\overset{P}{\sum}}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The form of the Lipschitz constant in Example 8.8 then follows from this.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c)
\end_layout

\begin_layout Standard
Starting with the form of the Hessian given in Example 8.7, 
\begin_inset Formula $\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\tilde{\mathbf{X}}\text{diag}\left(\mathbf{r}\right)\tilde{\mathbf{X}}^{T}$
\end_inset

, note that this can be written as a sum of outer product matrices as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\nabla^{2}g\left(\tilde{\mathbf{w}}\right)=\underset{p=1}{\overset{P}{\sum}}r_{p}^{\,}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By definition the largest value possible for 
\begin_inset Formula $r_{p}$
\end_inset

 is 
\begin_inset Formula $\frac{1}{4}$
\end_inset

.
 Then we have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\underset{p=1}{\overset{P}{\sum}}r_{p}^{\,}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}\preceq\frac{1}{4}\underset{p=1}{\overset{P}{\sum}}\tilde{\mathbf{x}}_{p}^{\,}\tilde{\mathbf{x}}_{p}^{T}=\frac{1}{4}\tilde{\mathbf{X}}\tilde{\mathbf{X}}^{T},
\end{equation}

\end_inset

and the form of the Lipschitz constant follows from this.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size larger
Chapter 9.
 Dimension reduction techniques
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 9.1
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 9.2
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 9.3
\end_layout

\begin_layout Standard
a) Let us assume that the 
\begin_inset Formula $N\times N$
\end_inset

 symmetric positive semi-definite matrix 
\begin_inset Formula $\mathbf{X}\mathbf{X}^{T}$
\end_inset

 has eigenvalues 
\begin_inset Formula $\lambda_{1}\geq\lambda_{2}\geq\cdot\cdot\cdot\geq\lambda_{N}\geq0$
\end_inset

 and corresponding eigenvectors 
\begin_inset Formula $\mathbf{a}_{1}...\mathbf{a}_{N}$
\end_inset

, with an eigen-decomposition 
\begin_inset Formula $\mathbf{X}\mathbf{X}^{T}=\mathbf{A}\boldsymbol{\Lambda}\mathbf{A}^{T}$
\end_inset

, where 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is an orthonormal basis whose columns are the eigenvectors and 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 is a diagonal matrix with the corresponding eigenvalues along its diagonal.
 So we can write
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{d}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{d}=\mathbf{d}^{T}\mathbf{A}\boldsymbol{\Lambda}\mathbf{A}^{T}\mathbf{d}=\mathbf{s}^{T}\boldsymbol{\Lambda}\mathbf{s},
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}=\mathbf{A}^{T}\mathbf{d}$
\end_inset

.
 Therefore
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{d}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{d}=\stackrel[n=1]{N}{\sum}\lambda_{n}r_{n}^{2}\leq\stackrel[n=1]{N}{\sum}\lambda_{1}r_{n}^{2}=\lambda_{1}\Vert\mathbf{r}\Vert_{2}^{2}=\lambda_{1}\mathbf{d}^{T}\mathbf{A}\mathbf{A}^{T}\mathbf{d}=\lambda_{1}\mathbf{d}^{T}\mathbf{d}=\lambda_{1},\label{eq:master}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where we use the fact that 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is an orthonormal basis and 
\begin_inset Formula $\mathbf{d}$
\end_inset

 has unit length.
\end_layout

\begin_layout Standard
Note that if you set 
\begin_inset Formula $\mathbf{d}=\mathbf{a}_{1}$
\end_inset

 then the objective meets the upper bound since
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{a}_{1}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{a}_{1}=\mathbf{a}_{1}^{T}\mathbf{A}\boldsymbol{\Lambda}\mathbf{A}^{T}\mathbf{a}_{1}=\mathbf{e}_{1}^{T}\mathbf{\boldsymbol{\Lambda}e}_{1}=\lambda_{1},
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{e}_{1}=\left[\begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0\end{array}\right]^{T}$
\end_inset

 is the first standard basis vector.
 Hence, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\lambda_{1}=\underset{\underset{}{\Vert\mathbf{d}\Vert_{2}=1}}{\textrm{max}}\,\mathbf{d}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{d},\label{eq:proof-1}
\end{equation}

\end_inset

and the corresponding eigenvector 
\begin_inset Formula $\mathbf{a}_{1}$
\end_inset

 is the unit length vector that maximizes the objective.
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
b) We now show among all unit direction vectors perpendicular to 
\begin_inset Formula $\mathbf{a}_{1}$
\end_inset

, 
\begin_inset Formula $\mathbf{a}_{2}$
\end_inset

 is the one which maximizes the objective.
 Using (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:master"

\end_inset

) once again we can write 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{d}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{d}=\lambda_{1}r_{1}^{2}+\stackrel[n=2]{N}{\sum}\lambda_{n}r_{n}^{2}\leq\lambda_{2}r_{1}^{2}+\stackrel[n=2]{N}{\sum}\lambda_{2}r_{n}^{2}=\stackrel[n=1]{N}{\sum}\lambda_{2}r_{n}^{2},
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where the inequality holds since we are only looking for directions perpendicula
r to 
\begin_inset Formula $\mathbf{a}_{1}$
\end_inset

, therefore 
\begin_inset Formula $r_{1}=\mathbf{d}^{T}\mathbf{a}_{1}=0$
\end_inset

, and we also have that 
\begin_inset Formula $\lambda_{2}\geq\cdot\cdot\cdot\geq\lambda_{N}\geq0$
\end_inset

 by assumption.
 Hence 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{d}^{T}\mathbf{X}\mathbf{X}^{T}\mathbf{d}\leq\stackrel[n=1]{N}{\sum}\lambda_{2}r_{n}^{2}=\lambda_{2}\Vert\mathbf{r}\Vert_{2}^{2}=\lambda_{2}\mathbf{d}^{T}\mathbf{A}\mathbf{A}^{T}\mathbf{d}=\lambda_{2}\mathbf{d}^{T}\mathbf{d}=\lambda_{2}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally note that with the input 
\begin_inset Formula $\mathbf{d}=\mathbf{a}_{2}$
\end_inset

 this upper bound is met.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
c) Assume 
\begin_inset Formula $\mathbf{X}$
\end_inset

 has the singular value decomposition 
\begin_inset Formula $\mathbf{X}=\mathbf{U}\boldsymbol{S}\mathbf{V}^{T}$
\end_inset

.
 Then we can write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{XX}^{T}=\mathbf{U}\boldsymbol{S}\mathbf{V}^{T}\left(\mathbf{U}\boldsymbol{S}\mathbf{V}^{T}\right)^{T}=\mathbf{U}\boldsymbol{S}\mathbf{V}^{T}\left(\mathbf{V}\boldsymbol{S}^{T}\mathbf{U}^{T}\right)=\mathbf{U}\boldsymbol{S}\left(\mathbf{V}^{T}\mathbf{V}\right)\boldsymbol{S}^{T}\mathbf{U}^{T}=\mathbf{U}\boldsymbol{S}\boldsymbol{S}^{T}\mathbf{U}^{T}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
From part a) we have the eigendecomposition of 
\begin_inset Formula $\mathbf{X}\mathbf{X}^{T}$
\end_inset

 as 
\begin_inset Formula $\mathbf{X}\mathbf{X}^{T}=\mathbf{A}\boldsymbol{\Lambda}\mathbf{A}^{T}$
\end_inset

.
 A simple inspection shows 
\begin_inset Formula $\mathbf{U}=\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}\mathbf{S}^{T}=\boldsymbol{\Lambda}$
\end_inset

.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\boldsymbol{S}\boldsymbol{S}^{T}$
\end_inset

 is a diagonal matrix with singular values squared along its diagnoal.
 
\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard

\series bold
\color blue
Exercise 9.4
\end_layout

\begin_layout Standard
This is a programming exercise.
 See our code repository.
 
\end_layout

\end_body
\end_document
