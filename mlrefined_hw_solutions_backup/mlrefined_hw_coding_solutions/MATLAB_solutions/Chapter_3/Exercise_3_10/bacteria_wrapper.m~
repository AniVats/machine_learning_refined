function bacteria_wrapper()

% This file is associated with the book
% "Machine Learning Refined", Cambridge University Press, 2016.
% by Jeremy Watt, Reza Borhani, and Aggelos Katsaggelos.

% load data and plot in each panel
[x,y] = load_data();

% fit models in respective panels
y_
fit_sig_model(x,log(y./(1-y)))

%%%%%% functions %%%%%%%%
function [x,y] = load_data()
    % Variables
    data = csvread('bacteria_data.csv');
    x = data(:,1);
    y = data(:,2);
    
    % plot in each panel
    for i = 1:2
        subplot(1,3,i)
        scatter(x,y,'k','fill');
        ylabel('y  ','Fontsize',18,'FontName','cmmi9')
        xlabel('x','Fontsize',18,'FontName','cmmi9')
        set(get(gca,'YLabel'),'Rotation',0)
        axis square
        box off
    end
    subplot(1,3,3)
    scatter(x,log(y./(1-y)),'MarkerEdgeColor','k','MarkerFaceColor','k','LineWidth',0.5)
    ylabel('f(y)  ','Fontsize',18,'FontName','cmmi9')
    xlabel('x','Fontsize',18,'FontName','cmmi9')
    set(get(gca,'YLabel'),'Rotation',0)
    axis square
    box off
    set(gcf,'color','w');

end

function fit_sig_model(x,y)

    F = [ones(length(x),1) x];
    w = linsolve(F,y);
    
    subplot(1,3,2)
    hold on
    s = [0:0.1:25]';
    t = 1./(1 + exp(-(w(1) + w(2)*s)));
    plot(s,t,'m','LineWidth',1.4);
    
    subplot(1,3,3)
    hold on

    t = w(1) + s*w(2);
    plot(s,t,'m','LineWidth',1.4);
end

end





